<?xml version="1.0" encoding="UTF-8" standalone="no"?><xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1" xmlns="http://checklists.nist.gov/xccdf/1.1" xmlns:ecl="http://cisecurity.org/check" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="cis_apache_tomcat_benchmark" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 ../misc/xsd/xccdf-1.1.4.xsd http://cisecurity.org/check ../misc/xsd/ecl.xsd">
    <xccdf:status>accepted</xccdf:status>
    <xccdf:title>CIS Apache Tomcat 5.5 and 6.0 Benchmark</xccdf:title>
    <xccdf:description>This document, Security Configuration Benchmark for Apache Tomcat 5.5/6.0, provides prescriptive guidance for establishing a secure configuration posture for Apache Tomcat versions 5.5 6.0.20 running on Linux. This guide was tested against Apache Tomcat 5.5 and 6.0.20 as installed by tar packages provided by Apache.</xccdf:description>
    <xccdf:front-matter>
        <xhtml:p>Apache Tomcat 5.5/6.0 Level 1 &amp; 2 Benchmark v1.0 December 2009</xhtml:p>
        <xhtml:p>Copyright 2001-2009, The Center for Internet Security<xhtml:a href="http://www.CISecurity.org/">http://www.CISecurity.org/</xhtml:a>
        </xhtml:p>
        <xhtml:p>TERMS OF USE AGREEMENT</xhtml:p>
        <xhtml:p>Background.</xhtml:p>
        <xhtml:p>The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere (“Products”) as a public service to Internet users worldwide. Recommendations contained in the Products (“Recommendations”) result from a consensus-building process that involves many security experts and are generally generic in nature. The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices. Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements. The Recommendations are not in any way intended to be a “quick fix” for anyone’s information security needs.</xhtml:p>
        <xhtml:p>No Representations, Warranties, or Covenants.</xhtml:p>
        <xhtml:p>CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of the Products or the Recommendations. CIS is providing the Products and the Recommendations “as is” and “as available” without representations, warranties, or covenants of any kind. </xhtml:p>
        <xhtml:p>User Agreements.</xhtml:p>
        <xhtml:p>By using the Products and/or the Recommendations, I and/or my organization (“We”) agree and acknowledge that:</xhtml:p>
        <xhtml:ol>
            <xhtml:li>
                <xhtml:p>No network, system, device, hardware, software, or component can be made fully secure;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We are using the Products and the Recommendations solely at our own risk;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from CIS’s negligence or failure to perform;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the Recommendations to our particular circumstances and requirements;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of the need for any such corrections, updates, upgrades, or bug fixes; and</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage to reputation, loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, viruses, worms, backdoors, Trojan horses or other harmful items.</xhtml:p>
            </xhtml:li>
        </xhtml:ol>
        <xhtml:p>Grant of Limited Rights.</xhtml:p>
        <xhtml:p>CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:</xhtml:p>
        <xhtml:ol>
            <xhtml:li>
                <xhtml:p>Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and use each of the Products on a single computer;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.</xhtml:p>
            </xhtml:li>
        </xhtml:ol>
        <xhtml:p>Retention of Intellectual Property Rights; Limitations on Distribution.</xhtml:p>
        <xhtml:p>The Products are protected by copyright and other intellectual property laws and by international treaties. We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties. CIS reserves all rights not expressly granted to users in the preceding section entitled “Grant of limited rights.”</xhtml:p>
        <xhtml:p>Subject to the paragraph entitled “Special Rules” (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these
            Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product. We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.</xhtml:p>
        <xhtml:p>We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations (“CIS Parties”) harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS’s right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim. We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use. </xhtml:p>
        <xhtml:p>Special Rules.</xhtml:p>
        <xhtml:p>The distribution of the NSA Security Recommendations is subject to the terms of the NSA Legal Notice and the terms contained in the NSA Security Recommendations themselves (<xhtml:a href="http://nsa2.www.conxion.com/cisco/notice.htm">http://nsa2.www.conxion.com/cisco/notice.htm</xhtml:a>).</xhtml:p>
        <xhtml:p>CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship. Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.</xhtml:p>
        <xhtml:p>CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member’s own organization, whether by manual or electronic means. Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member’s membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.</xhtml:p>
        <xhtml:p>Choice of Law; Jurisdiction; Venue</xhtml:p>
        <xhtml:p>We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action. If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.</xhtml:p>
        <xhtml:p>Terms of Use Agreement Version 2.1 - 02/20/04</xhtml:p>
    </xccdf:front-matter>
    <xccdf:version>1.0.0.7</xccdf:version>
    <xccdf:Profile id="level-1">
        <xccdf:title>Level 1 checks</xccdf:title>
        <xccdf:description>Level-I Benchmark recommendations are intended to be practical and prudent; provide a clear security benefit; and do not negatively inhibit the utility of the technology beyond acceptable means.</xccdf:description>
        <xccdf:select idref="disable-unused-connectors" selected="true"/>
        <xccdf:select idref="disable-client-facing-stack-traces" selected="true"/>
        <xccdf:select idref="turn-off-trace" selected="true"/>
        <xccdf:select idref="set-a-nondeterministic-shutdown-command-value" selected="true"/>
        <xccdf:select idref="restrict-access-to-catalina_home" selected="true"/>
        <xccdf:select idref="restrict-access-to-catalina_base" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-configuration-directory" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-logs-directory" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-temp-directory" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-binaries-directory" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-web-application-directory" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-catalinapolicy" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-catalinaproperties" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-contextxml" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-loggingproperties" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-serverxml" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-tomcat-usersxml" selected="true"/>
        <xccdf:select idref="restrict-access-to-tomcat-webxml" selected="true"/>
        <xccdf:select idref="ensure-sslenabled-is-set-to-true-for-sensitive-connectors" selected="true"/>
        <xccdf:select idref="ensure-scheme-is-set-accurately" selected="true"/>
        <xccdf:select idref="ensure-secure-is-set-to-true-only-for-ssl-enabled-connectors" selected="true"/>
        <xccdf:select idref="ensure-sslprotocol-is-set-to-tls-for-secure-connectors" selected="true"/>
        <xccdf:select idref="specify-file-handler-in-loggingproperties-files" selected="true"/>
        <xccdf:select idref="ensure-directory-in-contextxml-is-a-secure-location" selected="true"/>
        <xccdf:select idref="ensure-pattern-in-contextxml-is-correct" selected="true"/>
        <xccdf:select idref="ensure-directory-in-loggingproperties-is-a-secure-location" selected="true"/>
        <xccdf:select idref="restrict-runtime-access-to-sensitive-packages" selected="true"/>
        <xccdf:select idref="starting-tomcat-with-security-manager" selected="true"/>
        <xccdf:select idref="ensure-web-content-directory-is-on-a-separate-partition-from-the-tomcat-system-files" selected="true"/>
        <xccdf:select idref="force-ssl-when-accessing-the-manager-application" selected="true"/>
        <xccdf:select idref="enable-strict-servlet-compliance" selected="true"/>
        <xccdf:select idref="turn-off-session-façade-recycling" selected="true"/>
        <xccdf:select idref="do-not-allow-symbolic-linking" selected="true"/>
        <xccdf:select idref="do-not-run-applications-as-privileged" selected="true"/>
        <xccdf:select idref="do-not-allow-cross-context-requests" selected="true"/>
    </xccdf:Profile>
    <xccdf:Profile id="level-2">
        <xccdf:title>Level 2 checks</xccdf:title>
        <xccdf:description>Level-II Benchmark recommendations exhibit one or more of the following characteristics: may negatively inhibit the utility or performance of the technology, acts as defense in depth measure.</xccdf:description>
        <xccdf:select idref="do-not-install-tomcat-on-a-multi-use-system" selected="true"/>
        <xccdf:select idref="remove-extraneous-files-and-directories" selected="true"/>
        <xccdf:select idref="alter-the-advertised-serverinfo-string" selected="true"/>
        <xccdf:select idref="alter-the-advertised-servernumber-string" selected="true"/>
        <xccdf:select idref="alter-the-advertised-serverbuilt-date" selected="true"/>
        <xccdf:select idref="disable-x-powered-by-http-header-and-rename-the-server-value-for-all-connectors" selected="true"/>
        <xccdf:select idref="disable-the-shutdown-port" selected="true"/>
        <xccdf:select idref="use-secure-realms" selected="true"/>
        <xccdf:select idref="use-lockout-realms" selected="true"/>
        <xccdf:select idref="setup-client-cert-authentication" selected="true"/>
        <xccdf:select idref="application-specific-logging" selected="true"/>
        <xccdf:select idref="ensure-classname-is-set-correctly-in-contextxml" selected="true"/>
        <xccdf:select idref="configure-log-file-size-limit" selected="true"/>
        <xccdf:select idref="disabling-auto-deployment-of-applications" selected="true"/>
        <xccdf:select idref="disable-deploy-on-startup-of-applications" selected="true"/>
        <xccdf:select idref="restrict-access-to-the-web-administration" selected="true"/>
        <xccdf:select idref="restrict-manager-application" selected="true"/>
        <xccdf:select idref="rename-the-manager-application" selected="true"/>
        <xccdf:select idref="do-not-allow-additional-path-delimiters" selected="true"/>
        <xccdf:select idref="do-not-allow-custom-header-status-messages" selected="true"/>
        <xccdf:select idref="configure-connectiontimeout" selected="true"/>
        <xccdf:select idref="configure-maxhttpheadersize" selected="true"/>
        <xccdf:select idref="force-ssl-for-all-applications" selected="true"/>
        <xccdf:select idref="increase-the-entropy-in-session-identifiers" selected="true"/>
        <xccdf:select idref="do-not-resolve-hosts-on-logging-valves" selected="true"/>
    </xccdf:Profile>
    
    <!--
      FROM THE TOMCAT DOCS:
        Throughout the docs, you'll notice there are numerous references to $CATALINA_HOME. 
        This represents the root of your Tomcat installation. When we say, "This information 
        can be found in your $CATALINA_HOME/README.txt file" we mean to look at the README.txt 
        file at the root of your Tomcat install. Optionally, Tomcat may be configured for 
        multiple instances by defining $CATALINA_BASE for ___each instance___. If multiple 
        instances are not configured, $CATALINA_BASE is the same as $CATALINA_HOME.
      -->
    <xccdf:Value id="catalina.base" interactive="true" interfaceHint="text" type="string">
        <xccdf:title>$CATALINA_BASE</xccdf:title>
        <xccdf:question>What is the path to the Tomcat instance's base directory ($CATALINA_BASE)?</xccdf:question>
        <xccdf:value/>
        <xccdf:default>/usr/share/tomcat6</xccdf:default>
    </xccdf:Value>
    <xccdf:Value id="catalina.home" interactive="true" interfaceHint="text" type="string">
        <xccdf:title>$CATALINA_HOME</xccdf:title>
        <xccdf:question>What is the path to the root of your Tomcat installation ($CATALINA_HOME)?</xccdf:question>
        <xccdf:value/>
        <xccdf:default>/usr/share/tomcat6</xccdf:default>
    </xccdf:Value>
    <xccdf:Value id="tomcat.fileuser" interactive="true" interfaceHint="text" type="string">
        <xccdf:title>Tomcat file resource owner user ID</xccdf:title>
        <xccdf:question>What is the name of the administrative user your organization expects to own Tomcat file resources? This name must exist in /etc/passwd.</xccdf:question>
        <xccdf:value/>
        <xccdf:default>tomcat</xccdf:default>
    </xccdf:Value>
    <xccdf:Value id="tomcat.filegroup" interactive="true" interfaceHint="text" type="string">
        <xccdf:title>Tomcat file resource group ID </xccdf:title>
        <xccdf:question> What is the name of the group your organization expects to own Tomcat file resources? This name must exist in /etc/group.</xccdf:question>
        <xccdf:value/>
        <xccdf:default>tomcat</xccdf:default>
    </xccdf:Value>
    <xccdf:Group id="recommendations">
        <xccdf:title>Recommendations</xccdf:title>
        <xccdf:description/>
        <xccdf:Group id="pre-installation-">
            <xccdf:title>Preinstallation</xccdf:title>
            <xccdf:description>
                <xhtml:p>In this section we present per-installation considerations for deploying Tomcat securely. </xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="do-not-install-tomcat-on-a-multi-use-system" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Do not install Tomcat on a multi-use system</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Servers often expose a variety of services or daemons. It is recommended that the number of services and daemons executing on the Tomcat server be limited to those necessary. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Maintaining a server for a single purpose increases the security of your application and system. The more services which are exposed to an attacker, the more potential vectors an attacker has to exploit the system. Tomcat services should function as application servers only and should not be mixed with other functions. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Leverage the package or services manager for your OS to uninstall or disable unneeded services. On Redhat systems, the following will produce the current service/daemon list: <br/>
                            <br/>chkconfig --list <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>NA </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Leverage the package or services manager for your OS to uninstall or disable unneeded services. On Red Hat systems, the following will disable a given daemon: <br/>
                        <br/>chkconfig &lt;servicename&gt; off </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="installation">
            <xccdf:title>Installation </xccdf:title>
            <xccdf:description>In this section we present various methods of installing Tomcat. We will briefly cover both Windows and UNIX installations. For full installation details and options you should refer to the Tomcat documentation. When deciding upon which Tomcat version to install, be sure to install the latest stable version of the Java Runtime Environment (JRE), Tomcat, and any third party libraries. </xccdf:description>
        </xccdf:Group>
        <xccdf:Group id="remove-extraneous-resources-">
            <xccdf:title>Remove Extraneous Resources</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="remove-extraneous-files-and-directories" role="full" selected="false" weight="1.0">
                <xccdf:title>Remove extraneous files and directories</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The installation may provide example applications, documentation, and other directories which may not serve a production use. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Removing sample resources is a defense in depth measure that reduces potential exposures introduced by these resources. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine the existence of extraneous resources: <br/>1. List all files extraneous files. The following should yield no output: <br/>$ ls -l $CATALINA_HOME/webapps/js-examples \ <br/> $CATALINA_HOME/webapps/servlet-example \ <br/> $CATALINA_HOME/webapps/webdav \ <br/> $CATALINA_HOME/webapps/tomcat-docs \ <br/> $CATALINA_HOME/webapps/balancer \ <br/> $CATALINA_HOME/webapps/ROOT/admin \ <br/> $CATALINA_HOME/webapps/examples <br/> \ <br/> $CATALINA_HOME/server/webapps/manager \ <br/> $CATALINA_HOME/conf/Catalina/localhost/host-manager.xml \ <br/> $CATALINA_HOME/conf/Catalina/localhost/manager.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Depending on your install method, default extraneous resources will vary. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to remove extraneous resources: <br/>1. The following should yield no output: <br/>$ rm -rf $CATALINA_HOME/webapps/js-examples \ <br/> $CATALINA_HOME/webapps/servlet-example \ <br/> $CATALINA_HOME/webapps/webdav \ <br/> $CATALINA_HOME/webapps/tomcat-docs \ <br/> $CATALINA_HOME/webapps/balancer \ <br/> $CATALINA_HOME/webapps/ROOT/admin \ <br/> $CATALINA_HOME/webapps/examples <br/>If the Manager application is not utilized, also remove the following resources: <br/>$ rm –rf $CATALINA_HOME/server/webapps/host-manager \ <br/> $CATALINA_HOME/server/webapps/manager \ <br/> $CATALINA_HOME/conf/Catalina/localhost/host-manager.xml \ <br/> $CATALINA_HOME/conf/Catalina/localhost/manager.xml </xhtml:p>
                </xccdf:fixtext>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/js-examples»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/webapps/js-examples</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/servlet-example»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/webapps/servlet-example</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/webdav»" success="fail">
                                <ecl:command>test -e ${Value:catalina.base}/webapps/webdav</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/tomcat-docs»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/webapps/tomcat-docs</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/balancer»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/webapps/balancer</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/ROOT/admin»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/webapps/ROOT/admin</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/examples»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/webapps/examples</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/server/webapps/manager»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/server/webapps/manager</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/conf/Catalina/localhost/host-manager.xml»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/conf/Catalina/localhost/host-manager.xml</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/conf/Catalina/localhost/manager.xml»" success="fail">
                                <ecl:command>test -e
                                    ${Value:catalina.base}/conf/Catalina/localhost/manager.xml</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="disable-unused-connectors" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Disable Unused Connectors</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The default installation of Tomcat includes connectors with default settings. These are traditionally set up for convenience. It is best to remove these connectors and develop connectors from scratch, only enabling exactly what is needed. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Improperly configured or unnecessarily installed Connectors may lead to a security exposure. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to identify configured Connectors: <br/>
                            <br/>1. Execute the following command to find configured Connectors. Ensure only those required are present and not commented out: <br/>
                            <br/>$ grep "Connector" $CATALINA_HOME/conf/server.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>$CATALINA_HOME/conf/server.xml, has the following connectors defined by default: <br/>* A non-SSL Connector bound to port 8080 <br/>* An AJP 1.3 Connector bound to port 8009 </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/connectors.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to disable unused Connectors: <br/>1. Within $CATALINA_HOME/conf/server.xml, remove or comment each unused Connector. For example, to disable an instance of the HTTPConnector, remove the following: <br/>&lt;Connector className="org.apache.catalina.connector.http.HttpConnector" <br/>... <br/>connectionTimeout="60000"/&gt; </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="limit-server-platform-information-leaks-">
            <xccdf:title>Limit Server Platform Information Leaks</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="alter-the-advertised-serverinfo-string" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Alter the Advertised server.info String</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The server.info attribute contains the name of the application service. This value is presented to Tomcat clients when clients connect to the tomcat server. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Altering the server.info attribute may make it harder for attackers to determine which vulnerabilities affect the server platform. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the server.info value has been changed: <br/>
                            <br/>1. Extract the ServerInfo.properties file and examine the server.info attribute. <br/> For Tomcat 5.5 <br/>$ cd $CATALINA_HOME/server/lib <br/> For Tomcat 6.X <br/>$ cd $CATALINA_HOME/lib <br/>$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties <br/>$ grep server.info org/apache/catalina/util/ServerInfo.properties </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default value for the server.info attribute is Apache Tomcat/&lt;MajorVer&gt;.&lt;MinorVer&gt;. For example, Apache Tomcat/5.5. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://www.owasp.org/index.php/Securing_tomcat </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to alter the server platform string that gets displayed when clients connect to the tomcat server. <br/>
                        <br/>1. Extract the ServerInfo.properties file from the catalina.jar file: <br/> For Tomcat 5.5 <br/>$ cd $CATALINA_HOME/server/lib <br/> For Tomcat 6.0 <br/>$ cd $CATALINA_HOME/lib <br/>$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties <br/>2. Navigate to the util directory that was created <br/>cd org/apache/Catalina/util <br/>3. Open ServerInfo.properties in an editor <br/>4. Update the server.info attribute in the ServerInfo.properties file. <br/>server.info=&lt;SomeWebServer&gt; <br/>5. Update the catalina.jar with the modified ServerInfo.properties file. <br/>$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="alter-the-advertised-servernumber-string" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Alter the Advertised server.number String</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The server.number attribute represents the specific version of Tomcat that is executing. This value is presented to Tomcat clients when connect. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Advertising a valid server version may provide attackers with information useful for locating vulnerabilities that affect the server platform. Altering the server version string may make it harder for attackers to determine which vulnerabilities affect the server platform. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the server.number value has been changed: <br/>
                            <br/>1. Extract the ServerInfo.properties file and examine the server.number attribute. <br/>For Tomcat 5.5 <br/>$ cd $CATALINA_HOME/server/lib <br/>For Tomcat 6.X <br/>$ cd $CATALINA_HOME/lib <br/>$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties <br/>$ grep server.number org/apache/catalina/util/ServerInfo.properties </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default value for the server.number attribute is a four part version number, such as 5.5.20.0. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://techgurulive.com/2009/05/27/how-to-hide-tomcat-version/ </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to alter the server version string that gets displayed when clients connect to the server. <br/>
                        <br/>1. Extract the ServerInfo.properties file from the catalina.jar file: <br/>For Tom 5.5: <br/>$ cd $CATALINA_HOME/server/lib <br/> For Tomcat 6.X: <br/>$ cd $CATALINA_HOME/lib <br/>$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties <br/>2. Navigate to the util directory that was created <br/>cd org/apache/Catalina/util <br/>3. Open ServerInfo.properties in an editor <br/>4. Update the server.number attribute <br/>server.number=&lt;SomeVersion&gt; <br/>5. Update the catalina.jar with the modified ServerInfo.properties file. <br/>$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="alter-the-advertised-serverbuilt-date" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Alter the Advertised server.built Date</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The server.built date represents the date which Tomcat was compiled and packaged. This value is presented to Tomcat clients when clients connect to the server. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Altering the server.built string may make it harder for attackers to fingerprint which vulnerabilities affect the server platform. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the server.built value has been changed: <br/>
                            <br/>1. Extract the ServerInfo.properties file and examine the server.built attribute. <br/> For Tomcat 5.5 <br/>$ cd $CATALINA_HOME/server/lib <br/>
                            <br/>For Tomcat 6.X <br/>$ cd $CATALINA_HOME/lib <br/>$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties <br/>$ grep server.built org/apache/catalina/util/ServerInfo.properties </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default value for the server.built attribute is build date and time. For example, Jul 8 2008 11:40:35. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to alter the server version string that gets displayed when clients connect to the server. <br/>
                        <br/>1. Extract the ServerInfo.properties file from the catalina.jar file: <br/> For Tomcat 5.5 <br/>$ cd $CATALINA_HOME/server/lib <br/> For Tomcat 6.X <br/>$ cd $CATALINA_HOME/lib <br/>$ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties <br/>2. Navigate to the util directory that was created <br/>$ cd org/apache/Catalina/util <br/>3. Open ServerInfo.properties in an editor <br/>4. Update the server.built attribute in the ServerInfo.properties file. <br/>server.built=&lt;BuildDate&gt; <br/>5. Update the catalina.jar with the modified ServerInfo.properties file. <br/>$ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="disable-x-powered-by-http-header-and-rename-the-server-value-for-all-connectors" role="full" selected="false" weight="1.0">
                <xccdf:title>Disable X-Powered-By HTTP Header and Rename the Server Value for all Connectors</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The xpoweredBy setting determines if Apache Tomcat will advertise its presence via the X-Powered-By HTTP header. It is recommended that this value be set to false. The server attribute overrides the default value that is sent down in the HTTP header further masking Apache Tomcat. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Preventing Tomcat from advertising its presence in this manner may make it harder for attackers to determine which vulnerabilities affect the server platform. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the server platform, as advertised in the HTTP Server header, has been changed: <br/>
                            <br/>1. Locate all Connector elements in $CATALINA_HOME/conf/server.xml. <br/>2. Ensure each Connector has a server attribute and that the server attribute does not reflect Apache Tomcat. Also, make sure that the xpoweredBy attribute is NOT set to true. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Tomcat does not advertise the X-Powered-By HTTP header by default. Tomcat will only advertise in this manner if the xpoweredBy attribute is present and set to true. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-5.5-doc/config/http.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to prevent Tomcat from advertising its presence via the X-Powered-By HTTP header. <br/>
                        <br/>1. Add the xpoweredBy attribute to each Connector specified in $CATALINA_HOME/conf/server.xml. Set the xpoweredBy attributes value to false. <br/>&lt;Connector ... xpoweredBy="false" /&gt; <br/>Alternatively, ensure the xpoweredBy attribute for each Connector specified in $CATALINA_HOME/conf/server.xml is absent. <br/>Add the server attribute to each Connector specified in $CATALINA_HOME/conf/server.xml. Set the server attribute value to anything except a blank string. 2. </xhtml:p>
                </xccdf:fixtext>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:file-content check="none exist" comment="test «${Value:catalina.base}/conf/server.xml» - xpoweredBy\s*=\s*&quot;true&quot;" success="fail">
                                <ecl:path>${Value:catalina.base}/conf/server.xml</ecl:path>
                                <ecl:line-selection op="pm" value="xpoweredBy\s*=\s*&quot;true&quot;"/>
                            </ecl:file-content>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/server.xml» - server\s*=\s*&quot;&quot;" success="pass">
                                <ecl:path>${Value:catalina.base}/conf/server.xml</ecl:path>
                                <ecl:line-selection op="pm" value="server\s*=\s*&quot;[^&quot;]+&quot;"/>
                            </ecl:file-content>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="disable-client-facing-stack-traces" role="full" selected="false" weight="1.0">
                <xccdf:title>Disable client facing Stack Traces</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>When a runtime error occurs during request processing, Apache Tomcat will display debugging information to the requestor. It is recommended that such debug information be withheld from the requestor. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Debugging information, such as that found in call stacks, often contains sensitive information that may useful to an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information to a potential attacker is reduced. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if Tomcat is configured to prevent sending debug information to the requestor <br/>
                            <br/>1. Ensure an &lt;error-page&gt; element is defined in$ CATALINA_HOME/conf/web.xml. <br/>2. Ensure the &lt;error-page&gt; element has an &lt;exception-type&gt; child element with a value of java.lang.Throwable. <br/>3. Ensure the &lt;error-page&gt; element has a &lt;location&gt; child element. <br/>
                            <br/>Note: Perform the above for each application hosted within Tomcat. Per application instances of web.xml can be found at $CATALINA_HOME/webapps/&lt;APP_NAME&gt;/WEB-INF/web.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Tomcat's default configuration does not include an &lt;error-page&gt; element in $CATALINA_HOME/conf/web.xml. Therefore, Tomcat will provide debug information to the requestor by default. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>http://tomcat.apache.org/tomcat-5.5-doc/catalina/docs/api/org/apache/catalina/deploy/ErrorPage.html 1. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to prevent Tomcat from providing debug information to the requestor during runtime errors: <br/>
                        <br/>1. Create a web page that contains the logic or message you wish to invoke when encountering a runtime error. For example purposes, assume this page is located at /error.jsp. <br/>2. Add a child element, &lt;error-page&gt;, to the &lt;web-app&gt; element, in the $CATALINA_HOME/conf/web.xml file. <br/>3. Add a child element, &lt;exception-type&gt;, to the &lt;error-page&gt; element. Set the value of the &lt;exception-type&gt; element to java.lang.Throwable. <br/>4. Add a child element, &lt;location&gt;, to the &lt;error-page&gt; element. Set the value of the &lt;location&gt; element to the location of page created in #1. <br/>
                        <br/>The resulting entry will look as follows: <br/>&lt;error-page&gt; <br/> &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt; <br/> &lt;location&gt;/error.jsp&lt;/location&gt; <br/>&lt;/error-page&gt; </xhtml:p>
                </xccdf:fixtext>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/web.xml» - &lt;exception-type&gt;\s*java.lang.Throwable\s*&lt;/exception-type&gt;" success="pass">
                                <ecl:path>${Value:catalina.base}/conf/web.xml</ecl:path>
                                <ecl:line-selection op="pm" value="&lt;exception-type&gt;\s*java.lang.Throwable\s*&lt;/exception-type&gt;"/>
                            </ecl:file-content>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/web.xml» - &lt;error-page&gt;" success="pass">
                                <ecl:path>${Value:catalina.base}/conf/web.xml</ecl:path>
                                <ecl:line-selection op="pm" value="&lt;error-page&gt;"/>
                            </ecl:file-content>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="turn-off-trace" role="full" selected="false" weight="1.0">
                <xccdf:title>Turn off TRACE</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The HTTP TRACE verb provides debugging and diagnostics information for a given request. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Diagnostic information, such as that found in the response to a TRACE request, often contains sensitive information that may useful to an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information to a potential attacker is reduced. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the server platform, as advertised in the HTTP Server header, has been changed: <br/>
                            <br/>1. Locate all Connector elements in $CATALINA_HOME/conf/server.xml. <br/>2. Ensure each Connector does not have a getTrace attribute or if the getTrace attribute is not set true. <br/>
                            <br/>Note: Perform the above for each application hosted within Tomcat. Per application instances of web.xml can be found at $CATALINA_HOME/webapps/&lt;APP_NAME&gt;/WEB-INF/web.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Tomcat does not allow the TRACE HTTP verb by default. Tomcat will only allow TRACE if the allowTrace attribute is present and set to true. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>http://tomcat.apache.org/tomcat-5.5-doc/config/http.html 1. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to prevent Tomcat from accepting a TRACE request: <br/>
                        <br/>1. Add the allowTrace attribute to each Connector specified in $CATALINA_HOME/conf/server.xml. Set the allowTrace attributes value to false. <br/>&lt;Connector ... allowTrace="false" /&gt; <br/>Alternatively, ensure the allowTrace attribute for each Connector specified in $CATALINA_HOME/conf/server.xml is absent. </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="none exist" comment="test «${Value:catalina.base}/conf/web.xml» - allowTrace\s*=\s*&quot;true&quot;" success="fail">
                            <ecl:path>${Value:catalina.base}/conf/web.xml</ecl:path>
                            <ecl:line-selection op="pm" value="allowTrace\s*=\s*&quot;true&quot;"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="protect-the-shutdown-port-">
            <xccdf:title>Protect the Shutdown Port</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="set-a-nondeterministic-shutdown-command-value" role="full" selected="false" weight="1.0">
                <xccdf:title>Set a nondeterministic Shutdown command value</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. It is recommended that a nondeterministic value be set for the shutdown attribute in $CATALINA_HOME/conf/server.xml. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Setting the shutdown attribute to a nondeterministic value will prevent malicious local users from shutting down Tomcat. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the shutdown port is configured to use the default shutdown command: <br/>
                            <br/>1. Ensure the shutdown attribute in $CATALINA_HOME/conf/server.xml is not set to SHUTDOWN. <br/>$ cd $CATALINA_HOME/conf <br/>$ grep 'shutdown[[:space:]]*=[[:space:]]*"SHUTDOWN"' server.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default value for the shutdown attribute is SHUTDOWN. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-5.5-doc/config/server.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to set a nondeterministic value for the shutdown attribute. <br/>
                        <br/>1. Update the shutdown attribute in $CATALINA_HOME/conf/server.xml as follows: <br/>&lt;Server port="8005" shutdown="NONDETERMINISTICVALUE"&gt; <br/>Note: NONDETERMINISTICVALUE should be replaced with a sequence of random characters. </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «cat ${Value:catalina.base}/conf/server.xml»">
                            <ecl:command>cat ${Value:catalina.base}/conf/server.xml</ecl:command>
                            <ecl:line-selection op="pm" value="shutdown\s*=\s*&quot;SHUTDOWN&quot;"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="disable-the-shutdown-port" role="full" selected="false" weight="1.0">
                <xccdf:title>Disable the Shutdown port</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. If this functionality is not used, it is recommended that the Shutdown port be disabled. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Disabling the Shutdown port will eliminate the risk of malicious local entities using the shutdown command to disable the Tomcat server. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the shutdown port has been disabled: <br/>
                            <br/>1. Ensure the port attribute in $CATALINA_HOME/conf/server.xml is set to -1. <br/>$ cd $CATALINA_HOME/conf/ <br/>$ grep '&lt;Server[[:space:]]\+[^&gt;]*port[[:space:]]*=[[:space:]]*"-1"' server.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The shutdown port is enabled on TCP port 8005, bound to the loopback address. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-5.5-doc/config/server.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to disable the Shutdown port. <br/>
                        <br/>1. Set the port to -1 in the $CATALINA_HOME/conf/server.xml file: <br/>&lt;Server port="-1" shutdown="SHUTDOWN"&gt; </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/server.xml» - &lt;Server\s+[^&gt;]*port\s*=\s*&quot;-1&quot;" success="pass">
                            <ecl:path>${Value:catalina.base}/conf/server.xml</ecl:path>
                            <ecl:line-selection op="pm" value="&lt;Server\s+[^&gt;]*port\s*=\s*&quot;-1&quot;"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="protect-tomcat-configurations-">
            <xccdf:title>Protect Tomcat Configurations</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="restrict-access-to-catalina_home" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to $CATALINA_HOME</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>$CATALINA_HOME is the environment variable which holds the path to the root Tomcat directory. It is important to protect access to this in order to protect the Tomcat binaries and libraries from unauthorized modification. It is recommended that the ownership of $CATALINA_HOME be tomcat_admin:tomcat. It is also recommended that the permission on $CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w). </xhtml:p>
                        <xhtml:p class="rationale">Rationale: The security of processes and data that traverse or depend on Tomcat may become compromised if the $CATALINA_HOME is not secured. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to ensure the permission on the $CATALINA_HOME directory prevent unauthorized modification. <br/>
                            <br/>$ cd $CATALINA_HOME <br/>$ find . -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>
                            <br/>The above command should not emit any output. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to establish the recommended state: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME to tomcat_admin.tomcat. <br/>2. Remove read, write, and execute permissions for the world <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin.tomcat $CATALINA_HOME <br/># chmod g-w,o-rwx $CATALINA_HOME </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base} -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base} -follow -maxdepth 0 \( -perm /027
                                -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-catalina_base" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to $CATALINA_BASE</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>$CATALINA_BASE is the environment variable that specifies the base directory which most relative paths are resolved. $CATALINA_BASE is usually used when there is multiple instances of Tomcat running. It is important to protect access to this in order to protect the Tomcat-related binaries and libraries from unauthorized modification. It is recommended that the ownership of $CATALINA_BASE be tomcat_admin:tomcat. It is also recommended that the permission on $CATALINA_BASE prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w). </xhtml:p>
                        <xhtml:p class="rationale">Rationale: The security of processes and data that traverse or depend on Tomcat may become compromised if the $CATALINA_BASE is not secured. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to ensure the permission on the $CATALINA_BASE directory prevent unauthorized modification. <br/>
                            <br/>$ cd $CATALINA_BASE <br/>$ find . -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>
                            <br/>The above command should not emit any output. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to establish the recommended state: <br/>
                        <br/>1. Set the ownership of the $CATALINA_BASE to tomcat_admin.tomcat. <br/>2. Remove read, write, and execute permissions for the world <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin.tomcat $CATALINA_BASE <br/># chmod g-w,o-rwx $CATALINA_BASE </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.home} -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.home} -follow -maxdepth 0 \( -perm /027
                                -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-configuration-directory" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat configuration directory</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The Tomcat $CATALINA_HOME/conf/ directory contains Tomcat configuration files. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w). </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to these directories will prevent local users from maliciously or inadvertently altering Tomcat's configuration. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf are securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/conf and execute the following: <br/># cd $CATALINA_HOME/conf <br/># find catalina.policy -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of the top-level directories is 770. <br/>
                        </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to Tomcat configuration files: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/conf to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/conf <br/># chmod g-w,o-rwx $CATALINA_HOME/conf </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/conf -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/conf -follow -maxdepth 0 \( -perm
                                /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-logs-directory" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat logs directory</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The Tomcat $CATALINA_HOME/logs/ directory contains Tomcat logs. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx). </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to these directories will prevent local users from maliciously or inadvertently altering Tomcat's logs. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/logs are securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/logs and execute the following: <br/># cd $CATALINA_HOME <br/># find logs -follow -maxdepth 0 \( -perm –o-rwx! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of the top-level directories is 770. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/security-manager-howto.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to Tomcat log files: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/logs <br/># chmod o-rwx $CATALINA_HOME/logs </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/logs -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/logs -follow -maxdepth 0 \( -perm
                                /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-temp-directory" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat temp directory</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The Tomcat $CATALINA_HOME/temp/ directory is used by Tomcat to persist temporary information to disk. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx). </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to these directories will prevent local users from maliciously or inadvertently affecting the integrity of Tomcat processes. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/temp are securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/temp and execute the following: <br/># cd $CATALINA_HOME <br/># find temp -follow -maxdepth 0 \( -perm –o-rwx -o ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of the top-level directories is 770. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to Tomcat log files: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/temp <br/># chmod o-rwx $CATALINA_HOME/temp </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/temp -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/temp -follow -maxdepth 0 \( -perm
                                /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-binaries-directory" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat binaries directory</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The Tomcat $CATALINA_HOME/bin/ directory contains executes that are part of the Tomcat run-time. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permission on $CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w). </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to these directories will prevent local users from maliciously or inadvertently affecting the integrity of Tomcat processes. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/bin are securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/bin and execute the following: <br/># cd $CATALINA_HOME <br/># find bin -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of the top-level directories is 770. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to Tomcat log files: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/bin <br/># chmod g-w,o-rwx $CATALINA_HOME/bin </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/bin -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/bin -follow -maxdepth 0 \( -perm
                                /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-web-application-directory" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat web application directory</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The Tomcat $CATALINA_HOME/webapps directory contains web applications that are deployed through Tomcat. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permission on $CATALINA_HOME/webapps prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w). </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to these directories will prevent local users from maliciously or inadvertently affecting the integrity of web applications. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/webapps are securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/webapps and execute the following: <br/># cd $CATALINA_HOME <br/># find webapps -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of the top-level directories is 770. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to Tomcat log files: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/webapps to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/webapps <br/># chmod g-w,o-rwx $CATALINA_HOME/webapps </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/webapps -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/webapps -follow -maxdepth 0 \(
                                -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-catalinapolicy" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat catalina.policy</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The catalina.policy file is used to configure security policies for Tomcat. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes. <br/>
                            <br/>Note: Some Tomcat Linux packages, such as the tomcat55 Debian package, cause catalina.policy to be automatically regenerated, at service restart, from individual policy files located in /etc/tomcat55/policy.d. In such scenarios, it is highly recommended that access to the /etc/tomcat55/policy.d directory and its contents be similarly restricted. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat's security policy. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/catalina.policy care securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/ and execute the following: <br/># cd $CATALINA_HOME/conf/ <br/># find catalina.policy !-follow -maxdepth 0 \( -perm -o+rwx -o -perm –g+rwx ! -user tomcat_admin -group tomcat -perm /770 \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of catalina.policy is 600. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/security-manager-howto.html <br/>
                        </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to $CATALINA_HOME/conf/catalina.policy. <br/>
                        <br/>1. Set the owner and group owner of the contents of $CATALINA_HOME/ to tomcat_admin and tomcat, respectively. <br/># chmod 770 $CATALINA_HOME/conf/catalina.policy <br/># chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.policy </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/conf/catalina.policy -follow -maxdepth 0 \( -perm /077 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/conf/catalina.policy -follow
                                -maxdepth 0 \( -perm /077 -o ! -user ${Value:tomcat.fileuser} -o !
                                -group ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-catalinaproperties" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat catalina.properties</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>catalina.properties is a Java properties files that contains settings for Tomcat including class loader information, security package lists, and performance properties. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes. <br/>
                            <br/>Note: Some Tomcat Linux packages, such as the tomcat55 Debian package, cause catalina.policy to be automatically regenerated, at service restart, from individual policy files located in /etc/tomcat55/policy.d. In such scenarios, it is highly recommended that access to the /etc/tomcat55/policy.d directory and its contents be similarly restricted. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat's security policy. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/catalina.properties care securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/ and execute the following: <br/># cd $CATALINA_HOME/conf/ <br/># find catalina.properties -follow -maxdepth 0 \( -perm -o+rwx -o -perm -g+rwx ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of the top-level directories is 600. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to catalina.policy: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/conf/catalina.policy to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world. <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.properties <br/># chmod g-w,o-rwx $CATALINA_HOME/conf/catalina.properties </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/conf/catalina.properties -follow -maxdepth 0 \( -perm /077 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/conf/catalina.properties -follow
                                -maxdepth 0 \( -perm /077 -o ! -user ${Value:tomcat.fileuser} -o !
                                -group ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-contextxml" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat context.xml</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The context.xml file is loaded by all web applications and sets certain configuration options. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat's security policy. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/context.xml care securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/conf and execute the following: <br/># cd $CATALINA_HOME/conf <br/># find context.xml -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of context.xml are 600. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to context.xml: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/conf/context.xml to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world. <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/conf/context.xml <br/># chmod g-w,o-rwx $CATALINA_HOME/conf/context.xml </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/conf/context.xml -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/conf/context.xml -follow -maxdepth
                                0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-loggingproperties" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat logging.properties</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>logging.properties is a Tomcat files which specifies the logging configuration. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes. <br/>
                            <br/>Note: Some Tomcat Linux packages, such as the tomcat55 Debian package, cause catalina.policy to be automatically regenerated, at service restart, from individual policy files located in /etc/tomcat55/policy.d. In such scenarios, it is highly recommended that access to the /etc/tomcat55/policy.d directory and its contents be similarly restricted. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat's security policy. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/logging.properties care securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/conf and execute the following: <br/># cd $CATALINA_HOME/conf/ <br/># find logging.properties -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions are 600. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to logging.properties: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/conf/logging.properties to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world. <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/conf/logging.properties <br/># chmod g-w,o-rwx $CATALINA_HOME/conf/logging.properties </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/conf/logging.properties -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/conf/logging.properties -follow
                                -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o !
                                -group ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-serverxml" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat server.xml</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>server.xml contains Tomcat servlet definitions and configurations. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes. <br/>
                            <br/>Note: Some Tomcat Linux packages, such as the tomcat55 Debian package, cause catalina.policy to be automatically regenerated, at service restart, from individual policy files located in /etc/tomcat55/policy.d. In such scenarios, it is highly recommended that access to the /etc/tomcat55/policy.d directory and its contents be similarly restricted. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat's security policy. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/server.xml care securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/conf and execute the following: <br/># cd $CATALINA_HOME/conf/ <br/># find server.xml -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of the top-level directories is 600. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to server.xml: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/conf/server.xml to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world. <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/conf/server.xml <br/># chmod g-w,o-rwx $CATALINA_HOME/conf/server.xml </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/conf/server.xml -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/conf/server.xml -follow -maxdepth 0
                                \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-tomcat-usersxml" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat tomcat-users.xml</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>tomcat-users.xml contains authentication information for Tomcat applications. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes. <br/>
                            <br/>Note: Some Tomcat Linux packages, such as the tomcat55 Debian package, cause catalina.policy to be automatically regenerated, at service restart, from individual policy files located in /etc/tomcat55/policy.d. In such scenarios, it is highly recommended that access to the /etc/tomcat55/policy.d directory and its contents be similarly restricted. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat's security policy. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/tomcat-users.xml care securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/conf and execute the following: <br/># cd $CATALINA_HOME/conf/ <br/># find tomcat-users.xml -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of the top-level directories is 600. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/security-manager-howto.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to tomcat-users.xml: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/conf/tomcat-users.xml to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world. <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/conf/tomcat-users.xml <br/># chmod g-w,o-rwx $CATALINA_HOME/conf/tomcat-users.xml </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/conf/tomcat-users.xml -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/conf/tomcat-users.xml -follow
                                -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o !
                                -group ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-tomcat-webxml" role="full" selected="false" weight="1.0">
                <xccdf:title>Restrict access to Tomcat web.xml</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>web.xml is a Tomcat configuration file that stores application configuration settings. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat's security policy. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/web.xml care securely configured. <br/>
                            <br/>1. Change to the location of the $CATALINA_HOME/conf and execute the following: <br/># cd $CATALINA_HOME/conf/ <br/># find web.xml -follow -maxdepth 0 \( -perm –o-rwx -o -perm –g-w ! -user tomcat_admin \) -ls <br/>Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default permissions of web.xml is 400. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to restrict access to web.xml: <br/>
                        <br/>1. Set the ownership of the $CATALINA_HOME/conf/web.xml to tomcat_admin:tomcat. <br/>2. Remove read, write, and execute permissions for the world. <br/>3. Remove write permissions for the group. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/conf/web.xml <br/># chmod g-w,o-rwx $CATALINA_HOME/conf/web.xml </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base}/conf/web.xml -follow -maxdepth 0 \( -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group ${Value:tomcat.filegroup} \) -ls»" success="pass">
                            <ecl:command>find ${Value:catalina.base}/conf/web.xml -follow -maxdepth 0 \(
                                -perm /027 -o ! -user ${Value:tomcat.fileuser} -o ! -group
                                ${Value:tomcat.filegroup} \) -ls</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="configure-realms-">
            <xccdf:title>Secure Realms</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="use-secure-realms" role="full" selected="false" weight="1.0">
                <xccdf:title>Use secure Realms</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>A realm is a database of usernames and passwords used to identify valid users of web applications. Review the Realms configuration to ensure Tomcat is configured to use JDBCRealm, DataSourceRealm, JNDIRealm, or JAASRealm. Specifically, Tomcat should not utilize MemoryRealm. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: According to the Tomcat documentation, MemoryRealm is not designed for production usage and could result in reduced availability. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to ensure the MemoryRealm is not in use: <br/>
                            <br/># grep "Realm className" $CATALINA_HOME/conf/server.xml | grep MemoryRealm <br/>
                            <br/>The above command should not emit any output. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Set the Realm className setting in $CATALINA_HOME/conf/server.xml to one of the appropriate realms. <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «cat ${Value:catalina.base}/conf/server.xml»" success="fail">
                            <ecl:command>cat ${Value:catalina.base}/conf/server.xml</ecl:command>
                            <ecl:line-selection op="pm" value="Realm className.*MemoryRealm"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="use-lockout-realms" role="full" selected="false" weight="1.0">
                <xccdf:title>Use LockOut Realms</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>A LockOut realm wraps around standard realms adding the ability to lock a user out after multiple failed logins. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Locking out a user after multiple failed logins slows down attackers from brute forcing logins. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to check to see if a LockOut realm is being used: <br/>
                            <br/># grep "LockOutRealm" $CATALINA_HOME/conf/server.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://eu.apachecon.com/presentation/materials/78/2009-03-26-SecuringApacheTomcat.pdf <br/>2. http://tomcat.apache.org/tomcat-6.0-doc/config/realm.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Create a lockout realm wrapping the main realm like the example below: <br/>
                        <br/>&lt;Realm className="org.apache.catalina.realm.LockOutRealm" failureCount="3" lockOutTime="600" cacheSize="1000" cacheRemovalWarningTime="3600"&gt; <br/> &lt;Realm className="org.apache.catalina.realm.DataSourceRealm" dataSourceName=... /&gt; <br/>&lt;/Realm&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/server.xml» - .*LockOutRealm.*" success="pass">
                            <ecl:path>${Value:catalina.base}/conf/server.xml</ecl:path>
                            <ecl:line-selection op="pm" value=".*LockOutRealm.*"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="connector-security-">
            <xccdf:title>Connector Security</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="setup-client-cert-authentication" role="full" selected="false" weight="1.0">
                <xccdf:title>Setup Client-cert Authentication</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Client-cert authentication requires that each client connecting to the server has a certificate used to authenticate. This is generally regarded as strong authentication than a password as it requires the client to have the cert and not just know a password. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Certificate based authentication is more secure than password based authentication. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review the Connector configuration in server.xml and ensure the clientAuth parameter is set to true. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Not configured </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://wiki.apache.org/tomcat/SSLWithFORMFallback <br/>2. http://tomcat.apache.org/tomcat-5.5-doc/ssl-howto.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In the Connector element, set the clientAuth parameter to true. <br/>
                        <br/>&lt;-- Define a SSL Coyote HTTP/1.1 Connector on port 8443 --&gt; <br/>&lt;Connector <br/> port="8443" minProcessors="5" maxProcessors="75" <br/> enableLookups="true" disableUploadTimeout="true" <br/> acceptCount="100" debug="0" scheme="https" secure="true"; <br/> clientAuth="true" sslProtocol="TLS"/&gt; <br/>
                        <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/server.xml» - clientAuth\s*=\s*&quot;true&quot;" success="pass">
                            <ecl:path>${Value:catalina.base}/conf/server.xml</ecl:path>
                            <ecl:line-selection op="pm" value="clientAuth\s*=\s*&quot;true&quot;"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="ensure-sslenabled-is-set-to-true-for-sensitive-connectors" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Ensure SSLEnabled is set to True for Sensitive Connectors</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The SSLEnabled setting determines if SSL is enabled for a specific Connector. It is recommended that SSL be utilized for any Connector that sends or receives sensitive information, such as authentication credentials or personal information. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: The SSLEnabled setting ensures SSL is active, which will in-turn ensure the confidentiality and integrity of sensitive information while in transit. <br/>
                        </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review server.xml and ensure all Connectors sending or receiving sensitive information have the SSLEnabled attribute set to true. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>SSLEnabled is set to false. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html <br/>2. http://tomcat.apache.org/tomcat-5.5-doc/ssl-howto.html <br/>3. http://tomcat.apache.org/tomcat-6.0-doc/config/http.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Set the SSLEngine attribute is set to on in the Listener node within server.xml. Also in server.xml, set the SSLEnabled attribute to true for each Connector that sends or receives sensitive information. <br/>
                        <br/>&lt;Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" /&gt; <br/>
                        <br/>&lt;Connector <br/>… <br/>SSLEnabled="true" <br/>… <br/>/&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="ensure-scheme-is-set-accurately" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure scheme is set accurately</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The scheme attribute is used to indicate to callers of request.getScheme() which scheme is in use by the Connector. Ensure the scheme attribute is set to http for Connectors operating over HTTP. Ensure the scheme attribute is set to https for Connectors operating of HTTPS. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Maintaining parity between the scheme in use by the Connector and advertised by request.getScheme() will ensure applications built on Tomcat have an accurate depiction of the context and security guarantees provided to them. <br/>
                        </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review server.xml to ensure the Connector's scheme attribute is set to http for Connectors operating over HTTP. Also ensure the Connector's scheme attribute is set to https for Connectors operating over HTTPS. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The scheme attribute is set to http. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html <br/>2. http://tomcat.apache.org/tomcat-5.5-doc/ssl-howto.html <br/>3. http://tomcat.apache.org/tomcat-6.0-doc/config/http.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In server.xml, set the Connector's scheme attribute to http for Connectors operating over HTTP. Set the Connector's scheme attribute to https for Connectors operating of HTTPS. <br/>
                        <br/>&lt;Connector <br/>… <br/>scheme="https" <br/>… <br/>/&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <!-- `expr` prints solution and returns TRUE=0, FALSE=1 -->
                        <!-- strip XML comments, regex search cleaned output, compare with other output -->
                        <ecl:shell-command check="all" comment="Same number of 'secure=true' directives and 'scheme=https' directives " success="pass">
                            <ecl:command>expr
                                `cat /opt/tomcat/conf/server.xml | sed '/&lt;!--.*--&gt;/d'| sed '/&lt;!--/,/--&gt;/d' |
                                egrep '[[:space:]]*&lt;secure=\"true\"[[:space:]]*' | wc -l` = 
                                `cat /opt/tomcat/conf/server.xml | sed '/&lt;!--.*--&gt;/d'| sed '/&lt;!--/,/--&gt;/d' |
                                egrep '[[:space:]]*scheme=\"https\"[[:space:]]*'  | wc -l`
                            </ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="ensure-secure-is-set-to-true-only-for-ssl-enabled-connectors" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure secure is set to true only for SSL-enabled Connectors</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The secure attribute is used to convey Connector security status to applications operating over the Connector. This is typically achieved by calling request.isSecure(). Ensure the secure attribute is only set to true for Connectors operating with the SSLEnabled attribute set to true. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Accurately reporting the security state of the Connector will help ensure that applications built on Tomcat are not unknowingly relying on security controls that are not in place. <br/>
                        </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review server.xml and ensure the secure attribute is set to true for those Connectors having SSLEnabled set to true. Also, ensure the secure attribute set to false for those Connectors having SSLEnabled set to false. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The secure attribute is set to false. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html <br/>2. http://tomcat.apache.org/tomcat-5.5-doc/ssl-howto.html <br/>3. http://tomcat.apache.org/tomcat-6.0-doc/config/http.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>For each Connector defined in server.xml, set the secure attribute to true for those Connectors having SSLEnabled set to true. Set the secure attribute set to false for those Connectors having SSLEnabled set to false. </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <check-content>
                        <!-- `expr` prints solution and returns TRUE=0, FALSE=1 -->
                        <!-- strip XML comments, regex search cleaned output, compare with other output -->
                        <ecl:shell-command check="all" comment="Same number of 'SSLEnabled=true' and 'secure=true' directives " success="pass">
                            <ecl:command>expr
                                `cat /opt/tomcat/conf/server.xml | sed '/&lt;!--.*--&gt;/d'| sed '/&lt;!--/,/--&gt;/d' |
                                egrep '[[:space:]]*SSLEnabled=\"true\"[[:space:]]*' | wc -l` = 
                                `cat /opt/tomcat/conf/server.xml | sed '/&lt;!--.*--&gt;/d'| sed '/&lt;!--/,/--&gt;/d' |
                                egrep '[[:space:]]*secure=\"true\"[[:space:]]*'  | wc -l`
                            </ecl:command>
                        </ecl:shell-command>
                    </check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="ensure-sslprotocol-is-set-to-tls-for-secure-connectors" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure sslProtocol is set to TLS for Secure Connectors</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The sslProtocol setting determines which protocol Tomcat will use to protect traffic. It is recommended that sslProtocol attribute be set to TLS. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: The TLS protocol does not contain weaknesses that affect other secure transport protocols, such as SSLv1 or SSLv2. Therefore, TLS is leveraged to protect the confidentiality and integrity of data while in transit. <br/>
                        </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review server.xml to ensure the sslProtocol attribute is set to TLS for all Connectors having SSLEngine set to on. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>If the sslProtocol attribute is not set, Tomcat will utilize TLS. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html <br/>2. http://tomcat.apache.org/tomcat-5.5-doc/ssl-howto.html <br/>3. http://tomcat.apache.org/tomcat-6.0-doc/config/http.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In server.xml, set the sslProtocol attribute to TLS for all Connectors having SSLEngine set to on. <br/>
                        <br/>&lt;Connector <br/>… <br/>sslProtocol="TLS" <br/>… <br/>/&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="none exist" comment="test «${Value:catalina.base}/conf/server.xml» - sslProtocol\s*=\s*(?!&quot;\s*TLS\s*&quot;)" success="fail">
                            <ecl:path>${Value:catalina.base}/conf/server.xml</ecl:path>
                            <ecl:line-selection op="pm" value="sslProtocol\s*=\s*&quot;\s*[^T].*?\s*&quot;"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="establish-and-protect-logging-facilities-">
            <xccdf:title>Establish and Protect Logging Facilities</xccdf:title>
            <xccdf:description>
                <xhtml:p>Enable logging and ensure logs are properly protected. </xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="application-specific-logging" role="full" selected="false" weight="1.0">
                <xccdf:title>Application specific logging</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>By default, java.util.logging does not provide the capabilities to configure per-web application settings, only per VM.  In order to overcome this limitation Tomcat implements JULI as a wrapper for java.util.logging. JULI provides additional configuration functionality so you can set each web application with different logging specifications. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Establishing per application logging profiles will help ensure that each application's logging verbosity is set to an appropriate level in order to provide appropriate information when needed for security review. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure a logging.properties file is locate at $CATALINA_BASE\&lt;app_name&gt;\WEB-INF\classes. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default, per application logging is not configured. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Create a logging.properties file and place that into your application WEB-INF\classes directory. <br/>
                        <br/>Note: By default, installing Tomcat places a logging.properties file in $CATALINA_HOME\conf. This file can be used as base for an application specific logging properties file. </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find -L ${Value:catalina.base} -name classes | xargs -I{} test -e {}/logging.properties || echo &quot;fail&quot;»" success="pass">
                            <ecl:command>find -L ${Value:catalina.base} -name classes | xargs -I{} test
                                -e {}/logging.properties || echo "fail"</ecl:command>
                            <ecl:line-selection op="pm" value="^fail$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="specify-file-handler-in-loggingproperties-files" role="full" selected="false" weight="1.0">
                <xccdf:title>Specify file handler in logging.properties files</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Utilizing file handlers will ensure that security event information is persisted to disk. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review each application's logging.properties file located in the applications $CATALINA_BASE\&lt;app name&gt;\WEB-INF\classes directory and determine if the file handler properties are set. <br/>$ grep handlers \ <br/>$CATALINA_BASE\&lt;app name&gt;\WEB-INF\classes\logging.properties <br/>In the instance where an application specific logging has not been created, the logging.properties file will be located in $CATALINA_BASE\conf. <br/>$ grep handlers $CATALINA_BASE\conf\logging.properties <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>No value for new applications by default. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Add the following entries to your logging.properties file if they do not exist. <br/>
                        <br/>handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler  <br/>
                        <br/>Ensure logging is not off and set the logging level to the desired level such as: <br/>
                        <br/>org.apache.juli.FileHandler.level=FINEST </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find -L ${Value:catalina.base} -name logging.properties | xargs grep org.apache.juli.FileHandler || echo &quot;fail&quot;»" success="pass">
                            <ecl:command>find -L ${Value:catalina.base} -name logging.properties | xargs
                                grep org.apache.juli.FileHandler || echo "fail"</ecl:command>
                            <ecl:line-selection op="pm" value="^fail$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="ensure-classname-is-set-correctly-in-contextxml" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure className is set correctly in context.xml</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Ensure the className attribute is set to FastCommonAccessLogValve. The className attribute determines the access log valve to be used for logging. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Some log valves are not suited for production and should be used. Apache recommends org.apache.catalina.valves.FastCommonAccessLogValve </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Execute the following to ensure className is set properly: <br/>
                            <br/># grep org.apache.catalina.valves.FastCommonAccessLogValve context.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Does not exist by default. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Add the following statement into the $CATALINA_BASE\&lt;app name&gt;\META-INF\context.xml file if it does not already exist. <br/>
                        <br/>&lt;Valve <br/> className="org.apache.catalina.valves.FastCommonAccessLogValve" <br/> directory="$CATALINA_HOME/logs/" <br/> prefix="access_log" <br/> fileDateFormat="yyyy-MM-dd.HH" <br/> suffix=".log" <br/> pattern="%t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r" <br/>/&gt; </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find -L ${Value:catalina.base} -name context.xml | xargs grep org.apache.catalina.valves.FastCommonAccessLogValve || echo &quot;fail&quot;»" success="pass">
                            <ecl:command>find -L ${Value:catalina.base} -name context.xml | xargs grep
                                org.apache.catalina.valves.FastCommonAccessLogValve || echo
                                "fail"</ecl:command>
                            <ecl:line-selection op="pm" value="^fail$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="ensure-directory-in-contextxml-is-a-secure-location" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Ensure directory in context.xml is a secure location</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The directory attribute tells Tomcat where to store logs. It is recommended that the location pointed to by the directory attribute be secured. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Securing the log location will help ensure the integrity and confidentiality of web application activity. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review the permissions of the directory specified by the directory setting to ensure the permissions are o-rwx and owned by tomcat_admin:tomcat: <br/># grep directory context.xml <br/># ls –l &lt;log location&gt; <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Does not exist by default. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following: <br/>1. Add the following statement into the $CATALINA_BASE\&lt;app name&gt;\META-INF\context.xml file if it does not already exist. <br/>
                        <br/>&lt;Valve <br/> className="org.apache.catalina.valves.FastCommonAccessLogValve" <br/> directory="$CATALINA_HOME/logs/" <br/> prefix="access_log" <br/> fileDateFormat="yyyy-MM-dd.HH" <br/> suffix=".log" <br/> pattern="%t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r" <br/>/&gt; <br/>2. Set the location pointed to by the directory attribute to be owned by tomcat_admin:tomcat with permissions of o-rwx. <br/>
                        <br/># chown tomcat_admin:tomcat $CATALINA_HOME/logs <br/># chmod o-rwx $CATALINA_HOME/logs </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="ensure-pattern-in-contextxml-is-correct" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Ensure pattern in context.xml is correct</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The pattern setting informs Tomcat what information should be logged. At a minimum, enough information to uniquely identify a request, what was requested, where the requested originated from, and when the request occurred should be logged. <br/>
                            <br/>The following will log the request date and time (%t), the requested URL (%U), the remote IP address (%a), the local IP address (%A), the request method (%m), the local port (%p), query string, if present, (%q), and the HTTP status code of the response (%s). <br/>pattern="%t %U %a %A %m %p %q %s" <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: The level of logging detail prescribed will assist in identifying correlating security events or incidents. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review the pattern settings to ensure it contains all the variables required by the installation. <br/>
                            <br/># grep pattern context.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Does not exist by default. <br/>
                            <br/>Reference: <br/>1. http://tomcat.apache.org/tomcat-5.5-doc/config/valve.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Add the following statement into the $CATALINA_BASE\&lt;app name&gt;\META-INF\context.xml file if it does not already exist. <br/>
                        <br/>&lt;Valve <br/> className="org.apache.catalina.valves.FastCommonAccessLogValve" <br/> directory="$CATALINA_HOME/logs/" <br/> prefix="access_log" <br/> fileDateFormat="yyyy-MM-dd.HH" <br/> suffix=".log" <br/> pattern="%h %t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r" <br/>/&gt; </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="ensure-directory-in-loggingproperties-is-a-secure-location" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Ensure directory in logging.properties is a secure location</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The directory attribute tells Tomcat where to store logs. The directory value should be a secure location with restricted access. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Securing the log location will help ensure the integrity and confidentiality of web application activity records. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review the permissions of the directory specified by the directory setting to ensure the permissions are o-rwx and owned by tomcat_admin:tomcat: <br/># grep directory logging.properties <br/># ls –l &lt;log_location&gt; <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The directory location is configured to store logs in $CATALINA_BASE/logs. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following: <br/>1. Add the following properties into your logging.properties file if they do not exist. <br/>
                        <br/>&lt;application_name&gt;.org.apache.juli.FileHandler.directory=&lt;log_location&gt; <br/>&lt;application_name&gt;.org.apache.juli.FileHandler.prefix=&lt;application_name&gt; <br/>
                        <br/>2. Set the location pointed to by the directory attribute to be owned by tomcat_admin:tomcat with permissions of o-rwx. <br/>
                        <br/># chown tomcat_admin:tomcat &lt;log_location&gt; <br/># chmod o-rwx &lt;log_location&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="configure-log-file-size-limit" role="full" selected="false" weight="1.0">
                <xccdf:title>Configure log file size limit</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>By default, the logging.properties file will have no defined limit for the log file size. This is a potential denial of service attack as it would be possible to fill a drive or partition containing the log files. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Establishing a maximum log size that is smaller than the partition size will help mitigate the risk of an attacker maliciously exhausting disk space. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Validate the max file limit is not greater than the size of the partition where the log files are stored. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>No limit by default. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Create the following entry in your logging.properties file. This field is specified in bytes. <br/>
                        <br/>java.util.logging.FileHandler.limit=10000 </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find -L ${Value:catalina.base} -name logging.properties | xargs grep ^java.util.logging.FileHandler.limit || echo &quot;fail&quot;»" success="pass">
                            <ecl:command>find -L ${Value:catalina.base} -name logging.properties | xargs
                                grep ^java.util.logging.FileHandler.limit || echo
                                "fail"</ecl:command>
                            <ecl:line-selection op="pm" value="^fail$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="configure-catalina-policy-">
            <xccdf:title>Configure Catalina Policy</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="restrict-runtime-access-to-sensitive-packages" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Restrict runtime access to sensitive packages</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>package.access grants or revokes access to listed packages during runtime. It is recommended that application access to certain packages be restricted. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Prevent web applications from accessing restricted or unknown packages which may be malicious or dangerous to the application. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review package.access list in $CATALINA_BASE/conf/catalina.properties to ensure only allowed packages are defined. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default package.access value within $CATALINA_BASE/conf/catalina.properties is: <br/>package.access = sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat., org.apache.jasper <br/>
                        </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Edit $CATALINA_BASE/conf/catalina.properties by adding allowed packages to the package.access list: <br/>
                        <br/>package.access = sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat., org.apache.jasper <br/>
                    </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="application-deployment-">
            <xccdf:title>Application Deployment</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="starting-tomcat-with-security-manager" role="full" selected="false" weight="1.0">
                <xccdf:title>Starting Tomcat with Security Manager</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Configure application to run in a sandbox using the Security Manager. The Security Manager restricts what classes Tomcat can access thus protecting your server from mistakes, Trojans, and malicious code. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: By running Tomcat with the Security Manager, applications are run in a sandbox which can prevent untrusted code from accessing files on the file system. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review the start up configuration in /etc/init.d for Tomcat to ascertain if Tomcat is started with the -security option <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default the -security option is not utilized. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-5.5-doc/security-manager-howto.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>The security policies implemented by the Java SecurityManager are configured in the $CATALINA_HOME/conf/catalina.policy file. Once you have configured the catalina.policy file for use with a SecurityManager, Tomcat can be started with a SecurityManager in place by using the --security option: <br/>
                        <br/>$ $CATALINA_HOME/bin/catalina.sh start -security (Unix) <br/>C:\&gt; %CATALINA_HOME%\bin\catalina start -security (Windows) <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «cat /etc/tomcat6/tomcat6.conf»" success="pass">
                            <ecl:command>cat /etc/tomcat6/tomcat6.conf</ecl:command>
                            <ecl:line-selection op="pm" value="^SECURITY_MANAGER\s*=\s*&quot;true&quot;$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="disabling-auto-deployment-of-applications" role="full" selected="false" weight="1.0">
                <xccdf:title>Disabling auto deployment of applications</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Tomcat allows auto deployment of applications while Tomcat is running. It is recommended that this capability be disabled. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: This could allow malicious or untested applications to be deployed and should be disabled. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to ensure autoDeploy is set to false. <br/>
                            <br/># grep "autoDeploy" $CATALINA_HOME/conf/server.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>autoDeploy is set to true </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/deployer-howto.html#Deployment%20on%20Tomcat%20startup </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In the $CATALINA_HOME/conf/server.xml file, change autoDeploy to false. <br/>
                        <br/>autoDeploy="false" <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/server.xml» - autoDeploy\s*=\s*&quot;false&quot;" success="pass">
                            <ecl:path>${Value:catalina.base}/conf/server.xml</ecl:path>
                            <ecl:line-selection op="pm" value="autoDeploy\s*=\s*&quot;false&quot;"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="disable-deploy-on-startup-of-applications" role="full" selected="false" weight="1.0">
                <xccdf:title>Disable deploy on startup of applications</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Tomcat allows auto deployment of applications. It is recommended that this capability be disabled. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: This could allow malicious or untested applications to be deployed and should be disabled. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Perform the following to ensure deployOnStartup is set to false. <br/>
                            <br/># grep "deployOnStartup" $CATALINA_HOME/conf/server.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>deployOnStartup is set to true </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/deployer-howto.html#Deployment%20on%20Tomcat%20startup <br/>
                        </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In the $CATALINA_HOME/conf/server.xml file, change deployOnStartup to false. <br/>
                        <br/>deployOnStartup="false" <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/server.xml» - deployOnStartup\s*=\s*&quot;false&quot;" success="pass">
                            <ecl:path>${Value:catalina.base}/conf/server.xml</ecl:path>
                            <ecl:line-selection op="pm" value="deployOnStartup\s*=\s*&quot;false&quot;"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="miscellaneous-configuration-settings-">
            <xccdf:title>Miscellaneous Configuration Settings</xccdf:title>
            <xccdf:description>
                <xhtml:p/>
            </xccdf:description>
            <xccdf:Rule id="ensure-web-content-directory-is-on-a-separate-partition-from-the-tomcat-system-files" role="unchecked" selected="false">
                <xccdf:title>Ensure Web content directory is on a separate partition from the Tomcat system files</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Store web content on a separate partition from Tomcat system files. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: The web document directory is where the files which are severed to the end user reside. In the past, directory traversal exploits have allowed malicious users to play havoc on a web server including executing code, uploading files, and reading sensitive data. Even if you do not have any directory traversal exploits in your server or code at this time, that doesn't mean they won't be introduced in the future. Moving your web document directory onto a different partition will prevent these kinds of attacks from doing more damage to other part of the file system. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Locate the Tomcat system files and web content directory. Review the system partitions and ensure the system files and web content directory are on separate partitions. <br/>
                            <br/># more /etc/init.d/tomcat* | grep $CATALINA_HOME <br/># more /etc/fstab <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>Not Applicable </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Move the web content files to a separate partition from the tomcat system files and update your configuration. <br/>
                    </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-access-to-the-web-administration" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Restrict access to the web administration</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Limit access to the web administration application to only those with a required needed. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Limiting access to the least privilege required will ensure only those people with required need have access to a resource. The web administration application should be limited to only administrators. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review $CATALINA_HOME/conf/server.xml to ascertain that the RemoteAddrValve option is uncommented and configured to only allow access to systems required to connect. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default, this configuration is not present. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://www.unidata.ucar.edu/Projects/THREDDS/tech/reference/TomcatSecurity.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>For the administration application, edit $CATALINA_HOME/conf/server.xml and uncomment the following: <br/>
                        <br/>&lt;Valve className="org.apache.catalina.valves.RemoteAddrValve" allow="127\.0\.0\.1"/&gt; <br/>
                        <br/>Note: The RemoteAddrValve property expects a regular expression, therefore periods and other regular expression meta-characters must be escaped. <br/>
                    </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-manager-application" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Restrict manager application</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Limit access to the manager application to only those with a required needed. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Limiting access to the least privilege required will ensure only those people with required need have access to a resource. The manager application should be limited to only administrators. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Review $CATALINA_HOME/conf/Catalina/localhost/webapps/manager.xml on Tomcat 5.5 and $CATALINA_HOME/webapps/host-manager/manager.xml on Tomcat 6.X to ascertain that the RemoteAddrValve option is uncommented and configured to only allow access to systems required to connect. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default this setting is not present. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://www.unidata.ucar.edu/Projects/THREDDS/tech/reference/TomcatSecurity.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>For the manager application, edit $CATALINA_HOME/conf/Catalina/localhost/webapps/manager.xml in Tomcat 5.5 and $CATALINA_HOME/webapps/host-manager/manager.xml in Tomcat 6.X, and add the bolded line: <br/>&lt;Context path="/manager" docBase="${catalina.base}/server/webapps/manager" debug="0" privileged="true"&gt; <br/>
                        <br/> &lt;Valve className="org.apache.catalina.valves.RemoteAddrValve" <br/> allow="127\.0\.0\.1"/&gt; <br/>
                        <br/> &lt;!-- Link to the user database we will get roles from --&gt; <br/> &lt;ResourceLink name="users" global="UserDatabase" <br/> type="org.apache.catalina.UserDatabase"/&gt; <br/>&lt;/Context&gt; <br/>Add hosts, comma separated, which are allowed to access the admin application. <br/>
                        <br/>Note: The RemoteAddrValve property expects a regular expression, therefore periods and other regular expression meta-characters must be escaped. <br/>
                    </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="force-ssl-when-accessing-the-manager-application" role="full" selected="false" weight="1.0">
                <xccdf:title>Force SSL when accessing the manager application</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Use the transport-guarantee attribute to ensure SSL protection when accessing the manager application. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: By default when accessing the manager application, login information is sent over the wire in plain text. By using the transport-guarantee attribute within web.xml, SSL is enforced. <br/>NOTE: This requires SSL to be configured. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure $CATALINA_HOME/webapps/manager/WEB-INF/web.xml in Tomcat 6.X and $CATALINA_HOME/server/webapps/manager/WEB-INF/web.xml in Tomcat 5.5 has the &lt;transport-guarantee&gt; attribute set to CONFIDENTIAL. <br/>
                            <br/># grep transport-guarantee \ <br/> $CATALINA_HOME/webapps/manager/WEB-INF/web.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default this configuration is not present. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://www.owasp.org/index.php/Securing_tomcat </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Set $CATALINA_HOME/webapps/manager/WEB-INF/web.xml in Tomcat 6.X and in Tomcat 5.5 set $CATALINA_HOME/server/webapps/manager/WEB-INF/web.xml: <br/>
                        <br/>&lt;security-constraint&gt; <br/> &lt;user-data-constraint&gt; <br/> &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt; <br/> &lt;user-data-constraint&gt; <br/>&lt;/security-constraint&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:file-content check="all" comment="test «${Value:catalina.base}/server/webapps/manager/WEB-INF/web.xml» - &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;" success="pass">
                                <ecl:path>${Value:catalina.base}/server/webapps/manager/WEB-INF/web.xml</ecl:path>
                                <ecl:line-selection op="pm" value="&lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;"/>
                            </ecl:file-content>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:file-content check="all" comment="test «${Value:catalina.base}/webapps/manager/WEB-INF/web.xml» - &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;" success="pass">
                                <ecl:path>${Value:catalina.base}/webapps/manager/WEB-INF/web.xml</ecl:path>
                                <ecl:line-selection op="pm" value="&lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;"/>
                            </ecl:file-content>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/manager/WEB-INF/web.xml»" success="fail">
                                    <ecl:command>test -e
                                    ${Value:catalina.base}/webapps/manager/WEB-INF/web.xml</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/server/webapps/manager/WEB-INF/web.xml»" success="fail">
                                    <ecl:command>test -e
                                    ${Value:catalina.base}/server/webapps/manager/WEB-INF/web.xml</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="rename-the-manager-application" role="full" selected="false" weight="1.0">
                <xccdf:title>Rename the manager application</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The manager application allows administrators to manage Tomcat remotely via a web interface. The manager application should be renamed to make it harder for attackers or automated scripts to locate. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Obscurity can be helpful when used with other security measures. By relocating the manager applications, an attacker will need to guess its location rather than simply navigate to the standard location in order to carry out an attack. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure $CATALINA_HOME/conf/Catalina/localhost/manager.xml, $CATALINA_HOME/webapps/host-manager/manager.xml, $CATALINA_HOME/server/webapps/manager and $CATALINA_HOME/webapps/manager do not exsist. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>The default name of the manager application is "manager" and is located at: <br/> For Tomcat 5.5: <br/>$CATALINA_HOME/server/webapps/manager <br/>
                            <br/>For Tomcat 6.X: <br/>$CATALINA_HOME/webapps/manager </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://www.owasp.org/index.php/Securing_tomcat </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Perform the following to rename the manager application: <br/>
                        <br/>1. Rename the manager application XML file: <br/> For Tomcat 5.5 <br/># mv $CATALINA_HOME/conf/Catalina/localhost/manager.xml \ $CATALINA_HOME/conf/Catalina/localhost/new-name.xml <br/>
                        <br/> For Tomcat 6.X <br/># mv $CATALINA_HOME/webapps/host-manager/manager.xml \ $CATALINA_HOME/webapps/host-manager/new-name.xml <br/>
                        <br/>2. Update the docBase attribute within $CATALINA_HOME/conf/Catalina/localhost/new-name.xml (Tomcat 5.5), $CATALINA_HOME/webapps/host-manager/new-name.xml (Tomcat 6.X) to ${catalina.base}/server/webapps/new-name <br/>
                        <br/>In Tomcat 5.5 move $CATALINA_HOME/server/webapps/manager to $CATALINA_HOME/server/webapps/new-name3. <br/> In Tomcat 6.X move $CATALINA_HOME/webapps/manager to <br/> $CATALINA_HOME/webapps/new-name <br/>
                        <br/> For Tomcat 5.5 <br/># mv $CATALINA_HOME/server/webapps/manager \ $CATALINA_HOME/server/webapps/new-name <br/>
                        <br/> For Tomcat 6.X <br/># mv $CATALINA_HOME/webapps/manager $CATALINA_HOME/webapps/new-name <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/conf/Catalina/localhost/manager.xml»" success="fail">
                                <ecl:command>test -e
                                ${Value:catalina.base}/conf/Catalina/localhost/manager.xml</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/host-manager/manager.xml»" success="fail">
                                <ecl:command>test -e
                                ${Value:catalina.base}/webapps/host-manager/manager.xml</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/server/webapps/manager»" success="fail">
                                <ecl:command>test -e
                                ${Value:catalina.base}/server/webapps/manager</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «test -e ${Value:catalina.base}/webapps/manager»" success="fail">
                                <ecl:command>test -e
                                ${Value:catalina.base}/webapps/manager</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="enable-strict-servlet-compliance" role="full" selected="false" weight="1.0">
                <xccdf:title>Enable strict servlet Compliance</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The STRICT_SERVLET_COMPLIANCE influences Tomcat's behavior in several subtle ways. See the References below for the complete list. It is recommended that STRICT_SERVLET_COMPLIANCE be set to true. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: When STRICT_SERVLET_COMPLIANCE is set to true, Tomcat will always send an HTTP Content-type header when responding to requests. This is significant as the behavior of web browsers is inconsistent in the absence of the Content-type header. Some browsers will attempt to determine the appropriate content-type by sniffing </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure the above parameter is added to the start up script which by default is located at $CATALINA_HOME\bin\catalina.sh. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default this configuration parameter is not present. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/config/systemprops.html <br/>2. http://mail-archives.apache.org/mod_mbox/tomcat-dev/200906.mbox/%3C4A315DD0.8070706@apache.org%3E </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Start Tomcat with strict compliance enabled. Add the following to your startup script. <br/>
                        <br/>-Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="STRICT_SERVLET_COMPLIANCE=true in ${Value:catalina.base}/bin/catalina.sh" success="pass">
                            <ecl:command>egrep "\-Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true" ${Value:catalina.base}/bin/catalina.sh</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="turn-off-session-façade-recycling" role="full" selected="false" weight="1.0">
                <xccdf:title>Turn off session façade recycling</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The RECYCLE_FACADES can specify if a new façade will be created for each request. If a new façade is not created there is a potential for information leakage from other sessions. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: When RECYCLE_FACADES is set to true, Tomcat will recycle the session façade between requests. This will allow for information leakage between requests. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure the above parameter is added to the start up script which by default is located at $CATALINA_HOME\bin\catalina.sh. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default recycling of facades is set to false. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/config/systemprops.html <br/>2. http://www.jeremythomerson.com/blog/2008/11/apachecon-securing-apache-tomcat-for-your-environment/ </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Start Tomcat with RECYCLE_FACADES set to false. Add the following to your startup script. <br/>
                        <br/>-Dorg.apache.catalina.connector.RECYCLE_FACADES=false <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="RECYCLE_FACADES=false in ${Value:catalina.base}/bin/catalina.sh" success="pass">
                            <ecl:command>egrep "\-Dorg.apache.catalina.connector.RECYCLE_FACADES=false" ${Value:catalina.base}/bin/catalina.sh</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-allow-additional-path-delimiters" role="full" selected="false" weight="1.0">
                <xccdf:title>Do not allow additional path delimiters</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Being able to specify different path-delimiters on Tomcat creates the possibility that an attacker can access applications that were previously blocked a proxy like mod_proxy. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Allowing additional path-delimiters allows for an attacker to get an application or area that was not previously visible. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure the above parameters are added to the start up script which by default is located at $CATALINA_HOME\bin\catalina.sh. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default allowing additional parameters is set to false. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/config/systemprops.html <br/>2. http://www.jeremythomerson.com/blog/2008/11/apachecon-securing-apache-tomcat-for-your-environment/ <br/>3. https://www.covalent.net/download/patch2.0/README-ers-3.1.0-patch-tomcat-20070315.txt </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Start Tomcat with ALLOW_BACKSLASH set to false and ALLOW_ENCODED_SLASH set to false. Add the following to your startup script. <br/>
                        <br/>-Dorg.apache.catalina.connector. CoyoteAdapter.ALLOW_BACKSLASH=false <br/>-Dorg.apache.tomcat.util.buf. UDecoder.ALLOW_ENCODED_SLASH=false <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Set ALLOW_BACKSLASH=false in catalina.sh" success="pass">
                                <ecl:command>egrep "\-Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false" ${Value:catalina.base}/bin/catalina.sh </ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Set ALLOW_ENCODED_SLASH=false in catalina.sh" success="pass">
                                <ecl:command>egrep "\-Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false" ${Value:catalina.base}/bin/catalina.sh</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-allow-custom-header-status-messages" role="full" selected="false" weight="1.0">
                <xccdf:title>Do not allow custom header status messages</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Being able to specify custom status messages opens up the possibility for additional headers to be injected. If custom header status messages are required make sure it is only in US-ASCII and does not include any user-supplied data. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Allowing user-supplied data into a header allows the possibility of XSS. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure the above parameter is added to the start up script which by default is located at $CATALINA_HOME\bin\catalina.sh. <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default allowing custom header status messages is set to false. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/config/systemprops.html <br/>http://www.jeremythomerson.com/blog/2008/11/apachecon-securing-apache-tomcat-for-your-environment/2. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Start Tomcat with USE_CUSTOM_STATUS_MSG_IN_HEADER set to false. Add the following to your startup script. <br/>
                        <br/>-Dorg.apache.coyote.USE_CUSTOM_STATUS_MSG_IN_HEADER=false <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="USE_CUSTOM_STATUS_MSG_IN_HEADER=false" success="pass">
                            <ecl:command>egrep "\-Dorg.apache.coyote.USE_CUSTOM_STATUS_MSG_IN_HEADER=false" ${Value:catalina.base}/bin/catalina.sh</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configure-connectiontimeout" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Configure connectionTimeout</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The connectionTimeout setting allows Tomcat to close idle sockets after a specific amount of time to save system resources. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Closing idle sockets reduces system resource usage thus can provide better performance and help protect against Denial of Service attacks. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Locate each connectionTimeout setting in $CATALINA_HOME/conf/server.xml and verify the setting is correct. <br/>
                            <br/># grep connectionTimeout $CATALINA_HOME/conf/server.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>connectionTimeout is set to 60000 </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/connectors-doc/generic_howto/timeouts.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Within $CATALINA_HOME/conf/server.xml ensure each connector is configured to the connectionTimeout setting that is optimal based on hardware resources, load, and number of concurrent connections. <br/>
                        <br/>connectionTimeout="60000" <br/>
                    </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="configure-maxhttpheadersize" role="full" selected="false" weight="1.0">
                <xccdf:title>Configure maxHttpHeaderSize</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>The maxHttpHeaderSize limits the size of the request and response headers defined in bytes. If not specified, the default is 8192 bytes. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Limiting the size of the header request can help protect against Denial of Service requests. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Locate each maxHttpHeaderSize setting in $CATALINA_HOME/conf/server.xml and verify that they are set to 8192. <br/>
                            <br/># grep maxHttpHeaderSize $CATALINA_HOME/conf/server.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>maxHttpHeaderSize is set to 8192 </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>1. http://tomcat.apache.org/tomcat-6.0-doc/config/http.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Within $CATALINA_HOME/conf/server.xml ensure each connector is configured to the appropriate maxHttpHeaderSize setting. <br/>
                        <br/>maxHttpHeaderSize="8192" <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="maxHttpHeaderSize is less than 8192" success="pass">
                            <ecl:command>egrep -i "maxHttpHeaderSize" ${Value:catalina.base}/conf/server.xml</ecl:command>
                            <ecl:line-selection op="pm" value="maxHttpHeaderSize\s*=\s*&quot;(\d+)&quot;">
                                <ecl:regex-group dt="xs:integer" group="1" op="le" value="8192"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="force-ssl-for-all-applications" role="full" selected="false" weight="1.0">
                <xccdf:title>Force SSL for all applications</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Use the transport-guarantee attribute to ensure SSL protection when accessing all applications. This can be overridden to be disabled on a per application basis in the application configuration. </xhtml:p>
                        <xhtml:p class="rationale">Rationale: By default when accessing applications SSL will be enforced to protect information sent over the network. By using the transport-guarantee attribute within web.xml, SSL is enforced. <br/>NOTE: This requires SSL to be configured. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure $CATALINA_HOME/conf/web.xml has the &lt;transport-guarantee&gt; attribute set to CONFIDENTIAL. <br/>
                            <br/># grep transport-guarantee $CATALINA_HOME/conf/web.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default this configuration is not present. </xhtml:p>
                        <xhtml:p class="references">References:</xhtml:p>
                        <xhtml:p>http://www.owasp.org/index.php/Securing_tomcat1. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In $CATALINA_HOME/conf/web.xml, set the following: <br/>
                        <br/>&lt;user-data-constraint&gt; <br/> &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt; <br/>&lt;user-data-constraint&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/web.xml» - &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;" success="pass">
                            <ecl:path>${Value:catalina.base}/conf/web.xml</ecl:path>
                            <ecl:line-selection op="pm" value="&lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="increase-the-entropy-in-session-identifiers" role="full" selected="false" weight="1.0">
                <xccdf:title>Increase the entropy in session identifiers</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Having a server that has deterministic session identifiers can lead to session hi-jacking. Specifying a randomClass attribute allows for truly random session identifiers. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: By default the entropy attribute on session managers uses the string representation of the Manager class name. Leading to a deterministic session identifier. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure $CATALINA_HOME/conf/context.xml has the randomClass attribute set to java.security.SecureRandom. <br/>
                            <br/># grep randomClass $CATALINA_HOME/conf/context.xml <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default the string representation of the Manager class is used for entropy. <br/>
                            <br/>Reference: <br/>1. http://www.jeremythomerson.com/blog/2008/11/apachecon-securing-apache-tomcat-for-your-environment/ </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In $CATALINA_HOME/conf/context.xml, set the following: <br/>
                        <br/>&lt;Manager ... randomClass="java.security.SecureRandom" /&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="test «${Value:catalina.base}/conf/context.xml» - randomClass\s*=\s*&quot;java.security.SecureRandom&quot;" success="pass">
                            <ecl:path>${Value:catalina.base}/conf/context.xml</ecl:path>
                            <ecl:line-selection op="pm" value="randomClass\s*=\s*&quot;java.security.SecureRandom&quot;"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-allow-symbolic-linking" role="full" selected="false" weight="1.0">
                <xccdf:title>Do not allow symbolic linking</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Symbolic links allows one application to include the libraries from another. This allows for re-use of code but also allows for potential security issues when applications include libraries from other applications they should not have access to. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Allowing symbolic links opens up all Tomcat versions prior to 6.0.18 to directory traversal vulnerability. Also there is a potential that an application could link to another application it should not be linking too. On case-insensitive operating systems there is also the threat of source code disclosure. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure all context.xml have the allowLinking attribute set to false or allowLinking does not exist. <br/>
                            <br/># find . -name context.xml | xargs grep "allowLinking" <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default allowLinking has a value of false. <br/>
                            <br/>Reference: <br/>1. http://eu.apachecon.com/presentation/materials/78/2009-03-26-SecuringApacheTomcat.pdf <br/>2. http://tomcat.apache.org/tomcat-6.0-doc/config/context.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In all context.xml, set the allowLinking attribute to false: <br/>
                        <br/>&lt;Context ... allowLinking="false" /&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base} -name context.xml | xargs grep &quot;allowLinking&quot;»" success="fail">
                            <ecl:command>find ${Value:catalina.base} -name context.xml | xargs grep
                            "allowLinking"</ecl:command>
                            <ecl:line-selection op="pm" value="allowLinking\s*=\s*&quot;true&quot;"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-run-applications-as-privileged" role="full" selected="false" weight="1.0">
                <xccdf:title>Do not run applications as privileged</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Setting the privileged attribute for an application changes the class loader to the Server class loader instead of the Shared class loader. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Running an application in privileged mode allows an application to load the manager libraries. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure all context.xml have the privileged attribute set to false or privileged does not exist. <br/>
                            <br/># find . -name context.xml | xargs grep "privileged" <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default privileged has a value of false. <br/>
                            <br/>Reference: <br/>1. http://eu.apachecon.com/presentation/materials/78/2009-03-26-SecuringApacheTomcat.pdf <br/>2. http://tomcat.apache.org/tomcat-6.0-doc/config/context.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In all context.xml, set the privileged attribute to false unless it is required like the manager application: <br/>
                        <br/>&lt;Context ... privileged="false" /&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base} -name context.xml | xargs grep &quot;privileged&quot;»" success="fail">
                            <ecl:command>find ${Value:catalina.base} -name context.xml | xargs grep
                            "privileged"</ecl:command>
                            <ecl:line-selection op="pm" value="privileged\s*=\s*&quot;true&quot;"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-allow-cross-context-requests" role="full" selected="false" weight="1.0">
                <xccdf:title>Do not allow cross context requests</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Setting crossContext to true allows for an application to call ServletConext.getContext to return a dispatcher for another application. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Allowing crossContext creates the possibility for a malicious application to make requests to a restricted application. </xhtml:p>
                        <xhtml:p class="level">Level: 1</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure all context.xml have the crossContext attribute set to false or crossContext does not exist. <br/>
                            <br/># find . -name context.xml | xargs grep "crossContext" <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default crossContext has a value of false. <br/>
                            <br/>Reference: <br/>1. http://eu.apachecon.com/presentation/materials/78/2009-03-26-SecuringApacheTomcat.pdf <br/>2. http://tomcat.apache.org/tomcat-6.0-doc/config/context.html </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In all context.xml, set the crossContext attribute to false: <br/>
                        <br/>&lt;Context ... crossContext="false" /&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base} -name context.xml | xargs grep &quot;crossContext&quot;»" success="fail">
                            <ecl:command>find ${Value:catalina.base} -name context.xml | xargs grep
                            "crossContext"</ecl:command>
                            <ecl:line-selection op="pm" value="crossContext\s*=\s*&quot;true&quot;"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-resolve-hosts-on-logging-valves" role="full" selected="false" weight="1.0">
                <xccdf:title>Do not resolve hosts on logging valves</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="explanation">Description:</xhtml:p>
                        <xhtml:p>Setting resolveHosts to true on logging valves requires a DNS look-up before logging the information. This adds additional resources when logging. <br/>
                        </xhtml:p>
                        <xhtml:p class="rationale">Rationale: Allowing resolveHosts adds additional overhead that is rarely needed. </xhtml:p>
                        <xhtml:p class="level">Level: 2</xhtml:p>
                        <xhtml:p class="audit">Audit:</xhtml:p>
                        <xhtml:p>Ensure all Valve nodes have the resolveHosts attribute set to false or resolveHosts does not exist. <br/>
                            <br/># find . -name *.xml | xargs grep "resolveHosts" <br/>
                        </xhtml:p>
                        <xhtml:p class="default-value">Default Value:</xhtml:p>
                        <xhtml:p>By default resolveHosts has a value of false. <br/>
                            <br/>Reference: <br/>1. http://eu.apachecon.com/presentation/materials/78/2009-03-26-SecuringApacheTomcat.pdf <br/>2. http://tomcat.apache.org/tomcat-6.0-doc/config/valve.html <br/>
                            <br/>Appendix A: Change History <br/>Date <br/>Version <br/>Changes for this version <br/>December 12th , 2009 </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In all context.xml and server.xml that have Valve nodes, set the resolveHosts attribute to false: <br/>
                        <br/>&lt;Valve ... resolveHosts="false" /&gt; <br/>
                    </xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find ${Value:catalina.base} -name *.xml | xargs grep &quot;resolveHosts&quot;»" success="fail">
                            <ecl:command>find ${Value:catalina.base} -name context.xml | xargs grep
                            "resolveHosts"</ecl:command>
                            <ecl:line-selection op="pm" value="resolveHosts\s*=\s*&quot;true&quot;"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
    </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>LJON0Tr5SVkSni8eSURipiW49Bg=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
UQXPtcfkqWLAFQRdQXz88xfKfpeDy+vA56vaqKIRz9wB1x+rgd2xtxHIncRdcqRkIA0Wp+qIeNyu
/wvZSX8T2a+rdKAmFgP3nuunw2+M2+tRl6Y6uThd/FUmrxGYGNmsAnRc5VryDtxW/+UN7i9Q7SOm
u1H+SUaWL1RBVo7UUwYMZXItu9JN/+icO0iZSVWMOzVbJnDlNPR77qe+hLMT7UUNPXaqmZZJwkmH
XdhrWEFfFeF9I0uQCeJ+hvjacVXXD4ZlWUdjmH7eEssCzsTdrdFw0/oInxLm3FZ82tiF2RX1tL2F
aI492c2qHrAsguwXgkjbyx7kCAykHQkxFpZ3hw==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFRzCCBC+gAwIBAgIHTwpN/4tOfDANBgkqhkiG9w0BAQsFADCBtDELMAkGA1UEBhMCVVMxEDAO
BgNVBAgTB0FyaXpvbmExEzARBgNVBAcTClNjb3R0c2RhbGUxGjAYBgNVBAoTEUdvRGFkZHkuY29t
LCBJbmMuMS0wKwYDVQQLEyRodHRwOi8vY2VydHMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8xMzAx
BgNVBAMTKkdvIERhZGR5IFNlY3VyZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkgLSBHMjAeFw0xNDA5
MTgxNDM0MjFaFw0xNzEwMjAxODU3NDRaMIGTMQswCQYDVQQGEwJVUzERMA8GA1UECBMITmV3IFlv
cmsxFzAVBgNVBAcTDkVhc3QgR3JlZW5idXNoMSswKQYDVQQKEyJDZW50ZXIgZm9yIEludGVybmV0
IFNlY3VyaXR5LCBJbmMuMSswKQYDVQQDEyJDZW50ZXIgZm9yIEludGVybmV0IFNlY3VyaXR5LCBJ
bmMuMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0MGnj6yX2QHklGadAfTBxssvP+2f
YegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzNgOhQx3HcclRwQB4xj/14hOoZSeQ3
haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WYFpSRjZ/Z7m5QKii0feJPxbf+wrZ+
UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKcUY2d3WZ4Zk+zawFcRUYslVIrOhMb
0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7enWCRfZrRWAlDHFaouLdtU/OmXc+
Um7cLwz8VQIDAQABo4IBezCCAXcwDAYDVR0TAQH/BAIwADATBgNVHSUEDDAKBggrBgEFBQcDAzAO
BgNVHQ8BAf8EBAMCB4AwNQYDVR0fBC4wLDAqoCigJoYkaHR0cDovL2NybC5nb2RhZGR5LmNvbS9n
ZGlnMnM1LTAuY3JsMFMGA1UdIARMMEowSAYLYIZIAYb9bQEHFwIwOTA3BggrBgEFBQcCARYraHR0
cDovL2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5LzB2BggrBgEFBQcBAQRqMGgw
JAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmdvZGFkZHkuY29tLzBABggrBgEFBQcwAoY0aHR0cDov
L2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5L2dkaWcyLmNydDAfBgNVHSMEGDAW
gBRAwr0njsw0gzCiM9f7bLPwtCyAzjAdBgNVHQ4EFgQU+3zn+CEg6a2xPqlBXvn64hUyoB4wDQYJ
KoZIhvcNAQELBQADggEBAEh76h1GtJ0pj04in+RUymB7fqPh6HFILkOLlTPnveyXCoHYT2M46DET
EA/NKYkoF2KA3QiZ1b+PMViuTYG2pDs71eFVPADuBCGf9IFufCDY9mPvjQiFDlLNMknXxACD8TjC
hqz+uZT2uLPw/YxkJIsCxrTQJ//ga/fHfZDrKgQfbVzxjD/4WKDe8HktjKcn+NWGPJNMgmO+IHrK
if6TB1xTo32W9QzwoXvBdLnziAUGZZghEulq6h3RCMzKPzpx5JiLlOz6JzqXHvrua+yUbr4A29Vy
vkwWgJWjyvJd2uq9MQ9l49kkrD84m41PSwpaHO99nEHRgRykopxIt8AHsIQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>