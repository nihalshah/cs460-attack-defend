<?xml version="1.0" encoding="UTF-8" standalone="no"?><?xml-stylesheet type="text/xsl" href="xccdf2xhtml-1.0.xsl" ?>
<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1" xmlns:cdfp="http://www.cisecurity.org/xccdf/platform/0.2.3" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:ecl="http://cisecurity.org/check" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval4="http://oval.mitre.org/XMLSchema/oval" xmlns:xccdf10="http://checklists.nist.gov/xccdf/1.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="cis_vmware_esx_3.5_benchmark" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 ../misc/xsd/xccdf-1.1.4.xsd http://cisecurity.org/check ../misc/xsd/ecl.xsd">
    <xccdf:status date="2007-04-26">accepted</xccdf:status>
    <xccdf:title>CIS VMware ESX 3.5 Benchmark</xccdf:title>
    <xccdf:description>This document, Security Configuration Benchmark for VMware ESX 3.5, provides prescriptive guidance for establishing a secure configuration posture for VMware ESX 3.5 running on hardware compliant with the vendor compatibility guide http://www.vmware.com/resources/compatibility/search.php?action=base&amp;deviceCategory=server.  This guide was tested against VMware ESX 3.5 as installed by a vendor evaluation ISO containing Update 3, build number 153875 downloaded from http://www.vmware.com.</xccdf:description>
    <xccdf:notice id="terms-of-use" xml:lang="en">
        BACKGROUND.
        
        The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.  Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.  The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.  Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.  The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
        
        NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
        
        CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of  the Products or the Recommendations.  CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.  
        
        USER AGREEMENTS.
        
        By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
        
        1.	No network, system, device, hardware, software, or component can be made fully secure;
        2.	We are using the Products and the Recommendations solely at our own risk;
        3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
        4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
        5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
        6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
        
        GRANT OF LIMITED RIGHTS.
        
        CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
        
        1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
        2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
        
        RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
        
        The Products are protected by copyright and other intellectual property laws and by international treaties.  We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.  CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
        Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.  We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
        We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.  We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use. 
        
        SPECIAL RULES.
        
        CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.  Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
        CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.  Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
        CHOICE OF LAW; JURISDICTION; VENUE.
        
        We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.  If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
        
        BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.      
    </xccdf:notice>
    <xccdf:version>1.2.0.3</xccdf:version>
    <xccdf:Profile id="ESX_3_5-level-1-profile">
        <xccdf:title>Level 1 Profile</xccdf:title>
        <xccdf:description>
            <xhtml:p>This profile contains all Level 1 configuration items for ESX server 3.5 Benchmark 1.2.0</xhtml:p>
        </xccdf:description>
        <xccdf:select idref="Segregate-Management-and-Virtual-Machine-Networks" selected="true"/>
        <xccdf:select idref="Protect-Against-File-Systems-Filling-Up" selected="true"/>
        <xccdf:select idref="Keep-System-Patched" selected="true"/>
        <xccdf:select idref="BIOS-Configuration" selected="true"/>
        <xccdf:select idref="Boot-Services" selected="true"/>
        <xccdf:select idref="Configuring-NTP" selected="true"/>
        <xccdf:select idref="Configuring-SSH" selected="true"/>
        <xccdf:select idref="SUDO-Configuration" selected="true"/>
        <xccdf:select idref="Password-History" selected="true"/>
        <xccdf:select idref="Password-Complexity" selected="true"/>
        <xccdf:select idref="Failed-Login-Attempts" selected="true"/>
        <xccdf:select idref="Maximum-Password-Age" selected="true"/>
        <xccdf:select idref="Minnimum-Password-Age" selected="true"/>
        <xccdf:select idref="Minnimum-Password-Length" selected="true"/>
        <xccdf:select idref="Log-Compression-and-Size" selected="true"/>
        <xccdf:select idref="Review-Logs" selected="true"/>
        <xccdf:select idref="Syslog-IP-Address-and-Port-Configuration" selected="true"/>
        <xccdf:select idref="MAC-Changes-and-Forged-Transmits-and-Promiscuous-Mode" selected="true"/>
        <xccdf:select idref="Default-Firewall-Services" selected="true"/>
        <xccdf:select idref="Chap-Authentication" selected="true"/>
        <xccdf:select idref="Warning-Banner-Existance" selected="true"/>
        <xccdf:select idref="ESX-1-8-1-Disable-Guest-Device-Connection" selected="true"/>
        <xccdf:select idref="ESX-1-8-2-Disable-Guest-SetInfo-Messages" selected="true"/>
        <xccdf:select idref="ESX-1-8-3-Disable-Guest-Copy-and-Paste" selected="true"/>
        <xccdf:select idref="ESX-1-8-4-Log-File-Size-and-Rotation" selected="true"/>
        <xccdf:select idref="Exclude-Group-and-Other-Write-Ability-on-vmx-Files" selected="true"/>
        <xccdf:select idref="Exclude-Group-and-Other-Write-Ability-on-vmdk-Files" selected="true"/>
        <xccdf:select idref="Ensure-root-is-User-and-Group-Owner-of-vmx-Configuration-Files" selected="true"/>
        <xccdf:select idref="Ensure-root-is-User-and-Group-Owner-of-vmdk-Virtual-Disk-Files" selected="true"/>      
        
    </xccdf:Profile>
    <xccdf:Value id="NTP.primary" interactive="true" interfaceHint="text" type="string">
        <xccdf:title>Primary NTP IP Address</xccdf:title>
        <xccdf:question>What is the IPV4 address of your primary NTP server?</xccdf:question>
        <xccdf:value/>
        <xccdf:default>0.0.0.0</xccdf:default>
    </xccdf:Value>
    <xccdf:Value id="NTP.secondary" interactive="true" interfaceHint="text" type="string">
        <xccdf:title>Secondary NTP IP Address</xccdf:title>
        <xccdf:question>What is the IPV4 address of your secondary NTP server?</xccdf:question>
        <xccdf:value/>
        <xccdf:default>0.0.0.0</xccdf:default>
    </xccdf:Value>
    <xccdf:Value id="NTP.tertiary" interactive="true" interfaceHint="text" type="string">
        <xccdf:title>Tertiary NTP IP Address</xccdf:title>
        <xccdf:question>What is the IPV4 address of your third NTP server?</xccdf:question>
        <xccdf:value/>
        <xccdf:default>0.0.0.0</xccdf:default>
    </xccdf:Value>
    <xccdf:Value id="remote.logserver" interactive="true" interfaceHint="text" type="string">
        <xccdf:title>Name of the Remote Host that Consolidates Log Files</xccdf:title>
        <xccdf:question>What is the name of the destination host where log files are collected?</xccdf:question>
        <xccdf:value/>
        <xccdf:default>loghost.company.com</xccdf:default>
    </xccdf:Value>
    <xccdf:Group id="Installation-Considerations">
        <xccdf:title>Installation Considerations</xccdf:title>
        <xccdf:description>
            This group holds recommendations for when installing VMWare and how to make it as secure
            as possible right from the start.
        </xccdf:description>            
        <xccdf:Rule id="Segregate-Management-and-Virtual-Machine-Networks" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.1.1 Segregate Management and Virtual Machine Networks</xccdf:title>
            <xccdf:description>The default installation option will combine the Virtual Machine network with
                the virtual infrastructure Service Console management network. This could potentially allow 
                network-based access to the Service Console to a wider population of users than just system administrators,
                possibly allowing access to sensitive configuration traffic. The Service Console management traffic 
                should always be isolated on a separate network.<xhtml:br/>
                The results of the next three checks should be compared to your organization's network configuration
                and policies for appropriate segregation of production, managment, data (i.e. iSCSI), VMotion
                and other networks.<xhtml:br/> 
                <xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="OR">
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command comment="This command will list the PortGroups available on this ESX host.">
                        <ecl:command>vmware-vim-cmd hostsvc/net/info | grep -i 'key = "key-vim.host.PortGroup-' | awk -F"-" '{print $3}' | awk -F"\"" '{print $1}'</ecl:command>     
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command comment="This command will list all guests and their network interfaces and each PortGroup that each interface is associated with, based on the contents of each guest's vmx file.">
                        <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -H ".networkName =" | awk -F"/" '{print $NF}' | awk -F"." '{print $1 "\t\t" $3}'</ecl:command>     
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command comment="This command will list all guests that do not have a network interface.">
                        <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -L ".networkName =" | awk -F"/" '{print $NF}' | awk -F"." '{print $1 "\t\t" $3}'</ecl:command>     
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="Protect-Against-File-Systems-Filling-Up" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.1.2 Protect Against File Systems Filling Up</xccdf:title>
            <xccdf:description>During installation, the following 7 (/, /boot, /tmp, /home, /var, /var/log, /var/core  file 
                system structures should be configured on their own disk partitions with each having a minimum size greater than
                or equal to 5000 1K-blocks.<xhtml:br/> 
                <xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                   <xccdf:check-content>
                       <ecl:shell-command check="none exist" comment="This command will count the number of recommended                             filesystem partitions on this host, out of the 7 that are specified in the benchmark." success="pass">
                             <ecl:command>df | grep -E '(\/$|\/tmp|\/boot|\/home|\/var|\/var\/log|\/var\/core)' | wc -l | awk '$1 !~ /7/'</ecl:command>
                       </ecl:shell-command>
                   </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command comment="This command will list the filesystem partitions that are present                              on this ESX host that are also recommended on the benchmark.">
                            <ecl:command>df | grep -E '(\/$|\/tmp|\/boot|\/home|\/var|\/var\/log|\/var\/core)'</ecl:command>     
                        </ecl:shell-command>
                    </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                   <xccdf:check-content>
                       <ecl:shell-command check="none exist" comment="This command will list the filesystem partition sizes                            that are NOT at least 5000 k in size." success="pass">
                           <ecl:command>df | grep -E '(\/$|\/tmp|\/boot|\/home|\/var|\/var\/log|\/var\/core)' | awk '$2 <![CDATA[<]]> 5000' </ecl:command>
                       </ecl:shell-command>
                   </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Preparation-Packages-Patching">
        <xccdf:title>Preparation, Packages, and Patching</xccdf:title>
        <xccdf:description>This group defines recommendations for perparing VMWare and handling patching of the VMWare software.</xccdf:description>        
        <xccdf:Rule id="Keep-System-Patched" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.2.1 Keep System Patched</xccdf:title>
            <xccdf:description>Applying vendor supported patches minimizes vulnerabilities, utilizes the vendor’s security research and 
                their product knowledge regarding compatibility of changes with other components of the console operating system.
                <xhtml:br/>
                Review the installed patch list below and match those to the vendor's recommended patches relevant to your environment.
                <xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command comment="This command will list the VMware version of this ESX host.">
                            <ecl:command>vmware -v</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command comment="This command will list the patches applied to this ESX host.">
                            <ecl:command>esxupdate -a query</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command comment="This command will list recent (last 20) patch activity on this ESX host.">
                            <ecl:command>tail -n 20 /var/log/vmware/esxupdate.log</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
             </xccdf:complex-check>  
        </xccdf:Rule>
        <xccdf:Rule id="BIOS-Configuration" role="unscored" selected="false" weight="0.0">
            <xccdf:title>ESX 1.2.2 BIOS Configuration</xccdf:title>
            <xccdf:description>Providing access control to the BIOS and limiting boot sources can reduce the risk that the physical server’s BIOS can be insecurely configured
                or that an organization’s storage or network resources may be accessed by a non-conforming operating system.<xhtml:br/>
                Manually review the ESX host's BIOS settings as an administrator boots the machine.<xhtml:br/>
                </xccdf:description>
        </xccdf:Rule>
        <xccdf:Rule id="Boot-Services" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.2.3 Only Start Recommended Boot Services</xccdf:title>
            <xccdf:description>Services enabled at ESX host startup should be limited to the vendor’s default services
                and any authorized exceptions.<xhtml:br/>Any additional services running on an ESX host beyond, added 
                or omitted, to the vendor’s default configuration, could diminish host performance or introduce an attack vector.
                The assessor should also run the command chkconfig --list | grep on  and review all services schedule to start
                at boot, particularly any services not on the benchmark recommended list of 25 for approval testing and agreement 
                with the organization's change control documentation<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="This command will list services that are on the list recommended in the benchmark, but are NOT STARTED at boot." success="pass">
                            <ecl:command>good=(microcode_ctl vmkstart vmware vmware-aam vmware-late vmware-webAccess vmware-vmkauthd megaraid_sas_ioctl mgmt-vmware vmware-autostart vmware-vpxa mptctlnode firewall network syslog irqbalance ipmi random sshd xinetd ntpd crond local pegasus wsman); for b in ${good[@]}; do  chkconfig --list | grep on | awk '{print $1}' | grep $b; if [ $? -ne 0 ] ; then  echo "Fail: $b is not enabled" ; fi;  done | grep "Fail"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="This command will list services that start at boot, but are NOT RECOMMENDED in the benchmark." success="pass">
                            <ecl:command> good=(microcode_ctl vmkstart vmware vmware-aam vmware-late vmware-webAccess vmware-vmkauthd megaraid_sas_ioctl mgmt-vmware vmware-autostart vmware-vpxa mptctlnode firewall network syslog irqbalance ipmi random sshd xinetd ntpd crond local pegasus wsman); actualservices=$(chkconfig --list | grep on | awk '{print $1}'); flag="fail"; for b in ${actualservices[@]}; do for c in ${good[@]}; do if [ $b == $c ]; then  flag="pass"; fi; done; if [ $flag == "fail" ]; then echo "Fail: the service $b is NOT on the recommended list"; fi; flag="fail"; done</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>   
        <xccdf:Rule id="Configuring-NTP" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.2.4 Enable and Configure NTP for Your Environment</xccdf:title>
            <xccdf:description>Keeping your systems synchronized to a local or remote NTP server ensures log entries 
                are date and time stamped consistently across systems allowing for accurate event correlation. This also
                ensures proper functioning on the system given its interaction to other systems (e.g. vCenter). 
                The default installation of an ESX host does not configure NTP, since the location of your NTP server
                varies by organization.<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine if the NTP service is running." success="pass">
                            <ecl:command>ps aux | grep ntp | grep -v "grep"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine if the NTP service is allowed outbound through the firewall." success="pass">
                            <ecl:command>esxcfg-firewall \-q ntpClient</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine if the 127.0.0.1 address is set to 'restrict' in /etc/ntp.conf." success="pass">
                            <ecl:command>grep ^restrict[[:space:]]127\.0\.0\.1 /etc/ntp.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine if kod nomodify notrap noquery nopeer are set to 'restrict' in /etc/ntp.conf." success="pass">
                            <ecl:command>grep ^restrict[[:space:]]kod[[:space:]]nomodify[[:space:]]notrap[[:space:]]noquery[[:space:]]nopeer /etc/ntp.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine the NTP configuration file and compare the primary NTP server IP address to the address input by the assessor." success="pass">
                            <ecl:command>grep ^server[[:space:]]${Value:NTP.primary} /etc/ntp.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="The Secondary NTP server IP is now evaluated against the organization's address input by the assessor.." success="pass">
                            <ecl:command>grep ^server[[:space:]]${Value:NTP.secondary} /etc/ntp.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="The Tertiary NTP server IP is now evaluated against the address input by the assessor." success="pass">
                            <ecl:command>grep ^server[[:space:]]${Value:NTP.tertiary} /etc/ntp.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine the NTP step-tickers configuration file and compare the primary NTP server IP address to the address input by the assessor." success="pass">
                            <ecl:command>grep ^server[[:space:]]${Value:NTP.primary} /etc/ntp/step-tickers</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="The Secondary NTP server IP in step-tickers is now evaluated against the organization's address input by the assessor." success="pass">
                            <ecl:command>grep ^server[[:space:]]${Value:NTP.secondary} /etc/ntp/step-tickers</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="The Tertiary NTP server IP in step-tickers is now evaluated against the address input by the assessor." success="pass">
                            <ecl:command>grep ^server[[:space:]]${Value:NTP.tertiary} /etc/ntp/step-tickers</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>   
    </xccdf:Group>
    <xccdf:Group id="System-Access-Authentication-Authorization-and-User-Accounts">
            <xccdf:title>System Access, Authentication, Authorization, and-User Accounts</xccdf:title>
            <xccdf:description>
                <xhtml:div>Access Control is a huge security issue that relies on organization policies and procedures to manage. The actions
                    describes in this section are just a few measures that can be taken on a system level to control access to services. It is
                    strongly advised that organizations have a mechanism in place to authorized access privileges and to revoke that
                    authorization. </xhtml:div>
            </xccdf:description>                
        <xccdf:Rule id="Configuring-SSH" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.3.1 Configure SSH Access</xccdf:title>
            <xccdf:description>Remote shell access to the console operating system should protect both the authentication credentials of the 
                administrator and the content communicated between the ESX host and the administrator using secure shell (SSH).<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine if the SSH service is running." success="pass">
                            <ecl:command>ps aux | grep /usr/sbin/sshd | grep -v grep</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine if the SSH Server service is allowed through the firewall." success="pass">
                            <ecl:command>esxcfg-firewall -q sshServer | grep enabled</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine if the SSH Client service is disabled." success="pass">
                            <ecl:command>esxcfg-firewall -q sshClient | grep blocked</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine sshd_config for the Protocol 2 setting." success="pass">
                            <ecl:command>grep -v ^# /etc/ssh/sshd_config | grep "Protocol 2"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine sshd_config for the IgnoreRhosts yes setting." success="pass">
                            <ecl:command>grep -v ^# /etc/ssh/sshd_config | grep "IgnoreRhosts yes"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" comment="This command will examine sshd_config for the StrictModes yes setting." success="pass">
                        <ecl:command>grep -v ^# /etc/ssh/sshd_config | grep "StrictModes yes"</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine sshd_config for the RhostsAuthentication no setting." success="pass">
                            <ecl:command>grep -v ^# /etc/ssh/sshd_config | grep "RhostsAuthentication no"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine sshd_config for the PermitRootLogin no setting." success="pass">
                            <ecl:command>grep -v ^# /etc/ssh/sshd_config | grep "PermitRootLogin no"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                         <ecl:shell-command check="all" comment="This command will examine sshd_config for the PermitEmptyPasswords no setting." success="pass">
                              <ecl:command>grep -v ^# /etc/ssh/sshd_config | grep "PermitEmptyPasswords no"</ecl:command>
                         </ecl:shell-command>
                     </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine sshd_config for an active Banner setting (if the banner exists, the file contents need to be examined off-line)." success="pass">
                            <ecl:command>grep -v ^# /etc/ssh/sshd_config | grep "Banner"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine sshd_config for a Ciphers setting to aes 128 or 256." success="pass">
                            <ecl:command>grep -v ^# /etc/ssh/sshd_config | grep "Ciphers aes256-cbc,aes128-cbc"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <!-- switching the tests to ssh_config, instead of sshd_config which was tested above-->
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine ssh_config (not sshd_config, that test is above) for the Protocol 2 setting." success="pass">
                            <ecl:command>grep -v ^# /etc/ssh/ssh_config | grep "Protocol 2"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine ssh_config (not sshd_config, that test is above) for the Ciphers setting to aes 128 or 256." success="pass">
                            <ecl:command>grep -v ^# /etc/ssh/ssh_config | grep "Ciphers aes256-cbc,aes128-cbc"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="This command will examine ssh_config and sshd_config file ownership by the user root, and list either file if not owned by the user root." success="pass">
                            <ecl:command>ls -l /etc/ssh/ssh*_config | awk '$3 !~ /root/'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="This command will examine ssh_config and sshd_config file ownership by the group sys, and list either file if not owned by the group sys." success="pass">
                            <ecl:command>ls -l /etc/ssh/ssh*_config | awk '$4 !~ /sys/'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will examine ssh_config and sshd_config files write permission is available only to the file owner, and list either file if writeable by the group or other. " success="pass">
                            <ecl:command>find /etc/ssh/ssh*_config -perm +u=w ! -perm +g=w,o=w</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="SUDO-Configuration" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.3.2 Implement SUDO</xccdf:title>
            <xccdf:description>SUDO enables associating users with powerful administrative commands and 
                allowing root privileges. Further, SUDO provides logging of those users who access these 
                advanced capabilities.  SUDO is not configured on the default ESX installation. This element
                of the benchmark was categorized as not scorable because the accounts and groups to be 
                included vary by organization. This check lists the current contents of the /etc/sudoers
                file for off-line analysis by the assessor.<xhtml:br/>
            </xccdf:description>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                    <ecl:shell-command comment="List the contents of /etc/sudoers for off-line analysis.">
                        <ecl:command>cat /etc/sudoers</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="Password-History" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.3.3 Require Password History</xccdf:title>
            <xccdf:description>Retain a history of previous passwords used and configure the authentication
                controls to validate new passwords against greater than or equal to 10 recently used credentials.<xhtml:br/>
                Maintaining a history file containing previously used credentials for each user, 
                limits continual reuse of recent or favorite passwords. Combined with minimum and maximum password life,
                this control helps maintain password effectiveness.<xhtml:br/>
            </xccdf:description>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" comment="The value for password reuse should be greater than or equal to 10." sucess="pass">
                        <ecl:command>grep 'password.*sufficient.*pam_unix.so.*remember=' /etc/pam.d/system-auth | awk -F"remember=" '$2 &gt; 10'</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="Password-Complexity" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.3.4 Require Password Complexity</xccdf:title>
            <xccdf:description>The user should create a password that consists of a mix of character classes
                from the four choices; upper case, lower case, numeric, or special to reduce the use of 
                common words as passwords and increase the difficulty of an unauthorized user guessing their credential.<xhtml:br/>
                Note: The default installation of ESX uses the pam_cracklib.so plug-in for both password complexity 
                (default is not configured) and number of failed login attempts before account lockout (default setting is 3.)
                This plug-in does not check the root account for complexity. You should use the pam_passwdqc.so library
                to handle password complexity for all accounts (including the root account).<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                         <ecl:shell-command check="all" comment="When using 3 character classes, the minimum total password length should be 12 or greater." sucess="pass">
                             <ecl:command> grep -i '^password[[:space:]]\+required[[:space:]]\+/lib/security/\$ISA/pam_passwdqc.so' /etc/pam.d/system-auth | awk '{print $4}' | awk -F"," '$4 &gt; 11'| awk -F"," '$4 !~ /disabled/'</ecl:command>
                         </ecl:shell-command>
                     </xccdf:check-content>
                </xccdf:check>     
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="When using 4 character classes, the minimum total password length should be 8 or greater." sucess="pass">
                            <ecl:command> grep -i '^password[[:space:]]\+required[[:space:]]\+/lib/security/\$ISA/pam_passwdqc.so' /etc/pam.d/system-auth | awk '{print $4}' | awk -F"," '$5 &gt; 7'| awk -F"," '$5 !~ /disabled/'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>     
             </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="Failed-Login-Attempts" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.3.5 Set Failed Login Attempts to 3</xccdf:title>
            <xccdf:description>For user accounts, setting the failed attempt number at a low level
                discourages repetitive tries, which may be automated, to guess a user’s password.</xccdf:description>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" comment="Check /etc/pam.d/system-auth for the use of cracklib, if yes, and the number after 'retry=' is 3 that is a pass, if cracklib is not in use check for the term 'deny=' and evaluate the number after that term to be 3 also for a pass." sucess="pass">
                         <ecl:command> grep -q crack /etc/pam.d/system-auth; if [ $? -eq 0 ]; then grep crack /etc/pam.d/system-auth | awk -F"retry=" '{print $2}' | awk '{print $1}' | awk -F"retry=" '$1 <![CDATA[<]]> 4'; else grep "deny=" /etc/pam.d/system-auth | awk -F"deny=" '{print $2}' | awk '{print $1}' | awk '$1 <![CDATA[<]]> 4'; fi</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="Maximum-Password-Age" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.3.6 Set Password Maximum Life to 90 Days</xccdf:title>
            <xccdf:description>Minimizing the life of a credential reduces the likelihood that the password will become compromised.<xhtml:br/>
                <xhtml:br/>These are recommended starting values. Some regulated industries require more restrictive values - ensure they
                comply with your enterprise security policy.</xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/etc/login.defs text content-->
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="Check /etc/login.defs setting for password maximum life of 90 or less.">
                            <ecl:path>/etc/login.defs</ecl:path>
                            <ecl:line-selection op="pm" value="^PASS_MAX_DAYS\s+(\d+)$">
                                <ecl:regex-group dt="xs:integer" group="1" op="le" value="90"/>
                            </ecl:line-selection>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="Minnimum-Password-Age" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.3.7 Set Password Minimum Life to 7 Days</xccdf:title>
            <xccdf:description>Combined with the history setting (see section 1.3.4), the minimum days
                setting will cause multiple days to transpire before a user can return to a
                favorite password, discouraging password reuse.</xccdf:description>
            <xccdf:check system="http://cisecurity.org/check">
                    <!--/etc/login.defs text content-->
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="Check /etc/login.defs setting for password minimum life of 7 or more.">
                            <ecl:path>/etc/login.defs</ecl:path>
                            <ecl:line-selection op="pm" value="^PASS_MIN_DAYS\s+(\d+)$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="7"/>
                            </ecl:line-selection>
                        </ecl:file-content>
                    </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="Minnimum-Password-Length" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.3.8 Set Password Minimum Length to 8 Characters</xccdf:title>
            <xccdf:description>The longer the total character length of a password, 
                the more difficult it is to guess by unauthorized users.</xccdf:description>        
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/etc/login.defs text content-->
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="Check /etc/login.defs setting for a minimum password character length of 8.">
                            <ecl:path>/etc/login.defs</ecl:path>
                            <ecl:line-selection op="pm" value="^PASS_MIN_LEN\s+(\d+)$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="8"/>
                            </ecl:line-selection>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
         </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Logging">
        <xccdf:title>Logging Configuration</xccdf:title>
        <xccdf:description>
            <xhtml:p>The items in this section cover enabling various different forms of system logging in order to keep track of
                activity on the system.</xhtml:p>
        </xccdf:description>        
        <xccdf:Rule id="Log-Compression-and-Size" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.4.1 Global Log Configuration, and vmkernel, vmksummary and vmkwarning Log Configuration</xccdf:title>
            <xccdf:description>The larger the log file the more events will be captured to help
                research system performance or security issues. Compression will allow more events
                to be captured in the file space provided.xhtml:br/&gt;
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="This command checks to see if overall host log compression is turned off." success="pass">
                            <ecl:command>awk '/\#compress/ {print $1}' /etc/logrotate.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="For the log file vmkernel,  this command checks if 'compress' is present. (with the word option '-w', 'nocompress' will not trigger a match)" success="pass">
                            <ecl:command> grep -v \# /etc/logrotate.d/vmkernel | grep -w compress</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="For the log file vmkernel,  this command checks to see if log size is at least 2096k." success="pass">
                            <ecl:command> grep -v \# /etc/logrotate.d/vmkernel | awk '/size/ {print $2}' | awk -F"k" '$1 &gt; 2095'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="For the log file vmksummary,  this command checks if 'compress' is present. (with the word option '-w', 'nocompress' will not trigger a match)" success="pass">
                            <ecl:command> grep -v \# /etc/logrotate.d/vmksummary | grep -w compress</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="For the log file vmksummary,  this command checks to see if log size is at least 2096k." success="pass">
                            <ecl:command> grep -v \# /etc/logrotate.d/vmksummary | awk '/size/ {print $2}' | awk -F"k" '$1 &gt; 2095'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="For the log file vmkwarning,  this command checks if 'compress' is present. (with the word option '-w', 'nocompress' will not trigger a match)" success="pass">
                            <ecl:command> grep -v \# /etc/logrotate.d/vmkwarning | grep -w compress</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="For the log file vmkwarning,  this command checks to see if log size is at least 2096k." success="pass">
                            <ecl:command> grep -v \# /etc/logrotate.d/vmkwarning | awk '/size/ {print $2}' | awk -F"k" '$1 &gt; 2095'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="Review-Logs" role="unscored" selected="false" weight="0.0">
            <xccdf:title>ESX 1.4.2 Log File Review Procedures</xccdf:title>
            <xccdf:description>Reviewing logs in a timely manner may detect a performance or security issue
                in its early stages, enabling the organization to take countermeasures to reduce the event’s impact.<xhtml:br/>
            </xccdf:description>
        </xccdf:Rule>
        <xccdf:Rule id="Syslog-IP-Address-and-Port-Configuration" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.4.3 Specify Destination IP and Open Firewall for Log File Collection</xccdf:title>
            <xccdf:description>Remote logging is essential in detecting intrusion and monitoring multiple servers simultaneously.
                If an intruder is able to obtain root on a host, they may be able to edit the system logs to remove all traces
                of the attack.  If a copy of the logs is stored off the machine that cannot be accessed with the compromised 
                host’s credentials, those logs can be analyzed for anomalies and used for prosecuting the attacker.<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will check to see if the syslog services is allowed through the firewall.  NOTE: syslog is not one of the predefined services in vCenter and does not show up in the output of the esxcfg-firewall -q command under 'Enabled Services', it is listed in the section 'Opened Ports'. Also, review the output for the correct port if your organization does not use default ports." success="pass">
                            <ecl:command>esxcfg-firewall \-q | grep -B 1 syslog</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will see if the log server name that was entered is in the syslog configuration file.  NOTE: The this only matchs if the log server name is present, the assessor must review the output for completeness of the event types remotely captured according to their organization's policy." success="pass">
                            <ecl:command>grep \@${Value:remote.logserver} /etc/syslog.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>   
    </xccdf:Group>
    <xccdf:Group id="Networking">
        <xccdf:title>Newtworking Configuration</xccdf:title>
        <xccdf:description>
            This group defines recommendations for security the network stack for VMWare.
        </xccdf:description>        
        <xccdf:Rule id="MAC-Changes-and-Forged-Transmits-and-Promiscuous-Mode" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.5.1 MAC Spoofing and Forged Transmits and Promiscuous Mode</xccdf:title>
            <xccdf:description>The recommended settings provide the ability to prevent guests from changing virtual MAC addresses, and to drop incoming 
                and outgoing guest network packets if a guest MAC address in a packet is different from the MAC address specified in the
                guest configuration file (vmx), and stop the ability to read packets not destined for a guest.<xhtml:br/>
            </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="This command tests for the value 'true' in the three configuration settins, if any are found all vSwitch and PortGroup settings (both compliant and non-compliant) are listed." success="pass">
                            <ecl:command>vmware-vim-cmd hostsvc/net/info | grep -Eq '(allowPromiscuous = true|macChanges = true|forgedTransmit = true)'; if [ $? = 0 ]; then  vmware-vim-cmd hostsvc/net/info | grep -E '(name|allowPromiscuous|macChanges|forgedTransmit|PortGroup-)'; fi</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="Default-Firewall-Services" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.5.2 Default Firewall Services and Configuration File Changes</xccdf:title>
            <xccdf:description>Configure the built-in firewall to ensure only authorized ports and related
                network traffic sources are allowed to and from the ESX host. If unauthorized ports are opened
                to the ESX host by a firewall change, traffic containing disruptive or malicious payloads may 
                negatively impact the host’s performance or security. The services controlled by vCenter are listed
                in the section 'Enabled services' of the output of the esxcfg-firewall -q command. Six default 
                services are listed, (CIMSLP, VCB, CIMHttpsServer, vpxHeartbeats, LicenseClient, sshServer) plus ntpClient
                as recommended in section  1.2.4 are initially configured.  
                <xhtml:br/>  Other services (such as syslog see section 1.4.3)
                will be shown in the output under 'Opened ports' section of escfg-firewall -q command output.<xhtml:br/>
                NOTE: some of the failures below may be the result of allowed exceptions applicable to your organization,
                the output of the esxcfg-firewall -q command will list all services open, compare that list to allowed 
                exception documentation in your change mangement process.<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="This command will check to see if there are any vCenter controlled services, other than the 6 default plus NTP as recomended, are allowed through the firewall." success="pass">
                            <ecl:command> esxcfg-firewall -q | grep "Enabled services: CIMSLP ntpClient VCB CIMHttpsServer vpxHeartbeats LicenseClient sshServer"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command comment="This command will see if any services, not controlled by vCenter, are allowed through the firewall.">
                            <ecl:command>OpenportsLine=$(esxcfg-firewall -q | grep -n "Opened ports" | awk -F":" '{print $1}'); TotalLines=$(esxcfg-firewall -q | grep -n . | awk 'END{print $0}' | awk -F":" '{print $1}'); if [ $TotalLines -ne $OpenportsLine ]; then esxcfg-firewall -q | grep -A 10  "Opened ports"; fi</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="This command checks for any changes made to the /etc/sysconfig/iptables.config file (any lines added or existing lines uncommented)." success="pass">
                            <ecl:command>  if [ $(grep -Ev '(^#|^$)' /etc/sysconfig/iptables-config | wc -l) -ne 0 ]; then grep -Ev '(^#|^$)' /etc/sysconfig/iptables-config; fi</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>   
    </xccdf:Group>
    <xccdf:Group id="Storage">
        <xccdf:title>Chap Authentication Must be in Use for iSCSI Devices</xccdf:title> 
        <xccdf:description>Configure connections to iSCSI storage devices to use the CHAP protocol for authentication.</xccdf:description>
        <xccdf:Rule id="Chap-Authentication" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.6.1 Chap Authentication Must be in use for ISCSI Devices</xccdf:title>
            <xccdf:description>Use of the CHAP protocol ensures ESX hosts and storage devices are communicating 
                with known endpoints.<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="If iSCSI Client is allowed throught the firewall, then this command will check to see if CHAP Authentication 'false' is present." success="pass">
                            <ecl:command>esxcfg-firewall -q | grep "Enabled services" | grep swISCSIClient | if [ $? -eq 0 ]; then  vmware-vim-cmd hostsvc/storage/info | grep "chapAuthEnabled = false"; fi</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Also check that CHAP Authentication 'true' is turned on, if the iSCSI services is enabled through the firewall." success="pass">
                            <ecl:command>esxcfg-firewall -q | grep "Enabled services" | grep swISCSIClient | if [ $? -eq 0 ]; then  vmware-vim-cmd hostsvc/storage/info | grep "chapAuthEnabled = true"; fi</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>   
    </xccdf:Group>
    <xccdf:Group id="Warning-Banners">
        <xccdf:title>Warning Banners Should be Displayed at Console and Remote Login</xccdf:title> 
        <xccdf:description>
            <xhtml:p>Presenting some sort of statutory warning message prior to the normal user logon may 
                assist the prosecution of trespassers on the computer system. Changing some of these login 
                banners also has the side effect of hiding OS version information and other detailed system 
                information from attackers attempting to target specific attacks at a system (though there 
                are other mechanisms available for acquiring this information). Guidelines published by 
                the US Department of Defense require that warning messages include at least the name of 
                the organization that owns the system, the fact that the system is subject to monitoring and 
                that such monitoring is in compliance with local statutes, and that use of the system implies 
                consent to such monitoring. The organization's local legal counsel and/or site security 
                administrator should review the content of all messages before any system modifications 
                are made, as these warning messages are inherently site-specific.</xhtml:p>
        </xccdf:description>
        <xccdf:Rule id="Warning-Banner-Existance" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.7.1 Check for the Existance of Warning Banner Files</xccdf:title>
            <xccdf:description>Presenting some sort of statutory warning message prior to the normal user logon
                may assist the prosecution of trespassers on the computer system. Changing some of these login
                banners also has the side effect of hiding OS version information and other detailed system information
                from attackers attempting to target specific attacks at a system (though there are other mechanisms 
                available for acquiring this information). Guidelines published by the US Department of Defense require
                that warning messages include at least the name of the organization that owns the system, the fact that
                the system is subject to monitoring and that such monitoring is in compliance with local statutes, and
                that use of the system implies consent to such monitoring. The organization's local legal counsel and/or
                site security administrator should review the content of all messages before any system modifications are
                made, as these warning messages are inherently site-specific.  NOTE: The checks for this rule will determine
                the existance of a banner file, but can not assess the content of the warning banner file.<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Review this listed contents of the /etc/motd file for agreement with your organization's warning banner composition." success="pass">
                            <ecl:command>cat /etc/motd</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Review this listed contents of the /etc/issue file for agreement with your organization's warning banner composition." success="pass">
                            <ecl:command>cat /etc/issue</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Review this listed contents of the /etc/issue.net file for agreement with your organization's warning banner composition." success="pass">
                            <ecl:command>cat /etc/issue.net</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Review this listed contents of the /usr/lib/vmware/hostd/docroot/index.html  file for agreement with your organization's warning banner composition." success="pass">
                            <ecl:command>cat /usr/lib/vmware/hostd/docroot/index.html | grep -v "^$"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>   
    </xccdf:Group>
    <xccdf:Group id="Guest-Interaction-with-the-Host">
        <xccdf:title>Guest Interaction with the Host</xccdf:title>
        <xccdf:description>Guest control of hardware devices could lead to resource conflicts and possible poor 
            performance, or access to unauthorized devices and data stored there.</xccdf:description>
        <xccdf:Rule id="ESX-1-8-1-Disable-Guest-Device-Connection" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.8.1 Ensure Guest Device Connectability is Disabled</xccdf:title>
            <xccdf:description>
                <xhtml:p>The contents of the .vmx file for each guest should contain the following configuration
                    setting	to disable the ability of the guest to control devices (i.e. CD, floppy, ...)
                    <xhtml:code>isolation.device.connectable.disable = "true"</xhtml:code></xhtml:p>
                <xhtml:br/>
            </xccdf:description>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist" comment="Any guests listed below have not disabled the device connection capability." success="pass">
                        <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -L 'isolation.device.connectable.disable = "true"'</ecl:command>     
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="ESX-1-8-2-Disable-Guest-SetInfo-Messages" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.8.2 Disable Guest SetInfo Messages</xccdf:title>
            <xccdf:description>
                <xhtml:p>SetInfo messages have an unlimited length. A malformed message, or messages,
                    of extreme length could overwhelm the host creating a denial of service situation.</xhtml:p>
                <xhtml:br/>
            </xccdf:description>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist" comment="Any guests listed below have not disabled setinfo messages." success="pass">
                        <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -L 'isolation.tools.setinfo.disable = "true"'</ecl:command>     
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="ESX-1-8-3-Disable-Guest-Copy-and-Paste" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.8.3 Disable Guest Copy and Paste</xccdf:title>
            <xccdf:description>
                <xhtml:p>The cut and paste capability provides the ability to place executable files on a 
                    destination without logging to trace actions to users.</xhtml:p> <xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Any guests listed below have not disabled 'copy'." success="pass">
                            <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -L 'isolation.tools.copy.disable = "true"'</ecl:command>     
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Any guests listed below have not disabled 'paste'." success="pass">
                            <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -L 'isolation.tools.paste.disable = "true"'</ecl:command>     
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Any guests listed below have not disabled 'GUIoptions'." success="pass">
                            <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -L 'isolation.tools.setGUIOptions.enable = "false"'</ecl:command>     
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="ESX-1-8-4-Log-File-Size-and-Rotation" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.8.4 Configure Guest Log File Size and Rotation</xccdf:title>
            <xccdf:description>
                <xhtml:p>Set the maximum size of each log file and number of log files to retain in each
                    guest directory under /vmfs/volumes/yourstoragedevice/ to: a.) Rotate the current log file when the size is less than or equal to 10000000 Bytes.
                    b.) Retain less than or equal to 30 historical log files.
                    Reducing the chance of log files filling up reduces the chance of denial of service attacks
                    or reduced performance due to flawed processes creating run-away logging.
                </xhtml:p> <xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Any guests listed below have no setting for log file size and fail this requirement." success="pass">
                            <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -L 'log.rotateSize'</ecl:command>     
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Any guests listed below have a log size specified, but the size value is greater than 10000000." success="pass">
                            <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep 'log.rotateSize' | awk -F"\"" '$2 &gt; 10000000'</ecl:command>     
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Any guests listed below have no setting for log file rotation and fail this requirement." success="pass">
                            <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep -L 'log.keepOld'</ecl:command>     
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Any guests listed below have a log rotation specified, but the rotation value is greater than 30." success="pass">
                            <ecl:command>find /vmfs/volumes/ -name *.vmx | xargs grep 'log.keepOld' | awk -F"\"" '$2 &gt; 30'</ecl:command>     
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="File-and-Directory-Permissions-and-Ownership">
        <xccdf:title>File-and-Directory-Permissions-and-Ownership</xccdf:title>
        <xccdf:description>
            Disabling file permissions for configuration files helps prevent accidental or malicious 
            changes to the system. 
        </xccdf:description>        
        <xccdf:Rule id="Exclude-Group-and-Other-Write-Ability-on-vmx-Files" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.9.1 Exclude Group and Other Write Ability on vmx Files</xccdf:title>
            <xccdf:description>Disabling write file permissions for configuration files helps prevent 
                accidental or malicious changes to the system.<xhtml:br/>
            </xccdf:description>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist" comment="If any vmx files in the /vmfs/volumes/ path (recursive) have either group or other (world) write priviledges, the noncompliant guests will be listed below." success="pass">
                        <ecl:command>find /vmfs/volumes/ -name *.vmx -perm +g=w,o=w</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>   
        <xccdf:Rule id="Exclude-Group-and-Other-Write-Ability-on-vmdk-Files" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.9.2 Exclude Group and Other Write Ability on vmdk Files</xccdf:title>
            <xccdf:description>Disabling write file permissions for configuration files helps prevent 
                accidental or malicious changes to the system.<xhtml:br/>
            </xccdf:description>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist" comment="If any vmdk files in the /vmfs/volumes/ path (recursive) have either group or other (world) write priviledges, the noncompliant guests will be listed below." success="pass">
                        <ecl:command>find /vmfs/volumes/ -name *.vmdk -perm +g=w,o=w</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>   
        <xccdf:Rule id="Ensure-root-is-User-and-Group-Owner-of-vmx-Configuration-Files" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.9.3 Ensure root is the user and group owners of vmx configuration files</xccdf:title>
            <xccdf:description>Restricting file ownership for configuration files helps prevent accidental
                or malicious changes to the system.<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND"> 
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="List any vmx files where 'root' is not the owning user." success="pass">
                            <ecl:command> find /vmfs/volumes/ -name *.vmx ! -user root</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="List any vmx files where 'root' is not the owning group." success="pass">
                            <ecl:command> find /vmfs/volumes/ -name *.vmx ! -group root</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>    
        </xccdf:Rule>   
        <xccdf:Rule id="Ensure-root-is-User-and-Group-Owner-of-vmdk-Virtual-Disk-Files" role="full" selected="false" weight="1.0">
            <xccdf:title>ESX 1.9.4 Ensure root is the user and group owners of vmdk virtual disk files</xccdf:title>
            <xccdf:description>Restricting file ownership for virtual disk files helps prevent accidental
                or malicious changes to the system.<xhtml:br/>
            </xccdf:description>
            <xccdf:complex-check operator="AND"> 
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="List vmdk files where 'root' is not the owning user." success="pass">
                            <ecl:command> find /vmfs/volumes/ -name *.vmdk ! -user root</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="List vmdk files where 'root' is not the owning group." success="pass">
                            <ecl:command> find /vmfs/volumes/ -name *.vmdk ! -group root</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>    
        </xccdf:Rule>   
    </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>AuVWCMA2AI9WOT6GGb/Ehc0pJ9I=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
vXIfqE562vfEU3aUiy46eAgk5pWAPmq7izLaXup6NDiBJdCUW6sDC+5SBDFagOP+s58sd1avrS8e
lgKEx8LlWRum1eJS2sW3POpweXnegKSJzRAE96vfm/ikcG5sCUmvE2al4kFLRsQOnUvIj+xO50J2
aWP+wH46UvWA6IUJsu0pzCQ2+XGxZTuMedQ0FdawMLldSDdbG+ZnQpmfW63cJabRq4ExUBJIzT3Z
o7hAzwWmdH3T3mu2Gh3O7i3murJ6z8jyzJZ9ici49ikUARe2Gkv6rlRt4DVy5Ix85EBZnVEMC5YI
0YLsK/wgx30Lo0ntIMOmTPOFVMQsHdKTNoEFCg==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFRzCCBC+gAwIBAgIHTwpN/4tOfDANBgkqhkiG9w0BAQsFADCBtDELMAkGA1UEBhMCVVMxEDAO
BgNVBAgTB0FyaXpvbmExEzARBgNVBAcTClNjb3R0c2RhbGUxGjAYBgNVBAoTEUdvRGFkZHkuY29t
LCBJbmMuMS0wKwYDVQQLEyRodHRwOi8vY2VydHMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8xMzAx
BgNVBAMTKkdvIERhZGR5IFNlY3VyZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkgLSBHMjAeFw0xNDA5
MTgxNDM0MjFaFw0xNzEwMjAxODU3NDRaMIGTMQswCQYDVQQGEwJVUzERMA8GA1UECBMITmV3IFlv
cmsxFzAVBgNVBAcTDkVhc3QgR3JlZW5idXNoMSswKQYDVQQKEyJDZW50ZXIgZm9yIEludGVybmV0
IFNlY3VyaXR5LCBJbmMuMSswKQYDVQQDEyJDZW50ZXIgZm9yIEludGVybmV0IFNlY3VyaXR5LCBJ
bmMuMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0MGnj6yX2QHklGadAfTBxssvP+2f
YegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzNgOhQx3HcclRwQB4xj/14hOoZSeQ3
haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WYFpSRjZ/Z7m5QKii0feJPxbf+wrZ+
UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKcUY2d3WZ4Zk+zawFcRUYslVIrOhMb
0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7enWCRfZrRWAlDHFaouLdtU/OmXc+
Um7cLwz8VQIDAQABo4IBezCCAXcwDAYDVR0TAQH/BAIwADATBgNVHSUEDDAKBggrBgEFBQcDAzAO
BgNVHQ8BAf8EBAMCB4AwNQYDVR0fBC4wLDAqoCigJoYkaHR0cDovL2NybC5nb2RhZGR5LmNvbS9n
ZGlnMnM1LTAuY3JsMFMGA1UdIARMMEowSAYLYIZIAYb9bQEHFwIwOTA3BggrBgEFBQcCARYraHR0
cDovL2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5LzB2BggrBgEFBQcBAQRqMGgw
JAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmdvZGFkZHkuY29tLzBABggrBgEFBQcwAoY0aHR0cDov
L2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5L2dkaWcyLmNydDAfBgNVHSMEGDAW
gBRAwr0njsw0gzCiM9f7bLPwtCyAzjAdBgNVHQ4EFgQU+3zn+CEg6a2xPqlBXvn64hUyoB4wDQYJ
KoZIhvcNAQELBQADggEBAEh76h1GtJ0pj04in+RUymB7fqPh6HFILkOLlTPnveyXCoHYT2M46DET
EA/NKYkoF2KA3QiZ1b+PMViuTYG2pDs71eFVPADuBCGf9IFufCDY9mPvjQiFDlLNMknXxACD8TjC
hqz+uZT2uLPw/YxkJIsCxrTQJ//ga/fHfZDrKgQfbVzxjD/4WKDe8HktjKcn+NWGPJNMgmO+IHrK
if6TB1xTo32W9QzwoXvBdLnziAUGZZghEulq6h3RCMzKPzpx5JiLlOz6JzqXHvrua+yUbr4A29Vy
vkwWgJWjyvJd2uq9MQ9l49kkrD84m41PSwpaHO99nEHRgRykopxIt8AHsIQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>