<?xml version="1.0" encoding="UTF-8" standalone="no"?><xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1" xmlns="http://checklists.nist.gov/xccdf/1.1" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:ecl="http://cisecurity.org/check" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.3.0_CIS_Apple_OSX_10.9_Benchmark" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 ../misc/xsd/xccdf-1.1.xsd http://cisecurity.org/check ../misc/xsd/ecl.xsd">
   <xccdf:status date="2016-11-04">interim</xccdf:status>
   <xccdf:title xml:lang="en">CIS Apple OSX 10.9 Benchmark</xccdf:title>
   <xccdf:description xml:lang="en">
      <xhtml:p>This document, CIS Apple OSX 10.9 Benchmark, provides prescriptive guidance for establishing a secure configuration posture for Apple OSX 10.9. This guide was tested against Apple OSX 10.9. To obtain the latest version of this guide, please visit <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>. If you have questions, comments, or have identified ways to improve this guide, please write us at <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>.</xhtml:p>
   </xccdf:description>
   <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
   <!--<xccdf:platform idref="cpe:2.3:o:apple:osx:10.9.*:*:*:en:*:*:*:*"/>-->
   <xccdf:version>1.3.0</xccdf:version>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
      <xccdf:title xml:lang="en">Level 1</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile intend to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be practical and prudent;</xhtml:li>
            <xhtml:li>provide a clear security benefit; and</xhtml:li>
            <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple_provided_software_is_current" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update_Checks" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_update_installs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Turn_off_Bluetooth_Discoverable_mode_when_not_pairing_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.3_Show_Bluetooth_status_in_menu_bar" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Restrict_NTP_server_to_loopback_interface" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Verify_Display_Sleep_is_set_to_a_value_larger_than_the_Screen_Saver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.4_Set_a_screen_corner_to_Start_Screen_Saver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.1_Enable_FileVault" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.2_Enable_Gatekeeper" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.3_Enable_Firewall" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.4_Enable_Firewall_Stealth_Mode" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.5_Review_Application_Firewall_Rules" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8.2_Time_Machine_Volumes_Are_Encrypted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_Pair_the_remote_control_infrared_receiver_if_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_Enable_Secure_Keyboard_Entry_in_terminal.app" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Retain_system.log_for_90_or_more_days" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Retain_appfirewall.log_for_90_or_more_days" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Retain_authd.log_for_90_or_more_days" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Enable_security_auditing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Configure_Security_Auditing_Flags" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Retain_install.log_for_365_or_more_days" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_ftp_server_is_not_running" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_nfs_server_is_not_running" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Repair_permissions_regularly_to_ensure_binaries_and_other_System_files_have_appropriate_permissions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_Wide_Applications_for_appropriate_permissions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Check_System_folder_for_world_writable_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Complex_passwords_must_contain_an_Alphabetic_Character" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Complex_passwords_must_contain_a_Numeric_Character" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Complex_passwords_must_contain_a_Symbolic_Character" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Require_an_administrator_password_to_access_system-wide_preferences" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_Disable_ability_to_login_to_another_users_active_and_locked_session" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.12_Create_a_custom_message_for_the_Login_Screen" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.14_Do_not_enter_a_password-related_hint" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Remove_Guest_home_folder" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
      <xccdf:title xml:lang="en">Level 2</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
            <xhtml:li>acts as defense in depth measure</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple_provided_software_is_current" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update_Checks" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_update_installs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Turn_off_Bluetooth_Discoverable_mode_when_not_pairing_devices" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.3_Show_Bluetooth_status_in_menu_bar" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Enable_Set_time_and_date_automatically" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Restrict_NTP_server_to_loopback_interface" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Secure_screen_saver_corners" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Verify_Display_Sleep_is_set_to_a_value_larger_than_the_Screen_Saver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.4_Set_a_screen_corner_to_Start_Screen_Saver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1_Disable_Wake_for_network_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Disable_sleeping_the_computer_when_connected_to_power" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.1_Enable_FileVault" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.2_Enable_Gatekeeper" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.3_Enable_Firewall" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.4_Enable_Firewall_Stealth_Mode" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.5_Review_Application_Firewall_Rules" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.6_Enable_Location_Services" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.7_Monitor_Location_Services_Access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7.1_iCloud_configuration" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7.2_iCloud_keychain" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8.1_Time_Machine_Auto-Backup" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8.2_Time_Machine_Volumes_Are_Encrypted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_Pair_the_remote_control_infrared_receiver_if_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_Enable_Secure_Keyboard_Entry_in_terminal.app" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_Java_6_is_not_the_default_Java_runtime" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.12_Configure_Secure_Empty_Trash" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Retain_system.log_for_90_or_more_days" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Retain_appfirewall.log_for_90_or_more_days" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Retain_authd.log_for_90_or_more_days" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Enable_security_auditing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Configure_Security_Auditing_Flags" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Enable_remote_logging_for_Desktops_on_trusted_networks" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Retain_install.log_for_365_or_more_days" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Disable_Bonjour_advertising_service" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Create_network_specific_locations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_ftp_server_is_not_running" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_nfs_server_is_not_running" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Repair_permissions_regularly_to_ensure_binaries_and_other_System_files_have_appropriate_permissions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_Wide_Applications_for_appropriate_permissions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Check_System_folder_for_world_writable_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Check_Library_folder_for_world_writable_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Complex_passwords_must_contain_an_Alphabetic_Character" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Complex_passwords_must_contain_a_Numeric_Character" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Complex_passwords_must_contain_a_Symbolic_Character" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Automatically_lock_the_login_keychain_for_inactivity" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_login_keychain_is_locked_when_the_computer_sleeps" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_Enable_OCSP_and_CRL_certificate_checking" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Require_an_administrator_password_to_access_system-wide_preferences" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_Disable_ability_to_login_to_another_users_active_and_locked_session" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.12_Create_a_custom_message_for_the_Login_Screen" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.13_Create_a_Login_window_banner" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.14_Do_not_enter_a_password-related_hint" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.15_Disable_Fast_User_Switching" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.16_Secure_individual_keychains_and_items" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.17_Create_specialized_keychains_for_different_purposes" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.18_Install_an_approved_tokend_for_smartcard_authentication_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Remove_Guest_home_folder" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.4_Use_parental_controls_for_systems_that_are_not_centrally_managed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_Wireless_technology_on_OS_X" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_iSight_Camera_Privacy_and_Confidentiality_Concerns" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_Computer_Name_Considerations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_Software_Inventory_Considerations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_Firewall_Consideration" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_App_Store_Automatically_download_apps_purchased_on_other_Macs_Considerations" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_Extensible_Firmware_Interface_EFI_password" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.9_Apple_ID_password_reset" selected="true"/>
   </xccdf:Profile>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Install_Updates_Patches_and_Additional_Security_Software">
      <xccdf:title xml:lang="en">Install Updates, Patches and Additional Security Software</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Install Updates, Patches and Additional Security Software</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple_provided_software_is_current" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Verify all Apple provided software is current</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Software vendors release security patches and software updates for their products when security vulnerabilities are discovered. There is no simple way to complete this action without a network connection to an Apple software repository. Please ensure appropriate access for this control. This check is only for what Apple provides through software update.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>It is important that these updates be applied in a timely manner to prevent unauthorized persons from exploiting the identified vulnerabilities. </xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to ensure the system is configured as prescribed:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Choose Apple () menu &gt; Software Update #x2013; If prompted, enter an admin name and password.</xhtml:li>
                     <xhtml:li>Install all available updates and software patches that are applicable.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternatively:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>In Terminal, run the following:<xhtml:code class="code_block">softwareupdate -l </xhtml:code>
                     </xhtml:li>
                     <xhtml:li>In Terminal, run the following for any packages that show up in step 1:<xhtml:code class="code_block">sudo softwareupdate -i <xhtml:em>packagename</xhtml:em>
                        </xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Missing patches can lead to more exploit opportunities.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure all software updates are applied">
                  <ecl:command>/usr/sbin/softwareupdate -l 2&gt;&amp;1</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="No new software available"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update_Checks" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Enable Auto Update Checks</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Auto Update verifies that your system has the newest security patches and software updates. If "Automatically check for updates" is not selected background updates for new malware definition files from Apple for XProtect and Gatekeeper will not occur.</xhtml:p>
            <xhtml:p>http://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/</xhtml:p>
            <xhtml:p>https://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/ </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
               <xhtml:span>It is important that a system has the newest updates applied so as to prevent unauthorized persons from exploiting identified vulnerabilities. </xhtml:span>
            </xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open a terminal session and enter the following command to enable the auto update feature: <xhtml:code class="code_block">sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -int 1  </xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Without automatic update, updates may not be made in a timely manner and the system will be exposed to additional risk.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure Auto Update is Enabled">
                  <ecl:command>/usr/sbin/softwareupdate --schedule</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="Automatic check is on"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Enable app update installs</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or admin privileges for end users.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open a terminal session and enter the following command to enable the auto update feature: <xhtml:code>sudo defaults write /Library/Preferences/com.apple.storeagent AutoUpdate -int 1</xhtml:code>
                        <xhtml:div>The remediation requires a log out and log in to show in the GUI. Please note that.</xhtml:div>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Unpatched software may be exploited</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure app update installs enabled">
                  <ecl:command>defaults read /Library/Preferences/com.apple.storeagent AutoUpdate</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pn" value="^1$"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_update_installs" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Enable system data files and security update installs</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper, with this setting in place new malware and adware that Apple has added to the list of malware or untrusted software will not execute.<xhtml:span> </xhtml:span>
               <xhtml:span>These updates do not require reboots or end user admin rights.</xhtml:span>
            </xhtml:p>
            <xhtml:p>http://www.thesafemac.com/tag/xprotect/</xhtml:p>
            <xhtml:p>https://support.apple.com/en-us/HT202491</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open a terminal session and enter the following command to enable install system data files and security updates:<xhtml:br/>
                        <xhtml:code class="code_block">sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool true &amp;&amp; sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool true</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Unpatched software may be exploited</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure system data files and security update installs enabled">
                     <ecl:command>defaults read /Library/Preferences/com.apple.SoftwareUpdate | egrep 'ConfigDataInstall'</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="ConfigDataInstall = 1;"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure system data files and security update installs enabled">
                     <ecl:command>defaults read /Library/Preferences/com.apple.SoftwareUpdate | egrep 'CriticalUpdateInstall'</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="CriticalUpdateInstall = 1;"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:complex-check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_System_Preferences">
      <xccdf:title xml:lang="en">System Preferences</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations related to configurable options in the <xhtml:em>System Preferences</xhtml:em> panel.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Bluetooth">
         <xccdf:title xml:lang="en">Bluetooth</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Bluetooth is a short-range, low-power wireless technology commonly integrated into portable computing and communication devices and peripherals. Bluetooth is best used in a secure environment where unauthorized users have no physical access near the Mac. If Bluetooth is used, it should be secured properly (see below).</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Turn off Bluetooth, if no paired devices exist</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Bluetooth devices use a wireless communications system that replaces the cables used by other peripherals to connect to a system. It is by design a peer-to-peer network technology and typically lacks centralized administration and security enforcement infrastructure.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Bluetooth is particularly susceptible to a diverse set of security vulnerabilities involving identity detection, location tracking, denial of service, unintended control and access of data and voice channels, and unauthorized device control and data access.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>In Terminal, run the following commands: <xhtml:code class="code_block">sudo defaults write /Library/Preferences/com.apple.Bluetooth \ <xhtml:br/>ControllerPowerState -int 0<xhtml:br/>
                              <xhtml:span>
                                 <xhtml:br/>sudo killall -HUP blued </xhtml:span>
                           </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>There have been many Bluetooth exploits , while Bluetooth can be hardened it does create a local wireless network that can be attacked to compromise both devices and information.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure Bluetooth is disabled if not paired">
                     <ecl:command>STATE=$(defaults read /Library/Preferences/com.apple.Bluetooth ControllerPowerState); PAIRED=$(system_profiler SPBluetoothDataType | grep "Connectable" | awk '{print $2}'); echo "Enabled=$STATE;Paired=$PAIRED"</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^(Enabled=0|Enabled=1;Paired=Yes)"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Turn_off_Bluetooth_Discoverable_mode_when_not_pairing_devices" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Turn off Bluetooth "Discoverable" mode when not pairing devices</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>When Bluetooth is set to discoverable mode, the Mac sends a signal indicating that it's available to pair with another Bluetooth device. When a device is "discoverable" it broadcasts information about itself and it's location. Starting with OS X 10.9 Discoverable mode is enabled while the Bluetooth System Preference is open and turned off once closed. Systems that have the Bluetooth System Preference open at the time of audit will show as Discoverable.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>When in the discoverable state an unauthorized user could gain access to the system by pairing it with a remote device.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p> Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:p>Starting with OS X (10.9) Bluetooth is only set to Discoverable when the Bluetooth System Preference is selected. To ensure that the computer is not Discoverable do not leave that preference open.</xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The system will need to be made Discoverable in order to easily pair Bluetooth peripherals</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure Bluetooth 'Discoverable' property is set to 'Off'">
                     <ecl:command>system_profiler SPBluetoothDataType | grep "Discoverable:"</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="Off"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.3_Show_Bluetooth_status_in_menu_bar" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Show Bluetooth status in menu bar</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>By showing the Bluetooth status in the menu bar, a small Bluetooth icon is placed in the menu bar. This icon quickly shows the status of Bluetooth, and can allow the user to quickly turn Bluetooth on or off.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>Enabling "Show Bluetooth status in menu bar" is a security awareness method that helps understand the current state of Bluetooth, including whether it is enabled, Discoverable, what paired devices exist and are currently active.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In System Preferences: Bluetooth, turn Show Bluetooth Status In Menu Bar on.</xhtml:p>
                     <xhtml:p>Alternatively run the following in the command line:</xhtml:p>
                     <xhtml:code class="code_block">defaults write com.apple.systemuiserver menuExtras -array-add "/System/Library/CoreServices/Menu Extras/Bluetooth.menu"</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Bluetooth is a useful wireless tool that has been widely exploited when configured improperly. The user should have insight into the Bluetooth status.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure Show Bluetooth status in menu bar set for all users">
                     <ecl:command>for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.systemuiserver; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF menuExtras 2&gt;&amp;1 | grep Bluetooth.menu || echo 'Not Set'; fi; done</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="Not Set$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.2_Date__Time">
         <xccdf:title xml:lang="en">Date &amp; Time</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>This section contains recommendations related to the configurable items under the <xhtml:em>Date &amp; Time</xhtml:em> panel.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Enable_Set_time_and_date_automatically" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Enable "Set time and date automatically"</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Correct date and time settings are required for authentication protocols, f<xhtml:span>ile creation, modification dates and log entries. Apple's automatic time update solution will enable an NTP server that is not controlled by the Application Firewall. Turning on "Set time and date automatically" allows other computers to connect to set their time and allows for exploit attempts against ntpd. It also allows for more accurate network detection and OS fingerprinting.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open<xhtml:em> System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Date &amp; Time</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Set date and time automatically</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:div>Alternatively run the following commands:</xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="code_block">sudo systemsetup -setnetworktimeserver &lt;timeserver&gt;   </xhtml:code>
                        <xhtml:code class="code_block">sudo systemsetup #x2013;setusingnetworktime on</xhtml:code>
                     </xhtml:div>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Note: If your organization has internal time servers, enter them here. Enterprise mobile devices may need to use a mix of internal and external time servers. If multiple servers are required use the Date &amp; Time System Preference with each server separated by a space.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure time and date are set automatically">
                     <ecl:command>systemsetup -getusingnetworktime </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="Network Time: On"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure time set is within appropriate limits</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Correct date and time settings are required for authentication protocols, f<xhtml:span>ile creation, modification dates and log entries. Ensure that time on the computer is within acceptable limits. Truly accurate time is measured within milliseconds, for this audit a drift under four and a half minutes passes the control check. Since Kerberos is one of the important features of OS X integration into Directory systems the guidance here is to warn you before there could be an impact to operations. From the perspective of accurate time this check is not strict, it may be too great for your organization, adjust to a smaller offset value as needed.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features. Audit check is for more than 4 minutes and 30 seconds ahead or behind.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>In Terminal, run the following command:<xhtml:code class="code_block">sudo systemsetup -getnetworktimeserver  </xhtml:code>
                        </xhtml:li>
                        <xhtml:li>Use "Network Time Server:" your.time.server to capture drift</xhtml:li>
                        <xhtml:li>
                           <xhtml:code class="code_block">sudo ntpdate -sv <xhtml:em>your.time.server</xhtml:em>  
                           </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Accurate time is required for many computer functions.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure clock offset is less than 270 seconds">
                     <ecl:command>ntpdate -d $(grep ^server /etc/ntp.conf|sed 's/^server //')|tail -1|sed 's/^.*offset //'</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^-?([0-9]{1,2}|1[0-9]{2}|2[0-6][0-9])(\.[0-9]+)? sec$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Restrict_NTP_server_to_loopback_interface" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Restrict NTP server to loopback interface</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The Apple System Preference setting to "Set date and time automatically" enables both an NTP client that can synchronize the time from known time server(s) and an open listening NTP server that can be used by any other computer that can connect to port 123 on the time syncing computer. This open listening service can allow for both exploits of future NTP vulnerabilities and allow for open ports that can be used for fingerprinting to target exploits. Access to this port should be restricted.</xhtml:p>
               <xhtml:p>Editing the /etc/ntp-restrict.conf file by adding a control on the loopback interface limits external access.</xhtml:p>
               <xhtml:p>Add the following</xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">restrict lo</xhtml:span>
               </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">interface ignore wildcard</xhtml:span>
               </xhtml:p>
               <xhtml:p> </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">interface listen lo</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Mobile workstations on untrusted networks should not have open listening services available to other nodes on the network.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:div class="page">
                        <xhtml:div class="layoutArea">
                           <xhtml:div class="column">
                              <xhtml:p>
                                 <xhtml:span>Perform the following to implement the prescribed state: </xhtml:span>
                              </xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>
                                    <xhtml:p>
                                       <xhtml:span>Run the following command in Terminal: </xhtml:span>
                                    </xhtml:p>
                                    <xhtml:code>
                                       <xhtml:span> sudo vim /etc/ntp-restrict.conf </xhtml:span>
                                    </xhtml:code>
                                 </xhtml:li>
                                 <xhtml:li>
                                    <xhtml:p>
                                       <xhtml:span>Add the following lines to the file</xhtml:span>
                                    </xhtml:p>
                                    <xhtml:code>
                                       <xhtml:span>restrict lo interface ignore wildcard interface listen lo</xhtml:span>
                                    </xhtml:code>
                                 </xhtml:li>
                              </xhtml:ol>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="NTP restricted to loopback interface">
                     <ecl:command>cat /etc/ntp-restrict.conf</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^restrict lo$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.3_Desktop__Screen_Saver">
         <xccdf:title xml:lang="en">Desktop &amp; Screen Saver</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations related to the configurable items under the Desktop &amp; Screen Saver panel.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Set an inactivity interval of 20 minutes or less for the screen saver</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p> A locking screensaver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In OS X the screensaver starts after a value selected in a drop down menu, 10 minutes and 20 minutes are both options and either is acceptable. Any value can be selected through the command line or script but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Setting an inactivity interval for the screensaver prevents unauthorized persons from viewing a system left unattended for an extensive period of time.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Desktop &amp; Screen Saver</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Screen</xhtml:em>
                           <xhtml:em>Saver</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Set <xhtml:em>Start after</xhtml:em> to 20 minutes or less</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>In Terminal, run one of the the following commands:<xhtml:code class="code_block">defaults -currentHost write com.apple.screensaver idleTime -int 600<xhtml:br/>
                              <xhtml:span>defaults -currentHost write com.apple.screensaver idleTime -int 1200  </xhtml:span>
                           </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>There are anomalies if the command line is used make the setting something other than what is available in the GUI Menu. Choose either 10 minutes or 20 minutes,</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If the screensaver is not set users may leave the computer available for an unauthorized person to access information.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure no users have screen saver timeout over 1200 seconds">
                     <ecl:command>UUID=`ioreg -rd1 -c IOPlatformExpertDevice | grep "IOPlatformUUID" | sed -e 's/^.* "\(.*\)"$/\1/'`; for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/ByHost/com.apple.screensaver.$UUID; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF.plist idleTime 2&gt;&amp;1; fi; done</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="\s0*(0|[1-9][0-9]{4,}|[2-9][0-9]{3}|1[3-9][0-9]{2}|12[1-9][0-9]|120[1-9])$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Secure_screen_saver_corners" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Secure screen saver corners</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Setting a hot corner to disable the screen saver poses a potential security risk since an unauthorized person could use this to bypass the login screen and gain access to the system. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences </xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Mission Control</xhtml:em>
                           <xhtml:span class="inline_block"> </xhtml:span>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Hot Corners</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Remove any corners which are set to <xhtml:em>Disable Screen Saver</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure screen save corners do not disable screen saver">
                     <ecl:command>for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.dock; if [ -e $PREF.plist ]; then echo "Checking User:$i; defaults read $PREF | egrep -i '(Checking User|corner)'; fi; done   </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="[bltr]\-corner&quot;\s*=\s*6"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Verify_Display_Sleep_is_set_to_a_value_larger_than_the_Screen_Saver" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Verify Display Sleep is set to a value larger than the Screen Saver</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>If the Screen Saver is used to lock the screen, verify the Display Sleep settings are longer than the Screen Saver setting. If the display goes to sleep before the screen saver activates, the computer will appear to be off, but will be unprotected.</xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Users of the system can easily assume that the computer is protected when the display goes to sleep. The computer should be configured so that the screen is locked whenever the display turns off automatically.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In System Preferences: Energy Saver, drag the slider for "Put the display(s) to sleep..." to a reasonable number, but longer than the screen saver setting. The Mac will display a warning if the number is too short.</xhtml:p>
                     <xhtml:p>Alternatively, use the following command:</xhtml:p>
                     <xhtml:code class="code_block">sudo pmset -c displaysleep 0 </xhtml:code>
                     <xhtml:p>Note: The <xhtml:span class="inline_block">-c</xhtml:span> flag means "wall power." Different settings must be used for other power sources.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If the display sleeps before the screensaver is active the computer may be unlocked and available for an unauthorized user.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.4_Set_a_screen_corner_to_Start_Screen_Saver" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Set a screen corner to Start Screen Saver</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The intent of this control is to resemble control-alt-delete on Windows Systems as a means of quickly locking the screen. If the user of the system is stepping away from the computer the best practice is to lock the screen and setting a hot corner is an appropriate method.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Ensuring the user has a quick method to lock their screen may reduce opportunity for individuals in close physical proximity of the device to see screen contents.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In System Preferences: Desktop &amp; Screen Saver: Screen Saver: Hot Corners, make sure at least one Active Screen Corner is set to Start Screen Saver. Make sure the user knows about this feature.</xhtml:p>
                     <xhtml:p>The screen corners can be set using the defaults command, but the permutations of combinations are many. The plist file to check is <xhtml:span class="inline_block">~/Library/Preferences/com.apple.dock </xhtml:span>and the keys are</xhtml:p>
                     <xhtml:code class="code_block">wvous-bl-corner<xhtml:br/>wvous-br-corner <xhtml:br/>wvous-tl-corner <xhtml:br/>wvous-tr-corner </xhtml:code>
                     <xhtml:p>There are also modifier keys to check and various values for each of these keys. A value of <xhtml:span class="inline_block">5</xhtml:span> means the corner will start the screen saver. The corresponding wvous-xx-modifier key should be set to <xhtml:span class="inline_block">0</xhtml:span>.</xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure a screen save corner enables the screen saver">
                     <ecl:command>for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.dock; if [ -e $PREF.plist ]; then echo -n "Checking User '$i': "; defaults read $PREF | egrep 'corner' | egrep '5;$' || echo "Not set"; fi; done</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="Not set$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.4_Sharing">
         <xccdf:title xml:lang="en">Sharing</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations related to the configurable items under the <xhtml:em>Sharing</xhtml:em> panel.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable Remote Apple Events</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling Remote Apple Events mitigates the risk of an unauthorized program gaining access to the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo systemsetup -setremoteappleevents off </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:span>With remote Apple events turned on, an AppleScript program running on another Mac can interact with the local computer.</xhtml:span>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure remote Apple events are disabled">
                     <ecl:command>systemsetup -getremoteappleevents</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="Remote Apple Events: On"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable Internet Sharing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Internet Sharing uses the open source <xhtml:span class="inline_block">natd </xhtml:span>process to share an internet connection with other computers and devices on a local network. This allows the Mac to function as a router and share the connection to other, possibly unauthorized, devices.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling Internet Sharing reduces the remote attack surface of the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:div class="page">
                        <xhtml:div class="layoutArea">
                           <xhtml:div class="column">
                              <xhtml:p> </xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>Open System Preferences</xhtml:li>
                                 <xhtml:li>Select Sharing</xhtml:li>
                                 <xhtml:li>Uncheck Internet Sharing </xhtml:li>
                              </xhtml:ol>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Internet sharing allows the computer to function as a router and other computers to use it for access. This can expose both the computer itself and the networks it is accessing to unacceptable access from unapproved devices.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure Internet sharing is disabled">
                     <ecl:command>defaults read /Library/Preferences/SystemConfiguration/com.apple.nat</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="Enabled\s*=\s*1"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable Screen Sharing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Screen sharing allows a computer to connect to another computer on a network and display the computer#x2019;s screen. While sharing the computer#x2019;s screen, the user can control what happens on that computer, such as opening documents or applications, opening, moving, or closing windows, and even shutting down the computer.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling screen sharing mitigates the risk of remote connections being made without the user of the console knowing that they are sharing the computer.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Sharing</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Uncheck <xhtml:em>Screen Sharing</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure screen sharing is disabled">
                     <ecl:command>launchctl list | grep com.apple.screensharing</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable Printer Sharing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>By enabling Printer sharing the computer is set up as a print server to accept print jobs from other computers. Dedicated print servers or direct IP printing should be used instead.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling Printer Sharing mitigates the risk of attackers attempting to exploit the print server to gain access to the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Sharing</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Uncheck <xhtml:em>Printer Sharing</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure printer sharing is disabled">
                     <ecl:command>system_profiler SPPrintersDataType </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="Shared: Yes"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable Remote Login</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Remote Login allows an interactive terminal connection to a computer.</xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling Remote Login mitigates the risk of an unauthorized person gaining access to the system via Secure Shell (SSH). While SSH is an industry standard to connect to posix servers, the scope of the benchmark is for Apple OSX clients, not servers.</xhtml:p>
               <xhtml:p>OS X does have an IP based firewall available (pf, ipfw has been deprecated) that is not enabled or configured. There are more details and links in section 7.5. OS X no longer has TCP Wrappers support built-in and does not have strong Brute-Force password guessing mitigations, or frequent patching of openssh by Apple. Most OS X computers are mobile workstations, managing IP based firewall rules on mobile devices can be very resource intensive. All of these factors can be parts of running a hardened SSH server.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:div>
                        <xhtml:ol>
                           <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo systemsetup -setremotelogin off</xhtml:code>
                           </xhtml:li>
                        </xhtml:ol>
                     </xhtml:div>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The SSH server built-in to OS X should not be enabled on a standard user computer, particularly one that changes locations and IP addresses. A standard user that runs local applications including email, web browser and productivity tools should not use the same device as a server. There are Enterprise management tool-sets that do utilize SSH, if they are in use, the computer should be locked down to only respond to known trusted IP addresses and appropriate admin service accounts.</xhtml:p>
                        <xhtml:p>For OS X computers that are being used for specialized functions there are several options to harden the SSH server to protect against unauthorized access including brute force attacks. There are some basic criteria that need to be considered:</xhtml:p>
                        <xhtml:ul>
                           <xhtml:li>Do not open an SSH server to the internet without controls in place to mitigate SSH brute force attacks, this is particularly important for systems bound to Directory environments. It is great to have controls in place to protect the system but if they trigger after the user is already locked out of their account they are not optimal. If authorization happens after authentication directory accounts for users that don't even use the system can be locked out.</xhtml:li>
                           <xhtml:li>Do not use SSH key pairs when there is no insight to the security on the client system that will authenticate into the server with a private key. If an attacker gets access to the remote system and can find the key they may not need a password or a key logger to access the SSH server.</xhtml:li>
                           <xhtml:li>Detailed instructions on hardening an SSH server, if needed, are available in the CIS Linux Benchmarks but it is beyond the scope of this benchmark</xhtml:li>
                        </xhtml:ul>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure remote login is disabled">
                     <ecl:command>launchctl list | grep com.openssh.sshd</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable DVD or CD Sharing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>DVD or CD Sharing allows users to remotely access the system's optical drive.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling DVD or CD Sharing minimizes the risk of an attacker using the optical drive as a vector for attack and exposure of sensitive data.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Sharing</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Uncheck <xhtml:em>DVD or CD Sharing</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Many Apple devices are now sold without optical drives and drive sharing may be needed for legacy optical media.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure DVD and CD sharing are disabled">
                     <ecl:command>launchctl list | egrep ODSAgent</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable Bluetooth Sharing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Bluetooth Sharing allows files to be exchanged with Bluetooth enabled devices. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling Bluetooth Sharing minimizes the risk of an attacker using Bluetooth to remotely attack the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:div class="page">
                        <xhtml:div class="layoutArea">
                           <xhtml:div class="column">
                              <xhtml:p> </xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>Open System Preferences</xhtml:li>
                                 <xhtml:li>Select Sharing</xhtml:li>
                                 <xhtml:li>Uncheck Bluetooth Sharing </xhtml:li>
                              </xhtml:ol>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure no users have bluetooth sharing enabled">
                     <ecl:command>UUID=`ioreg -rd1 -c IOPlatformExpertDevice | grep "IOPlatformUUID" | sed -e 's/^.* "\(.*\)"$/\1/'`; for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/ByHost/com.apple.Bluetooth.$UUID; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF.plist PrefKeyServicesEnabled; fi; done</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="\s1$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable File Sharing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Apple's File Sharing uses a combination of SMB (Windows sharing) and AFP (Mac sharing)</xhtml:p>
               <xhtml:p>Three common ways to share files using File Sharing are:</xhtml:p>
               <xhtml:ol>
                  <xhtml:li>Apple File Protocol (AFP)<xhtml:br/>AFP automatically uses encrypted logins, so this method of sharing files is fairly secure. The entire hard disk is shared to administrator user accounts. Individual home folders are shared to their respective user accounts. Users' "Public" folders (and the "Drop Box" folder inside) are shared to any user account that has sharing access to the computer (i.e. anyone in the "staff" group, including the guest account if it is enabled).</xhtml:li>
                  <xhtml:li>Server Message Block (SMB), Common Internet File System (CIFS)<xhtml:br/>When Windows (or possibly Linux) computers need to access file shared on a Mac, SMB/CIFS file sharing is commonly used. Apple warns that SMB sharing stores passwords is a less secure fashion than AFP sharing and anyone with system access can gain access to the password for that account. When sharing with SMB, each user that will access the Mac must have SMB enabled.</xhtml:li>
               </xhtml:ol>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>By disabling file sharing, the remote attack surface and risk of unauthorized access to files stored on the system is reduced.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>Run the following command in Terminal to turn off AFP from the command line:<xhtml:code class="code_block">sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.AppleFileServer.plist </xhtml:code>
                        </xhtml:li>
                     </xhtml:ul>
                     <xhtml:ul>
                        <xhtml:li>Run the following command in Terminal to turn off SMB sharing from the CLI: <xhtml:code class="code_block">sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.smbd.plist</xhtml:code>
                        </xhtml:li>
                     </xhtml:ul>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>File Sharing can be used to share documents with other users but hardened servers should be used rather than user endpoints. Turning on file sharing increases the visibility and attack surface of a system unnecessarily. </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure 'nmdb' 'smdb' 'AppleFileServer' not found in 'launchctl list'">
                     <ecl:command>launchctl list | egrep '(nmdb|smdb|AppleFileServer)'</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value=".+"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable Remote Management</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Remote Management is the client portion of Apple Remote Desktop (ARD). Remote Management can be used by remote administrators to view the current Screen, install software, report on, and generally manage client Macs.</xhtml:p>
               <xhtml:p>The screen sharing options in Remote Management are identical to those in the Screen Sharing section. In fact, only one of the two can be configured. If Remote Management is used, refer to the Screen Sharing section above on issues regard screen sharing.</xhtml:p>
               <xhtml:p>Remote Management should only be enabled when a Directory is in place to manage the accounts with access. Computers will be available on port 5900 on an OS X System and could accept connections from untrusted hosts depending on the configuration, definitely a concern for mobile systems.</xhtml:p>
               <xhtml:p> </xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Remote management should only be enabled on trusted networks with strong user controls present in a Directory system. Mobile devices without strict controls are vulnerable to exploit and monitoring.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In System Preferences: Sharing, turn off Remote Management.</xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Many organizations utilize ARD for client management.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure ARDAgent is not running">
                     <ecl:command>ps -ef | egrep ARDAgent</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.5_Energy_Saver">
         <xccdf:title xml:lang="en">Energy Saver</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>This section contains recommendations related to the configurable items under the <xhtml:em>Energy Saver</xhtml:em> panel.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1_Disable_Wake_for_network_access" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable "Wake for network access"</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This feature allows other users to be able to access your computer#x2019;s shared resources, such as shared printers or iTunes playlists, even when your computer is in sleep mode</xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling this feature mitigates the risk of an attacker remotely waking the system and gaining access.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo pmset -a womp 0  </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Note: The <xhtml:span class="inline_block">-c</xhtml:span> flag means "wall power." Different settings must be used for other power sources.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Management programs like Apple Remote Desktop Administrator use this feature to wake computers. If turned off, such management programs will not be able to wake a computer over the LAN. If the wake-on-LAN feature is needed, do not turn off this feature.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure 'pmset -g' womp is set to 0" success="pass">
                     <ecl:command>pmset -g | grep -i '^AC Power.*[^*]$' || pmset -g | egrep "^\s+womp\s+0$"</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Disable_sleeping_the_computer_when_connected_to_power" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable sleeping the computer when connected to power</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>In some institutions certain software must be run that requires the computer to be awake. In these situations the computer should not be set to sleep.</xhtml:p>
               <xhtml:p>Not allowing the computer to sleep will use more power and increase the cost to operate the computer. This must be weighed against the needs of the organization.</xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The ability to apply security patches and perform vulnerability assessments on the system is reduced when the system is sleeping.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In System Preferences: Energy Saver, drag the slider for "Put the computer to sleep..." to never.</xhtml:p>
                     <xhtml:p>Alternatively, use the following command:</xhtml:p>
                     <xhtml:code class="code_block">sudo pmset -c sleep 0   </xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Preventing systems from sleeping may increase energy consumption</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure computer does not sleep when connected to power" success="pass">
                     <ecl:command>pmset -g | grep -i '^AC Power.*[^*]$' || pmset -g | egrep "^\s*sleep\s+0(\s+.*)?$"</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.6_Security__Privacy">
         <xccdf:title xml:lang="en">Security &amp; Privacy</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section contains recommendations for configurable options under the <xhtml:em>Security &amp; Privacy</xhtml:em> panel.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.1_Enable_FileVault" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Enable FileVault</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>FileVault secures a system's data by automatically encrypting its boot volume and requiring a password or recovery key to access it.</xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Encrypting sensitive data minimizes the likelihood of unauthorized users gaining access to it.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:div>
                        <xhtml:ol>
                           <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                           </xhtml:li>
                           <xhtml:li>Select <xhtml:em>Security &amp; Privacy</xhtml:em>
                           </xhtml:li>
                           <xhtml:li>Select <xhtml:em>FileVault</xhtml:em>
                           </xhtml:li>
                           <xhtml:li>Select <xhtml:em>Turn on FileVault</xhtml:em>
                           </xhtml:li>
                        </xhtml:ol>
                     </xhtml:div>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'Encryption Status' is set to 'Unlocked'">
                        <ecl:command>diskutil cs list | grep -i encryption</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="Encryption Status:\s+Unlocked"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'Encryption Type' is set to 'AES-XTS'">
                        <ecl:command>diskutil cs list | grep -i encryption</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="Encryption Type:\s*AES-XTS"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.2_Enable_Gatekeeper" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Enable Gatekeeper</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Gatekeeper is Apple's application white-listing control that restricts downloaded applications from launching. It functions as a control to limit applications from unverified sources from running without authorization. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disallowing unsigned software will reduce the risk of unauthorized or malicious applications from running on the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Security &amp; Privacy</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>General</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:span>Allow applications downloaded from: Mac App Store and identified developers</xhtml:span>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively, perform the following to ensure the system is configured as:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">
                              <xhtml:span>sudo spctl --master-enable</xhtml:span>
                           </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure Gatekeeper is enabled">
                     <ecl:command>spctl --status</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="assessments\s+enabled"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.3_Enable_Firewall" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Enable Firewall</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall.</xhtml:p>
               <xhtml:p>
                  <xhtml:a href="http://support.apple.com/en-us/HT201642">http://support.apple.com/en-us/HT201642</xhtml:a>
               </xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>A firewall minimizes the threat of unauthorized users from gaining access to your system while connected to a network or the Internet.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Security &amp; Privacy</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Firewall</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Turn On Firewall</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively: </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">defaults write /Library/Preferences/com.apple.alf globalstate - int &lt;value&gt;</xhtml:code>
                        </xhtml:li>
                        <xhtml:li>Where <xhtml:span class="inline_block">&lt;value&gt;</xhtml:span> is:</xhtml:li>
                        <xhtml:ul>
                           <xhtml:li>
                              <xhtml:span class="inline_block">1</xhtml:span> = on for specific services</xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">2</xhtml:span> = on for essential services</xhtml:li>
                        </xhtml:ul>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The firewall may block legitimate traffic. Applications that are unsigned will require special handling.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure the firewall is enabled">
                     <ecl:command>defaults read /Library/Preferences/com.apple.alf globalstate </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="(1|2)"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.4_Enable_Firewall_Stealth_Mode" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Enable Firewall Stealth Mode</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>While in Stealth mode the computer will not respond to unsolicited probes, dropping that traffic.</xhtml:p>
               <xhtml:p>
                  <xhtml:a href="http://support.apple.com/en-us/HT201642">http://support.apple.com/en-us/HT201642</xhtml:a>
               </xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Stealth mode on the firewall minimizes the threat of system discovery tools while connected to a network or the Internet.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Security &amp; Privacy</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Firewall Options</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Enable stealth mode</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively: </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on</xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Traditional network discovery tools like ping will not succeed. Other network tools that measure activity and approved applications will work as expected.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure the firewall is enabled">
                     <ecl:command>/usr/libexec/ApplicationFirewall/socketfilterfw --getstealthmode</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="Stealth mode enabled"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.5_Review_Application_Firewall_Rules" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Review Application Firewall Rules</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall.</xhtml:p>
               <xhtml:p>
                  <xhtml:a href="http://support.apple.com/en-us/HT201642">http://support.apple.com/en-us/HT201642</xhtml:a>
               </xhtml:p>
               <xhtml:p>A computer should have a limited number of applications open to incoming connectivity. This rule will check for whether there are more than 10 rules for inbound connections.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>A firewall minimizes the threat of unauthorized users from gaining access to your system while connected to a network or the Internet. Which applications are allowed access to accept incoming connections through the firewall is important to understand.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Security &amp; Privacy</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Firewall</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Turn On Firewall</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively: </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">defaults write /Library/Preferences/com.apple.alf globalstate - int &lt;value&gt;</xhtml:code>
                        </xhtml:li>
                        <xhtml:li>Where <xhtml:span class="inline_block">&lt;value&gt;</xhtml:span> is:</xhtml:li>
                        <xhtml:ul>
                           <xhtml:li>
                              <xhtml:span class="inline_block">1</xhtml:span> = on for specific services</xhtml:li>
                           <xhtml:li>
                              <xhtml:span class="inline_block">2</xhtml:span> = on for essential services</xhtml:li>
                        </xhtml:ul>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The firewall may block legitimate traffic. Applications that are unsigned will require special handling.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure the firewall is enabled">
                        <ecl:command>defaults read /Library/Preferences/com.apple.alf globalstate </ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="1"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="none exist" comment="Ensure firewall rules count less than 10">
                        <ecl:command>/usr/libexec/ApplicationFirewall/socketfilterfw --listapps</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^ALF: total number of apps = [1-9][0-9]+"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.6_Enable_Location_Services" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Enable Location Services</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>MacOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. Users do not need to change the time or the time zone, the computer will do it for them. They do not need to specify their location for weather or travel times and even get alerts on travel times to meetings and appointment where location information is supplied.</xhtml:p>
               <xhtml:p>For the purpose of asset management and time and log management with mobile computers location services simplify some processes.</xhtml:p>
               <xhtml:p>There are some use cases where it is important that the computer not be able to report it's exact location. While the general use case is to enable Location Services, it should not be allowed if the physical location of the computer and the user should not be public knowledge.</xhtml:p>
               <xhtml:p>https://support.apple.com/en-us/HT204690</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Location services are helpful in most use cases and can simplify log and time management where computers change time zones.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Perform the following to ensure the system is configured as prescribed:</xhtml:span>
                     </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
                           <xhtml:p>
                              <xhtml:span>In Terminal, run the following command:</xhtml:span>
                           </xhtml:p>
                           <xhtml:code>
                              <xhtml:span>
                                 <xhtml:span>sudo </xhtml:span>launchctl load /System/Library/LaunchDaemons/com.apple.locationd.plist</xhtml:span>
                           </xhtml:code>
                        </xhtml:li>
                        <xhtml:li>
                           <xhtml:div class="page">
                              <xhtml:div class="layoutArea">
                                 <xhtml:div class="column">
                                    <xhtml:p>
                                       <xhtml:span>There should be no response</xhtml:span>
                                    </xhtml:p>
                                 </xhtml:div>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:span>In some use cases organizations may not want Location Services running in those cases "unload" rather than "load" is the appropriate command</xhtml:span>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:span>Perform the following to ensure the system is configured as prescribed:</xhtml:span>
                        </xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>
                              <xhtml:p>
                                 <xhtml:span>In Terminal, run the following command:</xhtml:span>
                              </xhtml:p>
                              <xhtml:code>
                                 <xhtml:span>
                                    <xhtml:span>sudo </xhtml:span>launchctl unload /System/Library/LaunchDaemons/com.apple.locationd.plist</xhtml:span>
                              </xhtml:code>
                           </xhtml:li>
                           <xhtml:li>
                              <xhtml:div class="page">
                                 <xhtml:div class="layoutArea">
                                    <xhtml:div class="column">
                                       <xhtml:p>
                                          <xhtml:span>Verify that the results include:</xhtml:span>
                                          <xhtml:span>
                                             <xhtml:span> Could not find specified service</xhtml:span>
                                             <xhtml:span> </xhtml:span>
                                          </xhtml:span>
                                       </xhtml:p>
                                    </xhtml:div>
                                 </xhtml:div>
                              </xhtml:div>
                           </xhtml:li>
                        </xhtml:ol>
                     </xhtml:div>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.7_Monitor_Location_Services_Access" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Monitor Location Services Access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>MacOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. While location services may be very useful it may not be desirable to allow all applications that can use location services to use your location for Internet queries to provide tailored content based on your current location.</xhtml:p>
               <xhtml:p>Ensure that the applications that can use Location Services are authorized to use that information and provide that information where the application interacts with external systems. Apple provides feedback within System Preferences and may be enabled to provide information on the menu bar when Location Services are used.</xhtml:p>
               <xhtml:p>Safari can deny access from websites or prompt for access.</xhtml:p>
               <xhtml:p>Applications that support Location Services can be individually controlled in the Privacy tab in Security &amp; Privacy under System Preferences.</xhtml:p>
               <xhtml:p>Access should be evaluated to ensure that privacy controls are as expected.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Privacy controls should be monitored for appropriate settings</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p> Safari Configuration </xhtml:p>
                     <xhtml:div class="page">
                        <xhtml:div class="layoutArea">
                           <xhtml:div class="column">
                              <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                              <xhtml:ol>
                                 <xhtml:li>
                                    <xhtml:p>Open <xhtml:span style="font-style: italic;">Safari</xhtml:span>
                                    </xhtml:p>
                                 </xhtml:li>
                                 <xhtml:li>
                                    <xhtml:p>Select <xhtml:span style="font-style: italic;">Safari </xhtml:span>from the menu bar</xhtml:p>
                                 </xhtml:li>
                                 <xhtml:li>
                                    <xhtml:p>Select <xhtml:span style="font-style: italic;">Preferences</xhtml:span>
                                    </xhtml:p>
                                 </xhtml:li>
                                 <xhtml:li>
                                    <xhtml:p>Select <xhtml:span style="font-style: italic;">Privacy</xhtml:span>
                                    </xhtml:p>
                                 </xhtml:li>
                                 <xhtml:li>
                                    <xhtml:p>Check <xhtml:em>Deny without prompting</xhtml:em>
                                       <xhtml:em> </xhtml:em>or<xhtml:em> Prompt for each website once each day</xhtml:em>
                                    </xhtml:p>
                                 </xhtml:li>
                              </xhtml:ol>
                              <xhtml:p>
                                 <xhtml:span style="font-style: italic;">
                                    <xhtml:br/>
                                 </xhtml:span>
                              </xhtml:p>
                              <xhtml:p>
                                 <xhtml:span style="font-style: italic;"> </xhtml:span>Perform the following to review applications in System Preferences:</xhtml:p>
                              <xhtml:div class="page">
                                 <xhtml:div class="layoutArea">
                                    <xhtml:div class="column">
                                       <xhtml:div class="page">
                                          <xhtml:div class="layoutArea">
                                             <xhtml:div class="column">
                                                <xhtml:ol>
                                                   <xhtml:li>Open <xhtml:span style="font-style: italic;">System Preferences</xhtml:span>
                                                   </xhtml:li>
                                                   <xhtml:li>Select <xhtml:span style="font-style: italic;">Security &amp; Privacy</xhtml:span>
                                                   </xhtml:li>
                                                   <xhtml:li>Select <xhtml:span style="font-style: italic;">Privacy</xhtml:span>
                                                   </xhtml:li>
                                                   <xhtml:li>Select <xhtml:span style="font-style: italic;">location Services</xhtml:span>
                                                   </xhtml:li>
                                                   <xhtml:li>Uncheck applications that are not approved for access to  location service information</xhtml:li>
                                                </xhtml:ol>
                                             </xhtml:div>
                                          </xhtml:div>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.7_iCloud">
         <xccdf:title xml:lang="en">iCloud</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>iCloud is Apple's service for synchronizing, storing and backing up data from Apple applications in both OS X and iOS</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7.1_iCloud_configuration" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">iCloud configuration</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Apple's iCloud is a consumer oriented service that allows a user to store data as well as find, control and backup devices that are associated with their Apple ID (Apple account.) The use of iCloud on Enterprise devices should align with the acceptable use policy for devices that are managed as well as confidentiality requirements for data handled by the user. If iCloud is allowed the data that is copied to Apple servers will likely be duplicated on both personal as well as Enterprise devices.</xhtml:p>
               <xhtml:p>For many users the Enterprise email system may replace many of the available features in iCloud. If using either an Exchange or Google environment email, calendars, notes and contacts can sync to the official Enterprise repository and be available through multiple devices.</xhtml:p>
               <xhtml:p>Depending on workplace requirements it may not be appropriate to intermingle Enterprise and personal bookmarks, photos and documents. Since the service allows every device associated with the users ID to synchronize and have access to the cloud storage the concern is not just about having sensitive data on Apple's servers but having that same data on the phone of the teenage son or daughter of an employee. The use of family sharing options can reduce the risk.</xhtml:p>
               <xhtml:p>The remote connectivity of "Back to My Mac" relies on screen sharing that should already be turned off, if available the users Apple ID (personal?) can be used for remote access to the Enterprise computer rather than through Enterprise managed accounts.</xhtml:p>
               <xhtml:p>Apple's iCloud is just one of many cloud based solutions being used for data synchronization across multiple platforms and it should be controlled consistently with other cloud services in your environment. Work with your employees and configure the access to best enable data protection for you mission.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7.2_iCloud_keychain" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">iCloud keychain</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The iCloud keychain is Apple's password manager that works with OS X and iOS. The capability allows users to store passwords in either iOS or OS X for use in Safari on both platforms and other iOS integrated applications.  The most pervasive use is driven by iOS use rather than OS X. The passwords stored in an OS X keychain on an Enterprise managed computer could be stored in Apple's cloud and then be available on a personal computer using the same account. The stored passwords could be for organizational as well as for personal accounts.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Ensure that the iCloud keychain is used consistently with organizational requirements</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.8_Time_Machine">
         <xccdf:title xml:lang="en">Time Machine</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>One of the most important IT Operational concerns is to ensure that information is protected against loss or tampering. The purpose of the IT devices is to process the data after all. At one time the cost of IT equipment and the volume of the data might make the protection of the equipment itself more important, at this point the vast size of data archives and the lower cost of end user equipment makes data protection central to operational planning. Backup strategies are generally focused on ensuring that there are multiple copies of relevant versions of user files. The plan is that no single hardware or software loss or failure will result in major data loss.</xhtml:p>
            <xhtml:p>Apple introduced Time Machine in 2007 as a simple to use built-in mechanism for users to ensure that their machine was backed up and if there was a mistake or loss information could be easily recovered. There are other solutions to ensure information is protected including several Enterprise solutions and simple drive or directory cloning.</xhtml:p>
            <xhtml:p>The controls in this section are specifically about FileVault. The general ideas are applicable to any data backup solution.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8.1_Time_Machine_Auto-Backup" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Time Machine Auto-Backup</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Backup solutions are only effective if the backups run on a regular basis. The time to check for backups is before the hard drive fails or the computer goes missing. In order to simplify the user experience so that backups are more likely to occur Time Machine should be on and set to Back Up Automatically whenever the target volume is available.</xhtml:p>
               <xhtml:p>Operational staff should ensure that backups complete on a regular basis and the backups are tested to ensure that file restoration from backup is possible when needed.</xhtml:p>
               <xhtml:p>Backup dates are available even when the target volume is not available in the Time Machine plist.</xhtml:p>
               <xhtml:p> </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">SnapshotDates =             (</xhtml:span>
               </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">                "2012-08-20 12:10:22 +0000",</xhtml:span>
               </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">                "2013-02-03 23:43:22 +0000",</xhtml:span>
               </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">                "2014-02-19 21:37:21 +0000",</xhtml:span>
               </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">                "2015-02-22 13:07:25 +0000",</xhtml:span>
               </xhtml:p>
               <xhtml:p class="p1"> </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">                "2016-08-20 14:07:14 +0000"</xhtml:span>
               </xhtml:p>
               <xhtml:p class="p1">
                  <xhtml:span class="s1">When the backup volume is connected to the computer more extensive information is available through tmutil. See man tmutil</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Backups should automatically run whenever the backup drive is avaialable</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Perform the following to configure the system as prescribed:</xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>1. Run the following command in Terminal:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code>
                        <xhtml:span> defaults write /Library/Preferences/com.apple.TimeMachine.plist AutoBackup 1 </xhtml:span>
                     </xhtml:code>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The backup will run periodically in the background and could have user impact while running. </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Time Machine auto-backup is enabled">
                     <ecl:command>defaults read /Library/Preferences/com.apple.TimeMachine.plist AutoBackup</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="0"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8.2_Time_Machine_Volumes_Are_Encrypted" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Time Machine Volumes Are Encrypted</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>One of the most important security tools for data protection on MacOS is FileVault. With encryption in place it makes it difficult for an outside party to access your data if they get physical possession of the computer. One very large weakness in data protection with FileVault is the level of protection on backup volumes. If the internal drive is encrypted but the external backup volume that goes home in the same laptop bag is not it is self-defeating. Apple tries to make this mistake easily avoided by providing a checkbox to enable encryption when setting-up a time machine backup. Using this option does require some password management, particularly if a large drive is used with multiple computers. A unique complex password to unlock the drive can be stored in keychains on multiple systems for ease of use.</xhtml:p>
               <xhtml:p>While some portable drives may contain non-sensitive data and encryption may make interoperability with other systems difficult backup volumes should be protected just like boot volumes.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Backup volumes need to be encrypted</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Ensure that backup volumes are encrypted using the Time </xhtml:span>
                        <xhtml:span>Machine</xhtml:span>
                        <xhtml:span> control or </xhtml:span>
                        <xhtml:span>using</xhtml:span>
                        <xhtml:span> Disk Utility </xhtml:span>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.9_Pair_the_remote_control_infrared_receiver_if_enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Pair the remote control infrared receiver if enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>An infrared receiver is a piece of hardware that sends information from an infrared remote control to another device by receiving and decoding signals. If a remote is used with a computer, a specific remote, or "pair", can be set-up to work with the computer. This will allow only the paired remote to work on that computer. If a remote is needed the receiver should only be accessible by a paired device. Many models do not have infrared hardware. The audit check looks for the hardware first.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>An infrared remote can be used from a distance to circumvent physical security controls. A remote could also be used to page through a document or presentation, thus revealing sensitive information.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform one of the following to implement the prescribed state:</xhtml:p>
                  <xhtml:p>Disable the remote control infrared receiver:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Security &amp; Privacy</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select the <xhtml:em>General</xhtml:em> tab</xhtml:li>
                     <xhtml:li>Select <xhtml:em>Advanced</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Check <xhtml:em>Disable remote control infrared receiver</xhtml:em>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Pair a remote control infrared receiver</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Holding the remote close to the computer, point the remote at the front of the computer.</xhtml:li>
                     <xhtml:li>Pair the Apple Remote.<xhtml:ul>
                           <xhtml:li>
                              <xhtml:p>If you have an Apple Remote with seven buttons, press and hold both the Right and Menu buttons on the remote until the paired-remote icon appears on your screen</xhtml:p>
                           </xhtml:li>
                           <xhtml:li>
                              <xhtml:p>If you have an Apple Remote with six buttons, press and hold both the Next and Menu buttons on the remote until the paired-remote icon appears on your screen</xhtml:p>
                           </xhtml:li>
                        </xhtml:ul>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure enabled IR receivers are paired">
                  <ecl:command>system_profiler -detailLevel basic SPUSBDataType 2&gt;/dev/null | egrep  "IR Receiver"; if [ "$?" == 0 ]; then ENABLED=$(defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled); UIDFILTER=$(defaults read /Library/Preferences/com.apple.driver.AppleIRController UIDFilter); if [ $ENABLED == 1 ]; then if [ "$UIDFILTER" == "none" ]; then echo Enabled and Not Paired; else echo Enabled and Paired; fi; else echo Disabled; fi; else echo Disabled; fi</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="Enabled and Not Paired"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.10_Enable_Secure_Keyboard_Entry_in_terminal.app" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Enable Secure Keyboard Entry in terminal.app</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal.</xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling Secure Keyboard Entry minimizes the risk of a key logger from detecting what is entered in Terminal.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:em>Terminal</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Terminal</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Secure Keyboard Entry</xhtml:em>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure Secure Keyboard Entry enabled in terminal.app">
                  <ecl:command>for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.Terminal; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF SecureKeyboardEntry 2&gt;&amp;1 | egrep '(Checking|^\d$|not exist)'; fi; done</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pn" value="^Checking User: '.*': 1$"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.11_Java_6_is_not_the_default_Java_runtime" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Java 6 is not the default Java runtime</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Apple had made Java part of the core Operating System for OS X. Apple is no longer providing Java updates for OS X and updated JREs and JDK are made available by Oracle. The latest version of Java 6 made available by Apple has many unpatched vulnerabilities and should not be the default runtime for Java applets that request one from the Operating System</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Java is one of the most exploited environments and is no longer maintained by Apple, old versions may still be installed and should be removed from the computer or not be in the default path.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Java 6 can be removed completely or, if necessary Java applications will only work with Java 6, a custom path can be used. </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Old applications may rely on either an Apple supplied version of Java 6 or an updated JDK.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="If java is in the path, ensure it is at least version Java 7">
                  <ecl:command>java -version 2&gt;&amp;1 | egrep -o '1\.[456]\.[^"\) ]+'</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="0"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.12_Configure_Secure_Empty_Trash" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Configure Secure Empty Trash</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Secure Empty Trash not only removes the file information from the file directory, it also overwrites the data in the file with meaningless data, thus preventing the file from being recovered.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Configuring Secure Empty Trash mitigates the risk of an admin user on the system recovering sensitive files that the user has deleted. It is possible for anyone with physical access to the device to get access if FileVault is not used, or to recover deleted data if the FileVault volume is already mounted.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select <xhtml:em>Finder</xhtml:em> 
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Preferences</xhtml:em> 
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Advanced</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Check <xhtml:em>Empty Trash Securely</xhtml:em>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Secure Empty Trash can take a long time, with FileVault in place the protection is erasing data within an already encrypted volume. This control does not effect the use of the rm command in the terminal. Users who rarely have large files to erase can use rm as a workaround</xhtml:p>
                     <xhtml:ul>
                        <xhtml:li>cd ~/.Trash</xhtml:li>
                        <xhtml:li>rm myproject-cui.pptx</xhtml:li>
                     </xhtml:ul>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure &quot;EmptySecureTrash&quot; is set to &quot;1&quot; for all users">
                  <ecl:command>for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.finder; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF EmptyTrashSecurely 2&gt;&amp;1 | egrep '(Checking|^\d$|not exist)'; fi; done</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="(: 0|does not exist)"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Logging_and_Auditing">
      <xccdf:title xml:lang="en">Logging and Auditing</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section provide guidance on configuring the logging and auditing facilities available in OSX 10.9.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1_Configure_asl.conf">
         <xccdf:title xml:lang="en">Configure asl.conf</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This configuration file handles what events are logged, where the logs are stored and how long they are retained. </xhtml:p>
            <xhtml:p>We have observed anomalies in log retention where retention period does not work as advertised and processes remove old logs that should be retained according to the settings in this section. If this happens on your boxes change your asl.conf file as indicated below.</xhtml:p>
            <xhtml:p> </xhtml:p>
            <xhtml:p class="p3"> </xhtml:p>
            <xhtml:p class="p3">
               <xhtml:span class="f2">##</xhtml:span>
            </xhtml:p>
            <xhtml:p class="p3">
               <xhtml:span class="f2"># configuration file for syslogd and aslmanager</xhtml:span>
            </xhtml:p>
            <xhtml:p class="p3">
               <xhtml:span class="f2">##</xhtml:span>
            </xhtml:p>
            <xhtml:p class="p3">
               <xhtml:span class="f2">= aslmanager_debug 1</xhtml:span>
            </xhtml:p>
            <xhtml:p class="p3">
               <xhtml:span class="f2">= module_ttl 180</xhtml:span>
            </xhtml:p>
            <xhtml:p> </xhtml:p>
            <xhtml:p class="p3"> </xhtml:p>
            <xhtml:div>
               <xhtml:span class="f2">
                  <xhtml:br/>
               </xhtml:span>
            </xhtml:div>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Retain_system.log_for_90_or_more_days" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Retain system.log for 90 or more days</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>OSX writes information pertaining to system-related events to the file <xhtml:span class="inline_block">/var/log/system.log</xhtml:span> and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization.</xhtml:p>
               <xhtml:p>The default value has an "all_max" file limitation, no reference to a minimum retention and a less precise rotation argument.</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>The maximum file size limitation string should be removed "all_max="</xhtml:li>
                  <xhtml:li>An organization appropriate retention should be added "ttl="</xhtml:li>
                  <xhtml:li>The rotation should be set with time stamps "rotate=utc" or "rotate=local"</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Archiving and retaining <xhtml:span class="inline_block">system.log</xhtml:span> for 90 or more days is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo vim /etc/asl.conf  </xhtml:code>
                        </xhtml:li>
                        <xhtml:li>Replace or edit the current setting with a compliant setting <xhtml:code class="code_block">&gt; system.log mode=0640 format=bsd rotate=utc compress file_max=5M ttl=90  </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Without log files system maintenance and security forensics cannot be properly performed. </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:file-content check="at least one" comment="Ensure ttl set to 90 or higher for system.log">
                     <ecl:path>/etc/asl.conf</ecl:path>
                     <ecl:line-selection op="pm" value="^&gt; system.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\s.*)?$"/>
                  </ecl:file-content>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Retain_appfirewall.log_for_90_or_more_days" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Retain appfirewall.log for 90 or more days</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>OSX writes information pertaining to system-related events to the file <xhtml:span class="inline_block">/var/log/</xhtml:span>
                  <xhtml:span class="inline_block">
                     <xhtml:span>appfirewall</xhtml:span>
                     <xhtml:span class="inline_block">.</xhtml:span>
                  </xhtml:span>
                  <xhtml:span class="inline_block">log</xhtml:span> and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization.</xhtml:p>
               <xhtml:p>The default value has an "all_max" file limitation, no reference to a minimum retention and a less precise rotation argument.</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>The maximum file size limitation string should be removed "all_max="</xhtml:li>
                  <xhtml:li>An organization appropriate retention should be added "ttl="</xhtml:li>
                  <xhtml:li>The rotation should be set with time stamps "rotate=utc" or "rotate=local"</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Archiving and retaining <xhtml:span class="inline_block">appfirewall<xhtml:span class="inline_block">.log</xhtml:span>
                  </xhtml:span> for 90 or more days is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo vim /etc/asl.conf  </xhtml:code>
                        </xhtml:li>
                        <xhtml:li>Replace or edit the current setting with a compliant setting <xhtml:code class="code_block">&gt; appfirewall.log mode=0640 format=bsd rotate=utc compress file_max=5M ttl=90  </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Without log files system maintenance and security forensics cannot be properly performed. </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:file-content check="at least one" comment="Ensure ttl set to 90 or higher for appfirewall.log">
                     <ecl:path>/etc/asl.conf</ecl:path>
                     <ecl:line-selection op="pm" value="^&gt; appfirewall.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\s.*)?$"/>
                  </ecl:file-content>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Retain_authd.log_for_90_or_more_days" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Retain authd.log for 90 or more days</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>OSX writes information pertaining to system-related events to the file <xhtml:span class="inline_block">/var/log/</xhtml:span>
                  <xhtml:span class="inline_block">authd.log</xhtml:span> and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs with it's own rule in asl.conf. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization.</xhtml:p>
               <xhtml:p>The default value has an "all_max" file limitation, no reference to a minimum retention and a less precise rotation argument.</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>The maximum file size limitation string should be removed "all_max="</xhtml:li>
                  <xhtml:li>An organization appropriate retention should be added "ttl="</xhtml:li>
                  <xhtml:li>The rotation should be set with time stamps "rotate=utc" or "rotate=local"</xhtml:li>
               </xhtml:ul>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Archiving and retaining <xhtml:span>authd.log</xhtml:span> for 90 or more days is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>
                           <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo vim /etc/asl/com.apple.authd</xhtml:code>
                        </xhtml:li>
                        <xhtml:li>Replace or edit the current setting with a compliant setting <xhtml:code class="code_block"> * file /var/log/authd.log mode=0640 format=bsd rotate=utc compress file_max=5M ttl=90 </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Without log files system maintenance and security forensics cannot be properly performed. </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:file-content check="at least one" comment="Ensure ttl set to 90 or higher for system.log">
                     <ecl:path>/etc/asl/com.apple.authd</ecl:path>
                     <ecl:line-selection op="pm" value="^\* file /var/log/authd.log [^#]* ttl=(9[0-9]|[1-9][0-9]{2,})(\s.*)?$"/>
                  </ecl:file-content>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_Enable_security_auditing" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Enable security auditing</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>OSX's audit facility, <xhtml:span class="inline_block">auditd</xhtml:span>, receives notifications from the kernel when certain system calls, such as <xhtml:span class="inline_block">open</xhtml:span>, <xhtml:span class="inline_block">fork</xhtml:span>, and <xhtml:span class="inline_block">exit</xhtml:span>, are made. These notifications are captured and written to an audit log.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Logs generated by <xhtml:span class="inline_block">auditd</xhtml:span> may be useful when investigating a security incident as they may help reveal the vulnerable application and the actions taken by a malicious actor. </xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist</xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure auditing is enabled">
                  <ecl:command>launchctl list | grep -i auditd </ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="com.apple.auditd"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_Configure_Security_Auditing_Flags" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Configure Security Auditing Flags</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>Auditing is the capture and maintenance of information about security-related events.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open a terminal session and edit the <xhtml:span class="inline_block">/etc/security/audit_control </xhtml:span>file.</xhtml:li>
                     <xhtml:li>Find the line beginning with "<xhtml:span class="inline_block">flags</xhtml:span>"</xhtml:li>
                     <xhtml:li>Add the following flags:<xhtml:span class="inline_block"> lo</xhtml:span>, <xhtml:span class="inline_block">ad</xhtml:span>, <xhtml:span class="inline_block">fd</xhtml:span>, <xhtml:span class="inline_block">fm</xhtml:span>, <xhtml:span class="inline_block">-all</xhtml:span>. </xhtml:li>
                     <xhtml:li>Save the file.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure logon/logoff events are audited">
                     <ecl:command>egrep "^flags:" /etc/security/audit_control</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="(:|,)lo(,.+)?$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure administrative events are audited">
                     <ecl:command>egrep "^flags:" /etc/security/audit_control</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="(:|,)ad(,.+)?$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure file deletion events are audited">
                     <ecl:command>egrep "^flags:" /etc/security/audit_control</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="(:|,)fd(,.+)?$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure file attribute modification events are audited">
                     <ecl:command>egrep "^flags:" /etc/security/audit_control</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="(:|,)fm(,.+)?$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure all failed events are audited">
                     <ecl:command>egrep "^flags:" /etc/security/audit_control</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="(:|,)-all(,.+)?$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_Enable_remote_logging_for_Desktops_on_trusted_networks" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Enable remote logging for Desktops on trusted networks</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>A log is a file that records the events that occur while an operating system and/or software is running. The built-in syslog capability in OS X runs over UDP without encryption. Broadcasting log unencrypted over the internet is not a good idea. While syslog may be acceptable on some internal trusted networks it is not a solution for mobile devices that hop between networks.</xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>Solutions for logging might include:</xhtml:span>
            </xhtml:p>
            <xhtml:ul>
               <xhtml:li>
                  <xhtml:span>An encrypted tunnel that auto reconnects for each new network the laptop joins</xhtml:span>
               </xhtml:li>
               <xhtml:li>
                  <xhtml:span>A third party logging daemon that encrypts the log transmission</xhtml:span>
               </xhtml:li>
               <xhtml:li>
                  <xhtml:span>A local store and forward script that bundles the logs and sends periodically through an encrypted transmission (ssh) or when the device is connected to a trusted network</xhtml:span>
               </xhtml:li>
            </xhtml:ul>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>In addition to local logging, remote logging can be enabled for internal computers on trusted networks. Local logs can be altered if the computer is compromised. Remote logging mitigates the risk of having the logs altered.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo pico /etc/syslog.conf  </xhtml:code>
                     </xhtml:li>
                     <xhtml:li>Add the following line to the top of the file, replacing "<xhtml:span class="inline_block">your.log.server</xhtml:span>" with the name or IP address of the log server, and keeping all other lines intact.<xhtml:span class="inline_block"> *.* @your.log.server </xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Exit, saving changes. </xhtml:li>
                     <xhtml:li>Reboot the system.  </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_Retain_install.log_for_365_or_more_days" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Retain install.log for 365 or more days</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>OSX writes information pertaining to system-related events to the file <xhtml:span class="inline_block">/var/log/</xhtml:span>
               <xhtml:span>install.log</xhtml:span> and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization.</xhtml:p>
            <xhtml:p>The default value has an "all_max" file limitation, no reference to a minimum retention and a less precise rotation argument.</xhtml:p>
            <xhtml:ul>
               <xhtml:li>The maximum file size limitation string should be removed "all_max="</xhtml:li>
               <xhtml:li>An organization appropriate retention should be added "ttl="</xhtml:li>
               <xhtml:li>The rotation should be set with time stamps "rotate=utc" or "rotate=local"</xhtml:li>
            </xhtml:ul>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Archiving and retaining <xhtml:span class="inline_block">install.log</xhtml:span> for at least a year is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred. </xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
                        <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                        <xhtml:ol>
                           <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo vim /etc/asl/com.apple.install  </xhtml:code>
                           </xhtml:li>
                           <xhtml:li>Replace or edit the current setting with a compliant setting <xhtml:code class="code_block"> * file /var/log/install.log mode=0640 format=bsd rotate=utc compress file_max=5M ttl=365 </xhtml:code>
                           </xhtml:li>
                        </xhtml:ol>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Without log files system maintenance and security forensics cannot be properly performed. </xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:file-content check="at least one" comment="Ensure ttl set to 365 or higher for /var/log/install.log">
                  <ecl:path>/etc/asl/com.apple.install</ecl:path>
                  <ecl:line-selection op="pm" value="^\* file /var/log/install.log [^#]* ttl=([1-9][0-9]{3,}|[4-9][0-9]{2}|3([7-9][0-9]|6[5-9]))(\s.*)?$"/>
               </ecl:file-content>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Network_Configurations">
      <xccdf:title xml:lang="en">Network Configurations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains guidance on configuring the networking related aspects of OSX.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_Disable_Bonjour_advertising_service" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Disable Bonjour advertising service</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Bonjour is an auto-discovery mechanism for TCP/IP devices which enumerate devices and services within a local subnet. DNS on Mac OS X  is integrated with Bonjour and should not be turned off, but the Bonjour advertising service can be disabled.</xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Bonjour can simplify device discovery from an internal rogue or compromised host. An attacker could use Bonjour's multicast DNS feature to discover a vulnerable or poorly-configured service or additional information to aid a targeted attack. Implementing this control disables the continuous broadcasting of "I'm here!" messages. Typical end-user endpoints should not have to advertise services to other computers. This setting does not stop the computer from sending out service discovery messages when looking for services on an internal subnet, if the computer is looking for a printer or server and using service discovery. To block all Bonjour traffic except to approved devices the pf or other firewall would be needed.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Make a backup copy of the <xhtml:span class="inline_block">mDNSResponder.plist </xhtml:span>file as a precaution.</xhtml:li>
                     <xhtml:li>Open the <xhtml:span class="inline_block">mDNSResponder.plist</xhtml:span> file in Terminal using your preferred text editor. Below is a sample command:<xhtml:br/>
                        <xhtml:code class="code_block">sudo nano "/System/Library/LaunchDaemons/com.apple.mDNSResponder.plist" </xhtml:code>
                     </xhtml:li>
                     <xhtml:li>Add <xhtml:span class="inline_block">&lt;string&gt;-NoMulticastAdvertisements&lt;/string&gt;</xhtml:span> to the array in the <xhtml:span class="inline_block">ProgramArguments</xhtml:span> section. For example, the following: <xhtml:br/>
                        <xhtml:code class="code_block">    &lt;key&gt;ProgramArguments&lt;/key&gt;<xhtml:br/>    &lt;array&gt;<xhtml:br/>        &lt;string&gt;/usr/sbin/mDNSResponder&lt;/string&gt;<xhtml:br/>        &lt;string&gt;-launchd&lt;/string&gt;<xhtml:br/>    &lt;/array&gt;   </xhtml:code>becomes:<xhtml:br/>
                        <xhtml:code class="code_block">    &lt;key&gt;ProgramArguments&lt;/key&gt;<xhtml:br/>    &lt;array&gt;<xhtml:br/>        &lt;string&gt;/usr/sbin/mDNSResponder&lt;/string&gt;<xhtml:br/>        &lt;string&gt;-launchd&lt;/string&gt;<xhtml:br/>        &lt;string&gt;-NoMulticastAdvertisements&lt;/string&gt;<xhtml:br/>    &lt;/array&gt; </xhtml:code>
                     </xhtml:li>
                     <xhtml:li>Save the file.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Some applications, like Final Cut Studio and AirPort Base Station management, may not operate properly if the <xhtml:span class="inline_block">mDNSResponder </xhtml:span>is turned off. </xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure Bonjour advertising services is disabled">
                  <ecl:command>defaults read /Library/Preferences/com.apple.alf globalstate</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="\s*[12]\s*$"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Enable "Show Wi-Fi status in menu bar"</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The Wi-Fi status in the menu bar indicates if the system's wireless internet capabilities are enabled. If so, the system will scan for available wireless networks to connect to. At the time of this revision all computers Apple builds have wireless, that has not always been the case, This control only pertains to systems that have a wireless NIC. Operating systems running in a virtual environment may not score as expected either.</xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling "Show Wi-Fi status in menu bar" is a security awareness method that helps mitigate public area wireless exploits by making the user aware of their wireless connectivity status.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select Network</xhtml:li>
                     <xhtml:li>Check <xhtml:em>Show Wi-Fi status in menu bar</xhtml:em>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:div>
                     <xhtml:div class="page">
                        <xhtml:div class="layoutArea">
                           <xhtml:div class="column">
                              <xhtml:p>
                                 <xhtml:span>Alternatively run the following in the command line: </xhtml:span>
                              </xhtml:p>
                              <xhtml:p> </xhtml:p>
                           </xhtml:div>
                        </xhtml:div>
                        <xhtml:div class="layoutArea">
                           <xhtml:div class="column">
                              <xhtml:code>
                                 <xhtml:span>Open /System/Library/CoreServices/Menu\ Extras/AirPort.menu/</xhtml:span>
                              </xhtml:code>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:div>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The user of the system should have a quick check on their wireless network status available</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure Show Wi-fi status in menu bar set for all users">
                  <ecl:command>networksetup -listallhardwareports | grep -i Wi-Fi &amp;&amp; for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.systemuiserver; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF menuExtras 2&gt;&amp;1 | grep AirPort.menu || echo 'Not Set'; fi; done</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="Not Set$"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_Create_network_specific_locations" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Create network specific locations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The network location feature of the Mac is very powerful tool to manage network security. By creating different network locations, a user can easily (and without administrative privileges) change the network settings on the Mac. By only using the network interfaces needed at any specific time, exposure to attackers is limited.</xhtml:p>
            <xhtml:p>A little understanding of how the Network System Preferences pane works is required.</xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Network locations allow the computer to have specific configurations ready for network access when required. Locations can be used to manage which network interfaces are available for specialized network access</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Create multiple network locations as needed.</xhtml:p>
                  <xhtml:p>Delete the Automatic location for any device that does not use multiple network services set for DHCP or dynamic addressing. If network services like FireWire, VPN, AirPort or Ethernet are not used by a specific device class those services should be deleted:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select Edit Locations from the Locations popup menu.</xhtml:li>
                     <xhtml:li>Select the Automatic location.</xhtml:li>
                     <xhtml:li>Click the minus button for any unneeded service.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p> </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Unneeded network interfaces increases the attack surface and could lead to a successful exploit.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure http server is not running</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Mac OS X used to have a graphical front-end to the embedded Apache web server in the Operating System. Personal web sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Personal web sharing from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. Apache however is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end user computer. Web sharing should only be done through hardened web servers and appropriate cloud services.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Web serving should not be done from a user desktop. Dedicated webservers or appropriate cloud storage should be used. Open ports make it easier to exploit the computer.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Ensure that the Web Server is not running and is not set to start at boot</xhtml:p>
                  <xhtml:p>Stop the Web Server</xhtml:p>
                  <xhtml:code class="code_block"> 
                     <xhtml:span>sudo apachectl stop</xhtml:span>
                  </xhtml:code>
                  <xhtml:p>Ensure that the web server will not auto-start at boot</xhtml:p>
                  <xhtml:code class="code_block"> 
                     <xhtml:span>sudo defaults write /System/Library/LaunchDaemons/org.apache.httpd Disabled -bool true</xhtml:span>
                  </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The web server is both a point of attack for the system and a means for unauthorized file transfers.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure httpd is not running">
                  <ecl:command>ps -ef | grep -i httpd</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="/usr/sbin/httpd"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_ftp_server_is_not_running" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure ftp server is not running</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Mac OS X used to have a graphical front-end to the embedded ftp server in the Operating System. Ftp sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Running an Ftp server from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. The Ftp server however is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end user computer. Ftp servers meet a specialized need to distribute files without strong authentication and should only be done through hardened servers. Cloud services or other distribution methods should be considered</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Ftp servers should not be run on an end user desktop. Dedicated servers or appropriate cloud storage should be used. Open ports make it easier to exploit the computer.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Ensure that the FTP Server is not running and is not set to start at boot</xhtml:p>
                  <xhtml:p>Stop the ftp Server</xhtml:p>
                  <xhtml:code class="code_block"> 
                     <xhtml:span>sudo -s launchctl unload -w /System/Library/LaunchDaemons/ftp.plist</xhtml:span>
                  </xhtml:code>
                  <xhtml:p> </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The ftp server is both a point of attack for the system and a means for unauthorized file transfers. The ftp server is another avenue to attempt brute forcing password for existing valid users.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure ftp server is not enabled">
                  <ecl:command>launchctl list | egrep ftp</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="com.apple.ftpd"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6_Ensure_nfs_server_is_not_running" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure nfs server is not running</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Mac OS X can act as an NFS fileserver. NFS sharing could be enabled to allow someone on another computer to mount shares and gain access to information from the user's computer. File sharing from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. NFSD is still part of the Operating System and can be easily turned on to export shares and provide remote connectivity to an end user computer.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>File serving should not be done from a user desktop, dedicated servers should be used. Open ports make it easier to exploit the computer.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Ensure that the NFS Server is not running and is not set to start at boot</xhtml:p>
                  <xhtml:p>Stop the NFS Server</xhtml:p>
                  <xhtml:code class="code_block"> 
                     <xhtml:span>sudo nfsd disable</xhtml:span>
                  </xhtml:code>
                  <xhtml:p>Remove the exported Directory listing</xhtml:p>
                  <xhtml:code class="code_block"> 
                     <xhtml:span>rm /etc/export</xhtml:span>
                  </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The nfs server is both a point of attack for the system and a means for unauthorized file transfers.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure nfsd is not running">
                     <ecl:command>ps -ef | grep -i nfsd</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="/sbin/nfsd"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure /etc/exports does not exist" success="fail">
                     <ecl:command>stat -L /etc/exports &gt; /dev/null</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:complex-check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_System_Access_Authentication_and_Authorization">
      <xccdf:title xml:lang="en">System Access, Authentication and Authorization</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>System Access, Authentication and Authorization</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_File_System_Permissions_and_Access_Controls">
         <xccdf:title xml:lang="en">File System Permissions and Access Controls</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>File system permissions have always been part of computer security. There are several principles that are part of best practices for a posix based system that are contained in this section, This section does not contain a complete list of every permission on an OS X System that might be problematic. Developers and use cases differ and what some admins long in the profession might consider a travesty a risk assessor steeped in BYOD trends may not give a second glance at. We are documenting here controls that should point out truly bad practices or anomalies that should be looked at and considered closely. Many of the controls are to mitigate the risk of privilege escalation attacks and data exposure to unauthorized parties.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Secure Home Folders</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>By default OS X allows all valid users into the top level of every other users home folder, and restricts access to the Apple default folders within. Another user on the same system can see you have a "Documents" folder but cannot see inside it. This configuration does work for personal file sharing but can expose user files to standard accounts on the system.</xhtml:p>
               <xhtml:p>The best parallel for Enterprise environments is that everyone who has a Dropbox account can see everything that is at the top level but can't see your pictures, in the parallel with OS X they can see into every new Directory that is created because of the default permissions.</xhtml:p>
               <xhtml:p>Home folders should be restricted to access only by the user. Sharing should be used on dedicated servers or cloud instances that are managing access controls. Some environments may encounter problems if execute rights are removed as well as read and write. Either no access or execute only for group or others is acceptable</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Allowing all users to view the top level of all networked user's home folder may not be desirable since it may lead to the revelation of sensitive information. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run one of the following commands in Terminal: <xhtml:code class="code_block">sudo chmod -R og-rwx /Users/&lt;username&gt;</xhtml:code>
                        </xhtml:li>
                        <xhtml:li>
                           <xhtml:code class="code_block">sudo chmod -R og-rw /Users/&lt;username&gt; </xhtml:code>
                        </xhtml:li>
                        <xhtml:li>Substitute user name in <xhtml:span class="inline_block">&lt;username&gt;</xhtml:span>. </xhtml:li>
                        <xhtml:li>This command has to be run for each user account with a local home folder.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If implemented, users will not be able to use the "Public" folders in other users' home folders. "Public" folders with appropriate permissions would need to be set up in the /Shared folder.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure permissions on user home folders are og-rwx">
                     <ecl:command>find /Users -type d ! -perm -1000 -maxdepth 1 -a -perm +0066 | egrep -v "^/Users$" </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value=".+"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Repair_permissions_regularly_to_ensure_binaries_and_other_System_files_have_appropriate_permissions" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Repair permissions regularly to ensure binaries and other System files have appropriate permissions</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Software installations, Upgrades and updates and end user activity can all end up changing the access controls on the Operating System. On a normal system lots of files get touched and changed and proper maintenance is necessary for good security. The standard software load on an end user system has so many moving parts that have regular updates to require periodic file permissions repair. We believe that a weekly permissions check should be scheduled to fix anything needed.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Permission problems can lead to exploitable gaps in the operating system. Without expected controls in place the system is more likely to be successfully attacked.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Manually run the check using Disk Utility or through the command line. A schedule should be set in ls /etc/periodic/weekly/</xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:code class="code_block">diskutil repairPermissions / </xhtml:code>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>System executables and other important files could be modified much more easily if appropriate permissions are not in place.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_Wide_Applications_for_appropriate_permissions" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Check System Wide Applications for appropriate permissions</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Applications in the System Applications Directory (/Applications) should be world executable since that is their reason to be on the system. They should not be world writable and allow any process or user to alter them for other processes or users to then execute modified versions</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Unauthorized modifications of applications could lead to  the execution of malicious code.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Change permissions so that "Others" can only execute. (Example Below)</xhtml:p>
                     <xhtml:code class="code_block">sudo chmod -R o-w /Applications/Bad\ Permissions.app/</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Applications changed will no longer be world writable</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure no applications have world write permissions">
                     <ecl:command>find /Applications -iname "*\.app" -type d -perm -2 -ls</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value=".+"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Check_System_folder_for_world_writable_files" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Check System folder for world writable files</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Software sometimes insists on being installed in the /System Directory and have inappropriate world writable permissions.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Folders in /System should not be world writable. The audit check excludes the "Drop Box" folder that is part of Apple's default user template.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Change permissions so that "Others" can only execute. (Example Below)</xhtml:p>
                     <xhtml:code class="code_block">sudo chmod -R o-w /Bad/Directory</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure no directories in /System have world write permissions">
                     <ecl:command>find /System -type d -perm -2 -ls</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pn" value="\s/System/Library/User Template/.+/Public/Drop Box$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Check_Library_folder_for_world_writable_files" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Check Library folder for world writable files</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Software sometimes insists on being installed in the /Library Directory and have inappropriate world writable permissions.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Folders in <xhtml:span class="inline_block">/Library</xhtml:span> should not be world writable. The audit check excludes the /Library/Caches folder where the sticky bit is set.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Change permissions so that "Others" can only execute. (Example Below)</xhtml:p>
                     <xhtml:code class="code_block">sudo chmod -R o-w /Bad/Directory</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure no directories in /Library have world write permissions">
                     <ecl:command>find /Library -type d -perm -2 -ls</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pn" value="\s/Library/Caches"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Password_Management">
         <xccdf:title xml:lang="en">Password Management</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Password security is an important part of general IT security where passwords are is use. For OS X passwords are still much more widely used than other methods for account access. While there are other authentication and authorization methods for access from an OS X computer to organizational services, console access to the Mac is probably done using a password. This section contains password controls.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configure account lockout threshold</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The account lockout threshold </xhtml:span>
                  <xhtml:span>specifies the amount of times a user can enter an incorrect password before a lockout will occur.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The account lockout feature mitigates brute-force password attacks on the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Perform the following to implement the prescribed state for all pwpolicy controls</xhtml:span>
                     </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">  sudo pwpolicy -setglobalpolicy "maxFailedLoginAttempts=5 minChars=15 requiresNumeric=1 requiresAlpha=1 requiresSymbol=1" </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The number of incorrect log on attempts should be reasonably small to minimize the possibility of a successful password attack, while allowing for honest errors made during a normal user log on.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'maxFailedLoginAttempts' is greater than '0'">
                        <ecl:command>pwpolicy -getglobalpolicy | tr " " "\n" | grep maxFailedLoginAttempts </ecl:command>
                        <ecl:line-selection op="pm" value="^\s*\S+\s*=\s*(.+?)\s*(#.*)?$">
                           <ecl:regex-group dt="xs:integer" group="1" op="gt" value="0"/>
                        </ecl:line-selection>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'maxFailedLoginAttempts' is less than or equal to '5'">
                        <ecl:command>pwpolicy -getglobalpolicy | tr " " "\n" | grep maxFailedLoginAttempts </ecl:command>
                        <ecl:line-selection op="pm" value="^\s*\S+\s*=\s*(.+?)\s*(#.*)?$">
                           <ecl:regex-group dt="xs:integer" group="1" op="le" value="5"/>
                        </ecl:line-selection>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Set a minimum password length</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>A minimum password length is the fewest number of characters a password can contain to meet a system's requirements. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Information systems that are not protected with strong password schemes including passwords of minimum length provide a greater opportunity for attackers to crack the password and gain access to the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Perform the following to implement the prescribed state for all pwpolicy controls</xhtml:span>
                     </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">  sudo pwpolicy -setglobalpolicy "maxFailedLoginAttempts=5 minChars=15 requiresNumeric=1 requiresAlpha=1 requiresSymbol=1" </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Short passwords can be easily attacked.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'minChars' is greater than or equal to '15'">
                     <ecl:command>pwpolicy -getglobalpolicy | tr " " "\n" | grep minChars </ecl:command>
                     <ecl:line-selection op="pm" value="^\s*\S+\s*=\s*(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="15"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Complex_passwords_must_contain_an_Alphabetic_Character" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Complex passwords must contain an Alphabetic Character</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The more complex a password the more resistant it will be against persons seeking unauthorized access to a system. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Perform the following to implement the prescribed state for all pwpolicy controls</xhtml:span>
                     </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">  sudo pwpolicy -setglobalpolicy "maxFailedLoginAttempts=5 minChars=15 requiresNumeric=1 requiresAlpha=1 requiresSymbol=1"  </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:span>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:span>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'requiresAlpha' is set to '1'">
                     <ecl:command>pwpolicy -getglobalpolicy | tr " " "\n" | grep requiresAlpha </ecl:command>
                     <ecl:line-selection op="pm" value="^\s*\S+\s*=\s*(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Complex_passwords_must_contain_a_Numeric_Character" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Complex passwords must contain a Numeric Character</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The more complex a password the more resistant it will be against persons seeking unauthorized access to a system. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Perform the following to implement the prescribed state for all pwpolicy controls</xhtml:span>
                     </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">  sudo pwpolicy -setglobalpolicy "maxFailedLoginAttempts=5 minChars=15 requiresNumeric=1 requiresAlpha=1 requiresSymbol=1"  </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:span>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:span>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'requiresSymbol' is set to '1'">
                     <ecl:command>pwpolicy -getglobalpolicy | tr " " "\n" | grep requiresSymbol </ecl:command>
                     <ecl:line-selection op="pm" value="^\s*\S+\s*=\s*(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Complex_passwords_must_contain_a_Symbolic_Character" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Complex passwords must contain a Symbolic Character</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The more complex a password the more resistant it will be against persons seeking unauthorized access to a system. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Perform the following to implement the prescribed state for all pwpolicy controls</xhtml:span>
                     </xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">  sudo pwpolicy -setglobalpolicy "maxFailedLoginAttempts=5 minChars=15 requiresNumeric=1 requiresAlpha=1 requiresSymbol=1"  </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>
                           <xhtml:span>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:span>
                        </xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'requiresSymbol' is set to '1'">
                     <ecl:command>pwpolicy -getglobalpolicy | tr " " "\n" | grep requiresSymbol </ecl:command>
                     <ecl:line-selection op="pm" value="^\s*\S+\s*=\s*(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Reduce the sudo timeout period</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The <xhtml:span class="inline_block">sudo</xhtml:span> command allows the user to run programs as the root user. Working as the root user allows the user an extremely high level of configurability within the system. </xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The <xhtml:span class="inline_block">sudo</xhtml:span> command stays logged in as the root user for five minutes before timing out and re-requesting a password. This five minute window should be eliminated since it leaves the system extremely vulnerable. This is especially true if an exploit were to gain access to the system, since they would be able to make changes as a root user.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo visudo  </xhtml:code>
                     </xhtml:li>
                     <xhtml:li>In the "<xhtml:span class="inline_block"># Defaults specification</xhtml:span>" section, add the line: <xhtml:code class="code_block">Defaults timestamp_timeout=0  </xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:file-content check="at least one" comment="Ensure &quot;Defaults timestamp_timeout=0&quot; in /etc/sudoers">
                  <ecl:path>/etc/sudoers</ecl:path>
                  <ecl:line-selection op="pm" value="^Defaults\s+timestamp_timeout\s*=\s*0$"/>
               </ecl:file-content>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_Automatically_lock_the_login_keychain_for_inactivity" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Automatically lock the login keychain for inactivity</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The login keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. Application access to the login keychain does not keep it unlocked. If you set Apple Mail to check for email every 10 minutes using the keychain for credentials and the keychain to lock every 15 minutes if inactive it will still cause the keychain to lock. The approach recommended here is that the login keychain be set to periodically lock when inactive to reduce the risk of password exposure or unauthorized use of credentials by a third party. The time period that an organization uses will depend on how great the use is of keychain aware applications. Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>While logged in, the keychain does not prompt the user for passwords for various systems and/or programs. This can be exploited by unauthorized users to gain access to password protected programs and/or systems in the absence of the user. Timing out the keychain can reduce the exploitation window.  </xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:em>Utilities</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Keychain Access</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select a keychain</xhtml:li>
                     <xhtml:li>Select <xhtml:em>Edit</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Change Settings for keychain &lt;keychain_name&gt;</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Authenticate, if requested.</xhtml:li>
                     <xhtml:li>Change the <xhtml:em>Lock after # minutes of inactivity</xhtml:em> setting for the Login Keychain to an approved value that should be longer than 6 hours or 3600 minutes or based on the access frequency of the security credentials included in the keychain for other keychains.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If the timeout is set too low on heavily used items the user will be annoyed and may use workarounds.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure keychain lock is set to 21600 seconds or less">
                  <ecl:command>security show-keychain-info 2&gt;&amp;1 | grep -o '[[:digit:]]\+'</ecl:command>
                  <ecl:line-selection dt="xs:integer" op="le" value="21600"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_login_keychain_is_locked_when_the_computer_sleeps" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure login keychain is locked when the computer sleeps</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>The login keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. The approach recommended here is that the login keychain be set to lock when when the computer sleeps to reduce the risk of password exposure.Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>While logged in, the keychain does not prompt the user for passwords for various systems and/or programs. This can be exploited by unauthorized users to gain access to password protected programs and/or systems in the absence of the user.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:em>Utilities</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Keychain Access</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select a keychain</xhtml:li>
                     <xhtml:li>Select <xhtml:em>Edit</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Change Settings for keychain &lt;keychain_name&gt;</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Authenticate, if requested.</xhtml:li>
                     <xhtml:li>Select <xhtml:em>Lock when sleeping</xhtml:em> setting</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The user may experience multiple prompts to unlock the keychain when waking from sleep.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure keychains are locked when the computer sleeps">
                  <ecl:command>security show-keychain-info 2&gt;&amp;1</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="lock\-on\-sleep"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6_Enable_OCSP_and_CRL_certificate_checking" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Enable OCSP and CRL certificate checking</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Certificates should only be trusted if they have both a satisfactory trust chain and they have not been revoked. OS X can check whether the certificate is still valid based on issued parameters within the certificate. </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A rogue or compromised certificate should not be trusted</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Run the following commands to enforce the compliant state</xhtml:p>
                  <xhtml:p>To set the CRL settings:</xhtml:p>
                  <xhtml:code class="code_block">defaults write com.apple.security.revocation CRLStyle -string RequireIfPresent </xhtml:code>
                  <xhtml:p>To set the OCSP settings:</xhtml:p>
                  <xhtml:code class="code_block">defaults write com.apple.security.revocation OCSPStyle -string RequireIfPresent </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Network or connectivity issues could interfere with certificate checks for valid certificates</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure com.apple.security.revocation CRLStyle is set to RequireIfPresent">
                     <ecl:command>defaults read com.apple.security.revocation CRLStyle</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^RequireIfPresent$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure com.apple.security.revocation OCSPStyle is set to RequireIfPresent">
                     <ecl:command>defaults read com.apple.security.revocation OCSPStyle</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^RequireIfPresent$"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Do not enable the "root" account</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The root account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. In the UNIX/Linux world, the system administrator commonly uses the root account to perform administrative functions.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling and using the root account puts the system at risk since any successful exploit or mistake while the root account is in use could have unlimited access privileges within the system. Using the <xhtml:span class="inline_block">sudo</xhtml:span> command allows users to perform functions as a root user while limiting and password protecting the access privileges.  By default the root account is not enabled on a Mac OS X client computer. It is enabled on Mac OS X Server. An administrator can escalate privileges using the <xhtml:span class="inline_block">sudo </xhtml:span>command (use <xhtml:span class="inline_block">-s</xhtml:span> or <xhtml:span class="inline_block">-i</xhtml:span> to get a root shell).</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Open System Preferences, Uses &amp; Groups.  Click the lock icon to unlock it.  In the Network Account Server section, click Join or Edit.  Click Open Directory Utility.  Click the lock icon to unlock it.  Select the Edit menu &gt; Disable Root User.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Some legacy posix software might expect an available root account.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure &quot;root&quot; account is not enabled">
                  <ecl:command>dscl . -read /Users/root AuthenticationAuthority 2&gt;&amp;1</ecl:command>
                  <ecl:line-selection dt="xs:string" op="eq" value="No such key: AuthenticationAuthority"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Disable automatic login</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The automatic login feature saves a user's system access credentials and bypasses the login screen, instead the system automatically loads to the user's desktop screen.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disabling automatic login decreases the likelihood of an unauthorized person gaining access to a system.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Run the following command in Terminal: <xhtml:br/>
                        <xhtml:code class="code_block">
                           <xhtml:span>
                              <xhtml:span>sudo defaults delete /Library/Preferences/com.apple.loginwindow autoLoginUser</xhtml:span> 
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If Automatic login is not disabled an unauthorized user could login without supplying a user password or credential.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure 'autoLoginUser' is not set">
                  <ecl:command>defaults read /Library/Preferences/com.apple.loginwindow | grep autoLoginUser</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value=".+"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Require a password to wake the computer from sleep or screen saver</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Sleep and screensaver modes are low power modes that reduces electrical consumption while the system is not in use. </xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Prompting for a password when waking from sleep or screensaver mode mitigates the threat of an unauthorized person gaining access to a system in the user's absence.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Run the following command in Terminal: The current user will need to log off and on for changes to take effect.<xhtml:code class="code_block"> defaults write com.apple.screensaver askForPassword -int 1<xhtml:span> </xhtml:span>
                        </xhtml:code>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:span>
                           <xhtml:span> The current user will need to log off and on for changes to take effect.</xhtml:span>
                        </xhtml:span>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Without a screenlock in place anyone with physical access to the computer would be logged in and able to use the active users session.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure a password is required to wake the computer from sleep or screen saver">
                  <ecl:command>for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.screensaver; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF askForPassword 2&gt;&amp;1 | egrep '(Checking|^\d$|not exist)'; fi; done </ecl:command>
                  <ecl:line-selection dt="xs:string" op="pn" value="^Checking User: '.+': 1$"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10_Require_an_administrator_password_to_access_system-wide_preferences" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Require an administrator password to access system-wide preferences</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>System Preferences controls system and user settings on an OS X Computer. System Preferences allows the user to tailor their experience on the computer as well as allowing the System Administrator to configure global security settings. Some of the settings should only be altered by the person responsible for the</xhtml:span>
               <xhtml:span> computer.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By requiring a password to unlock System-wide System Preferences the risk is mitigated of a user changing configurations that affect the entire system and requires an admin user to re-authenticate to make changes </xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> In System Preferences: Security, General tab under Advanced, check "Require an administrator password to access system-wide preferences"</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>If Automatic login is not disabled an unauthorized user could login without supplying a user password or credential.</xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure password is required to unlock System Preferences panes">
                  <ecl:command>security authorizationdb read system.preferences | grep "&lt;key&gt;shared&lt;/key&gt;" -A1 </ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="&lt;false/&gt;"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.11_Disable_ability_to_login_to_another_users_active_and_locked_session" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Disable ability to login to another user's active and locked session</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>OSX has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo vi /etc/pam.d/screensaver</xhtml:code>
                     </xhtml:li>
                     <xhtml:li>Locate   "account    required     pam_group.so no_warn group=admin,wheel fail_safe"</xhtml:li>
                     <xhtml:li>Remove "admin,"</xhtml:li>
                     <xhtml:li>Save</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>While Fast user switching is a workaround for some lab environments especially where there is even less of an expectation of privacy this setting change may impact some maintenance workflows</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure ability to login to another user's active+locked sessions is disabled">
                  <ecl:command>grep -i "^account.*group=admin,wheel fail_safe" /etc/pam.d/screensaver</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value=".+"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.12_Create_a_custom_message_for_the_Login_Screen" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Create a custom message for the Login Screen</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>An access warning informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>To add text with elevated privileges:<xhtml:code class="code_block">sudo defaults write /Library/Preferences/com.apple.loginwindow \  <xhtml:br/>
                           <xhtml:span>LoginwindowText "your text here"  </xhtml:span>
                        </xhtml:code>
                     </xhtml:li>
                     <xhtml:li>To remove the text with elevated privileges:<xhtml:code class="code_block">sudo defaults delete /Library/Preferences/com.apple.loginwindow \ <xhtml:br/>LoginwindowText  </xhtml:code>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If users are not informed of their responsibilities there may be unapproved activity. Users that are not approved for access may take the lack of a warning banner as implied consent to access.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="Ensure 'LoginwindowText' is set">
                  <ecl:command>defaults read /Library/Preferences/com.apple.loginwindow.plist </ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="LoginwindowText"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.13_Create_a_Login_window_banner" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Create a Login window banner</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>A  Login window banner warning informs the user that the system is reserved for authorized use only. It enforces an acknowledgment by the user that they have been informed of the use policy in the banner if required</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Place a file named PolicyBanner.txt in/Library/Security/</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Users will have to click on the window with the Login text before logging into the computer</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command comment="Ensure /Library/Security/PolicyBanner.(txt|rtf|rtfd) exists" success="pass">
                  <ecl:command>ls /Library/Security/PolicyBanner.txt || ls /Library/Security/PolicyBanner.rtf || ls /Library/Security/PolicyBanner.rtfd</ecl:command>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.14_Do_not_enter_a_password-related_hint" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Do not enter a password-related hint</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Password hints help the user recall their passwords for various systems and/or accounts. In most cases, password hints are simple and closely related to the user's password. </xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Password hints that are closely related to the user's password are a security vulnerability, especially in the social media age. Unauthorized users are more likely to guess a user's password if there is a password hint. The password hint is very susceptible to social engineering attacks and information exposure on social media networks</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:span class="inline_block">System Preferences</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">Users &amp; Groups</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Highlight the user</xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">Change Password</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Verify that no text is entered in the <xhtml:span class="inline_block">P<xhtml:span class="inline_block">as</xhtml:span>
                        </xhtml:span>
                        <xhtml:span class="inline_block">sword hint</xhtml:span> box</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.15_Disable_Fast_User_Switching" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Disable Fast User Switching</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Fast user switching allows a person to quickly log in to the computer with a different account. While only a minimal security risk, when a second user is logged in, that user might be able to see what processes the first user is using, or possibly gain other information about the first user. In a large directory environment where it is difficult to limit login access many valid users can login to other user's assigned computers.</xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Fast user switching allows multiple users to run applications simultaneously at console. There can be information disclosed about processes running under a different user. Without a specific configuration to save data and log out users can have unsaved data running in a background session that is not obvious.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>In System Preferences: Accounts, Login Options, make sure the "Enable fast user switching" checkbox is off.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Where support staff visit users computers consoles they will not be able to log in to their own session if there is an active and locked session.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.16_Secure_individual_keychains_and_items" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Secure individual keychains and items</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>By default, the keychain for an account, especially a local account, have the same password as the account's logon password. It is possible to change the passwords on keychains to something different than the login password, and doing so would keep that keychain locked until needed after login. This is especially important when a smartcard is being used for console login. Keychains need to be protected by more than a pin in order to be secured and the default behavior with a smartcard will result in a pin for the login password. Individual keychain entries can have special ACLs to increase security as well.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Each keychain entry can have different access controls. It's possible to set the keychain item to require a keychain password every time an item is accessed, even if the keychain is unlocked. This level of security could be useful for bank passwords or other passwords that need extra security.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:span class="inline_block">Utilities</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">Keychain Access</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Double-click keychain</xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">Access</xhtml:span> 
                        <xhtml:span class="inline_block">Control</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Check box next to "Ask for Keychain Password"</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Having to enter the keychain password for each access could become inconvenient and/or tedious for users.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.17_Create_specialized_keychains_for_different_purposes" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Create specialized keychains for different purposes</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>T<xhtml:span>he keychain is a secure database store for passwords and certificates and is created for each user account on Mac OS X. The system software itself uses keychains for secure storage. Users can create more than one keychain to protect various passwords separately.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en">
            <xhtml:p>If the user can logically split password and other entries into different keychains with different passwords, a compromise of one password will have limited effect.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:span class="inline_block">Utilities</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">Keychain Access</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">File</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">New Keychain</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Input name of new keychain next to <xhtml:span class="inline_block">Save As</xhtml:span> 
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">Create</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Drag and drop desired keychain items into new keychain from login keychain</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Using multiple keychains can be inconvenient. It is also not necessarily possible for all kinds of data, such as Safari auto-fill information, to be stored in secondary keychains. Not all keychain-aware applications may provide an interface to choose secondary keychains.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.18_Install_an_approved_tokend_for_smartcard_authentication_" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Install an approved tokend for smartcard authentication </xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>US Federal government systems as well as many others are requiring the use of smartcards for user authentication. In order to enable this functionality for console authentication as well as authentication through the browser or VPN client a middleware package that contains a "tokend" is used on OS X.</xhtml:p>
            <xhtml:p>The open source provided installers for OS X are located here:</xhtml:p>
            <xhtml:p>
               <xhtml:a href="https://smartcardservices.macosforge.org/">https://smartcardservices.macosforge.org/</xhtml:a>
            </xhtml:p>
            <xhtml:p>If your organization requires the use of a smartcard this control checks whether a tokend is in place. If your organization is not using smartcards or smartcard middleware that does not use tokend this control should not be scored.</xhtml:p>
            <xhtml:p> </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A tokend is part of mandated smartcard authentication for many organizations</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Install the appropriate tokend middleware installer for MacOS Forge or third party vendor.</xhtml:p>
                  <xhtml:p>
                     <xhtml:a href="https://smartcardservices.macosforge.org/">https://smartcardservices.macosforge.org/</xhtml:a>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="at least one" comment="At least one tokend present">
                  <ecl:command>ls -l /Library/Security/tokend/ | egrep tokend</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pm" value="^.*\.tokend"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_User_Accounts_and_Environment">
      <xccdf:title xml:lang="en">User Accounts and Environment</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Account management is a central part of security for any computer system including OS X. General practices should be followed to ensure that all accounts on a system are still needed and that default accounts should be removed. Users with admin roles should have distinct accounts for Admin functions as well as day to day work where the passwords are different and known only by the user assigned to the account. Accounts with Elevated privileges should not be easily discerned from the account name from standard accounts.</xhtml:p>
         <xhtml:p>When any computer system is added to a Directory System there are additional controls available including user account management that are not available in a standalone computer. One of the drawbacks is the local computer is no longer in control of the accounts that can access or manage it if given permission. For OS X if the computer is in a Directory any standard user can now login to the computer at console which by default may be desirable or not depending on the use case. If an admin group is allowed to administer the local computer the membership of that group is controlled completely in the Directory.</xhtml:p>
         <xhtml:p>OS X computers connected to a Directory should be configured so that the risk is appropriate for the mission use of the computer. Only those accounts that require local authentication should be allowed, only required administrator accounts should be in the local administrator group. Authenticated Users for console access and Domain Admins for Administration may be too broad or too limited</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6.1_Accounts_Preferences_Action_Items">
         <xccdf:title xml:lang="en">Accounts Preferences Action Items</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Proper account management is critical to computer security. Many options and settings in the Account System Preference Pane can be used to increase the security of the Mac.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Display login window as name and password</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The login window prompts a user for his/her credentials, verifies their authorization level and then allows or denies the user access to the system.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Prompting the user to enter both their username and password makes it twice as hard for unauthorized users to gain access to the system since they must discover two attributes.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Users and Groups</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Login Options</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Name and Password</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo defaults write /Library/Preferences/com.apple.loginwindow \ <xhtml:br/>
                              <xhtml:span>SHOWFULLNAME -bool yes</xhtml:span>
                           </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'SHOWFULLNAME' is set to '1'">
                     <ecl:command>defaults read /Library/Preferences/com.apple.loginwindow SHOWFULLNAME</ecl:command>
                     <ecl:line-selection dt="xs:string" op="eq" value="1"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable "Show password hints"</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Password hints are user created text displayed when an incorrect password is used for an account.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Password hints make it easier for unauthorized persons to gain access to systems by providing information to anyone that the user provided to assist remembering the password. This info could include the password itself or other information that might be readily discerned with basic knowledge of the end user.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Users &amp; Groups</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Login Options</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Uncheck <xhtml:em>Show password hints</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo defaults write /Library/Preferences/com.apple.loginwindow \ <xhtml:br/>
                              <xhtml:span>RetriesUntilHint -int 0 </xhtml:span>
                           </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The user can set the hint to any value including the password itself or clues that allow trivial social engineering attacks.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure password hints are disabled">
                     <ecl:command>defaults read /Library/Preferences/com.apple.loginwindow RetriesUntilHint

</ecl:command>
                     <ecl:line-selection dt="xs:integer" op="eq" value="0"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable guest account login</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes, cannot remotely login to the system and all created files, caches, and passwords are deleted upon logging out.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling the guest account mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Users</xhtml:em> 
                           <xhtml:em>&amp;</xhtml:em> 
                           <xhtml:em>Groups</xhtml:em> 
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Guest User</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Uncheck <xhtml:em>Allow guests to log in to this computer</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo defaults write /Library/Preferences/com.apple.loginwindow GuestEnabled -bool NO</xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>A guest user can use that access to find out additional information about the system and might be able to use privilege escalation vulnerabilities to establish greater access.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure the guest user is not allowed to log in">
                     <ecl:command>defaults read /Library/Preferences/com.apple.loginwindow.plist</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="GuestEnabled\s*=\s*1"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable "Allow guests to connect to shared folders"</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Not allowing guests to connect to shared folders mitigates the risk of an untrusted user doing basic reconnaissance and possibly use privilege escalation attacks to take control of the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Open <xhtml:em>System Preferences</xhtml:em> 
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Users &amp; Groups</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Select <xhtml:em>Guest User</xhtml:em>
                        </xhtml:li>
                        <xhtml:li>Uncheck <xhtml:em>Allow guests to connect to shared folders</xhtml:em>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>Alternatively:</xhtml:p>
                     <xhtml:p>For AFP sharing:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">sudo defaults write /Library/Preferences/com.apple.AppleFileServer guestAccess -bool no  </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>For SMB sharing:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code>sudo defaults write /Library/Preferences/SystemConfiguration/com.apple.smb.server AllowGuestAccess -bool no<xhtml:span>  </xhtml:span>
                           </xhtml:code>
                        </xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Unauthorized users could access shared files on the system.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure guests cannot access shared folders">
                     <ecl:command>defaults read /Library/Preferences/com.apple.AppleFileServer</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="guestAccess\s*=\s*1"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Remove_Guest_home_folder" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Remove Guest home folder</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>In the previous two controls the guest account login has been disabled and sharing to guests has been disabled as well. There is no need for the legacy Guest home folder to remain in the file system. When normal user accounts are removed you have the option to archive it, leave it in place or delete. In the case of the guest folder the folder remains in place without a GUI option to remove it. If at some point in the future a Guest account is needed it will be re-created. The presence of the Guest home folder can cause automated audits to fail when looking for compliant settings within all User folders as well. Rather than ignoring the folders continued existence it is best removed.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The Guest home folders are unneeded after the Guest account is disabled and could be used inappropriately.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Run the following command in Terminal: <xhtml:code class="code_block">rm -R /Users/Guest </xhtml:code>
                        </xhtml:li>
                        <xhtml:li>Make sure there is no ouput</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>The Guest account should not be necessary after it is disabled and it will be automatically re-created if the Guest account is re-eanbled</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure no guest home folder exists">
                     <ecl:command>ls /Users/ | grep Guest</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pn" value=".+"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Turn on filename extensions</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>A filename extension is a suffix added to a base filename that indicates the base filename's file format.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Visible filename extensions allows the user to identify the file type and the application it is associated with which leads to quick identification of misrepresented malicious files. </xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Select <xhtml:em>Finder</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Preferences</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Check <xhtml:em>Show all filename extensions</xhtml:em>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:div>
                     <xhtml:div class="page">
                        <xhtml:div class="layoutArea">
                           <xhtml:div class="column">
                              <xhtml:p>
                                 <xhtml:span>Alternatively, use the following command: </xhtml:span>
                              </xhtml:p>
                              <xhtml:code>
                                 <xhtml:span>defaults write NSGlobalDomain AppleShowAllExtensions -bool true</xhtml:span>
                              </xhtml:code>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:div>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The user of the system can open files of unknown or unexpected filetypes if the extension is not visible.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure file extensions are displayed">
                  <ecl:command>for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/.GlobalPreferences; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF AppleShowAllExtensions 2&gt;&amp;1 | egrep '(^\d$|not exist)'; fi; done</ecl:command>
                  <ecl:line-selection dt="xs:string" op="pn" value="1$"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Disable the automatic run of safe files in Safari</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Safari will automatically run or execute what it considers safe files. This can include installers and other files that execute on the operating system. Safari bases file safety by using a list of filetypes maintained by Apple. The list of files include text, image, video and archive formats that would be run in the context of the OS rather than the browser.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Hackers have taken advantage of this setting via drive-by attacks. These attacks occur when a user visits a legitimate website that has been corrupted. The user unknowingly downloads a malicious file either by closing an infected pop-up or hovering over a malicious banner. An attacker can create a malicious file that will fall within Safari's safe file list that will download and execute without user input.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:em>Safari</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>Safari </xhtml:em>from the menu bar</xhtml:li>
                     <xhtml:li>Select <xhtml:em>Preferences</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:em>General</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Uncheck <xhtml:em>Open "safe"  files after downloading</xhtml:em>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Alternatively run the following command in Terminal:</xhtml:p>
                  <xhtml:code class="code_block">defaults write com.apple.Safari AutoOpenSafeDownloads -boolean no</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Apple considers many files that the operating system itself auto-executes as "safe files." Many of these files could be malicious and could execute locally without the user even knowing that a file of a specific type had been download.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://cisecurity.org/check">
            <xccdf:check-content>
               <ecl:shell-command check="none exist" comment="Ensure files are not automatically opened by Safari">
                  <ecl:command>for i in $(find /Users -type d -maxdepth 1); do PREF=$i/Library/Preferences/com.apple.Safari; if [ -e $PREF.plist ]; then echo -n "Checking User: '$i': "; defaults read $PREF AutoOpenSafeDownloads 2&gt;&amp;1 | egrep '(^\d$|not exist)'; fi; done </ecl:command>
                  <ecl:line-selection dt="xs:string" op="pn" value="0$"/>
               </ecl:shell-command>
            </xccdf:check-content>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.4_Use_parental_controls_for_systems_that_are_not_centrally_managed" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Use parental controls for systems that are not centrally managed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Many aspects and features of OS X can be restricted on a user-by-user basis via the Parental Controls feature. This includes computer usage time limits, application accessibility limitations, and website restrictions. Although this feature is called Parental Controls, these restrictions may be appropriate for corporate, government, or educational use.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Limiting usage and restricting features for managed users reduces the risk of the user and/or system being exposed to malicious and/or inappropriate content.</xhtml:p>
         </xccdf:rationale>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open <xhtml:span class="inline_block">System Preferences</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">Users &amp; Groups</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Highlight managed user</xhtml:li>
                     <xhtml:li>Check box next to <xhtml:span class="inline_block">Enable parental controls</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Select <xhtml:span class="inline_block">Open Parental Controls</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Select items within the <xhtml:span class="inline_block">Parental Controls </xhtml:span>feature that should be restricted.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The extensive use of parental controls adds to the configuration management burden and can limit legitimate user activity.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_Appendix_Additional_Considerations">
      <xccdf:title xml:lang="en">Appendix: Additional Considerations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>
            <xhtml:span>This section is for guidance on topics for which the Benchmark does not include a prescribed state,  and for security controls that were previously represented in OS X security guides.</xhtml:span>
         </xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1_Wireless_technology_on_OS_X" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Wireless technology on OS X</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Some organizations have comprehensive rules that cover the use of wireless technologies in order to implement operational security. There are specific policies governing the use of both Bluetooth and Wi-Fi (802.11) that often include disabling the wireless capability in either software or hardware or both.</xhtml:p>
            <xhtml:p>Wireless access is part of the feature set required for mobile computers and is considered essential for most users. The general use case for OS X  is to use wireless connectivity, Apple provides a wireless network card and Bluetooth capability in almost every product they make. Bluetooth keyboards are now the default selection where a keyboard is not already integrated into the device.</xhtml:p>
            <xhtml:p> </xhtml:p>
            <xhtml:p>There are instructions on <xhtml:span> </xhtml:span>how to remove parts of the operating system in order to remediate wireless connectivity but they are not recommended within the scope of this Benchmark.</xhtml:p>
            <xhtml:p> </xhtml:p>
            <xhtml:p>https://apple.stackexchange.com/questions/99686/how-to-easily-and-completely-disable-enable-wlan-so-it-cannot-be-turned-on-agai</xhtml:p>
            <xhtml:p>https://apple.stackexchange.com/questions/123326/disable-bluetooth-permanently</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2_iSight_Camera_Privacy_and_Confidentiality_Concerns" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">iSight Camera Privacy and Confidentiality Concerns</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>If the computer is present in an area where there are privacy concerns or sensitive images or actions are taking place the camera should be covered at those times. A permanent cover or alteration may be required when the computer is always located in a confidential area.</xhtml:p>
            <xhtml:p>Malware is continuously discovered that circumvents the privacy controls of the built-in camera. No computer has perfect security and it seems likely that even if all the drivers are disabled or removed that working drivers can be re-introduced by a determined attacker.</xhtml:p>
            <xhtml:p>At this point video chatting and other uses of the built-in camera are standard uses for a computer. It is contrary to a standard use case to permanently remove the camera. In cases where the camera is not allowed to be used at all or when the computer is located in private areas additional precautions are warranted. The General rule should be that if the camera can capture images that could cause embarrassment or an adverse impact the camera should be covered until it is appropriate to use.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.3_Computer_Name_Considerations" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Computer Name Considerations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>If the computer is used in an organization that assigns host names, it is a good idea to change the computer name to the host name. This is more of a best practice than a security measure. If the host name and the computer name are the same, computer support may be able to track problems down more easily.</xhtml:p>
            <xhtml:p>With mobile devices using DHCP IP tracking has serious drawbacks, hostname or computer name tracking makes much more sense for those organizations that can implement it. If the computer is using different names for the "Computer Name" DNS and Directory environments it can be difficult to manage Macs in an Enterprise asset inventory.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.4_Software_Inventory_Considerations" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Software Inventory Considerations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>With the introduction of Mac OS X 10.6.6, Apple added a new application, App Store, which resides in the Applications directory. This application allows a user with admin privileges and an Apple ID to browse Apple's online App Store, purchase (including no cost purchases), and install new applications, bypassing corporate software inventory controls. Any admin user can install software in the /Applications directory whether from internet downloads, thumb drives, optical media, cloud storage or even binaries through email. Even standard users can run executables if permitted. The source of the software is not nearly as important as a consistent audit of all installed software for patch compliance and appropriateness.</xhtml:p>
            <xhtml:p>A single user desktop where the user, administrator and the person approving software are all the same person probably does not need to audit software inventory to this extent. It is helpful in the case of stability problems or malware however.</xhtml:p>
            <xhtml:p>Scan systems on a monthly basis and determine the number of unauthorized pieces of software that are installed. Verify that if an unauthorized piece of software is found one month, it is removed from the system the next.</xhtml:p>
            <xhtml:p>Export Apple System Profiler information through the built-in or other third party tools on an organizationally defined timetable.</xhtml:p>
         </xccdf:description>
         
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.5_Firewall_Consideration" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Firewall Consideration</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>In addition to the Application Layer Firewall (<xhtml:span class="inline_block">alf</xhtml:span>) mentioned in the benchmark, OSX also ships with packet filter, or <xhtml:span class="inline_block">pf</xhtml:span>.  Leveraging <xhtml:span class="inline_block">pf</xhtml:span> is beyond the scope of this Benchmark. For more information, please see:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>https://support.apple.com/kb/ht5519</xhtml:li>
               <xhtml:li>http://blog.scottlowe.org/2013/05/15/using-pf-on-os-x-mountain-lion/</xhtml:li>
            </xhtml:ul>
         </xccdf:description>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Automatic Actions for Optical Media</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>Managing automatic actions, while useful in very few situations, is unlikely to increase security on the computer and does complicate the users experience and add additional complexity to the configuration. These settings are user controlled and can be changed without Administrator privileges unless controlled through MCX settings or Parental Controls. Unlike Windows Auto-run the optical media is accessed through Operating System applications, those same applications can open and access the media directly. If optical media is not allowed in the environment the optical media drive should be disabled in hardware and software</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.7_App_Store_Automatically_download_apps_purchased_on_other_Macs_Considerations" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">App Store Automatically download apps purchased on other Macs Considerations</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>With 10.9 Apple expanded the capability of the App Store to automatically download OS X applications that were purchased in the App Store on another Mac. This feature can be very desirable for personal Macs or in a small business setting so that all purchased software through Apple's App Store is provisioned on all OS X Computers, just like iOS. This feature may not be desirable in Corporate environments where the expectations of handling software licenses, tracking software inventory and personal software are different.</xhtml:p>
            <xhtml:p> </xhtml:p>
            <xhtml:p>Please evaluate your organizations expectations about the use of personal software and software license tracking to align with this setting.</xhtml:p>
            <xhtml:p>For those organizations that are using Enterprise Apple IDs for their employees the reverse is true. If the user has the username and password for their Apple ID and software is being purchased on that account the user could download the software on other computers they have access to.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.8_Extensible_Firmware_Interface_EFI_password" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Extensible Firmware Interface (EFI) password</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>EFI is the software link between the motherboard hardware and the software operating system. EFI determines which partition or disk to load Mac OS X from, it also determines whether the user can enter single-user mode. The main reasons to set a firmware password have been protections against an alternative boot disk, protection against a passwordless root shell through single user mode and protection against firewire DMA attacks. In the past it was not difficult to reset the firmware password by removing RAM but it did make tampering slightly harder and having to remove RAM remediated memory scraping attacks through DMA. It has always been difficult to Manage the firmware password on OS X computers, though some tools did make it much easier.</xhtml:p>
            <xhtml:p>Apple patched OS X in 10.7 to mitigate the DMA attacks and the use of FileVault 2 Full-Disk Encryption mitigates the risk of damage to the boot volume if an unauthorized user uses a different boot volume or uses Single User Mode. Apple's reliance on the recovery partition and the additional features it provides make controls that do not allow the user to boot into the recovery partition less attractive.</xhtml:p>
            <xhtml:p>Starting in Late 2010 with the MacBook Air Apple has slowly updated the requirements to recover from a lost firmware password. Apple only supports taking the computer to an Apple authorized service provider. This change makes managing the firmware password effectively more critical if it is used. </xhtml:p>
            <xhtml:p>Setting the firmware password may be good practice in some environments. We cannot recommend it as a standard security practice at this time.</xhtml:p>
            <xhtml:p>http://support.apple.com/kb/ts3554</xhtml:p>
            <xhtml:p>https://jamfnation.jamfsoftware.com/article.html?id=58</xhtml:p>
            <xhtml:p>http://derflounder.wordpress.com/2012/02/05/protecting-yourself-against-firewire-dma-attacks-on-10-7-x/</xhtml:p>
            <xhtml:p>http://derflounder.wordpress.com/2013/04/26/booting-into-single-user-mode-on-a-filevault-2-encrypted-mac/</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.9_Apple_ID_password_reset" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Apple ID password reset</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Apple has a service that will allow a user that has turned it on to reset their login password by signing in to Apple with their Apple ID. This sounds like a service that needs to be explicitly turned off in an Enterprise environment. There are however many factors here.</xhtml:p>
            <xhtml:ul>
               <xhtml:li>You cannot reset your password if the computer is using FileVault</xhtml:li>
               <xhtml:li>You cannot reset anything but a local account</xhtml:li>
               <xhtml:li>You need physical access to the computer on a network that can phone home to Apple</xhtml:li>
               <xhtml:li>The current login keychain will have to be discarded unless the user remembers the old password</xhtml:li>
            </xhtml:ul>
            <xhtml:p>The main use case I see for disabling this service is where you are not using FileVault to encrypt the Mac but are using Firmware controls to limit boot options with local accounts. Otherwise the user has other options for resetting a password that are more time consuming but just as effective when they have physical access to the computer.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>JN/JNngXOEuBtSBUFPAjUUwp9Zc=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
rwrDh0snDlNm/rdzGBp10DS/3cEoq9Cum8l4VjQeWTn8YqqflfwpazofyQJb68QYRIS3mgaqOeQs
yoemYAkeVneLZMtBhp8pOnKGqk6JOUw0Pp53FsRHeT0RlAg4D2+y/Phj3KZrPMMyqmfQbj9+w/pp
WBmvMbXY0u4bPtKizm61Hl889Yy4JJCn6QXCm/PxmlEm8Ln86iAozKS5v8hMZbtXxyCVaOZYLpO3
28CkROEtIGu9B+YBdtmeR5+xdJPrF5WKxDCoDYAuiEbZydnIiqAAfRj6Ga6KoT6XTUHghRKFFIQN
W/haYMcP2Gg5rw3TZLtyTkYPyZuVC3HubUTnJA==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFRzCCBC+gAwIBAgIHTwpN/4tOfDANBgkqhkiG9w0BAQsFADCBtDELMAkGA1UEBhMCVVMxEDAO
BgNVBAgTB0FyaXpvbmExEzARBgNVBAcTClNjb3R0c2RhbGUxGjAYBgNVBAoTEUdvRGFkZHkuY29t
LCBJbmMuMS0wKwYDVQQLEyRodHRwOi8vY2VydHMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8xMzAx
BgNVBAMTKkdvIERhZGR5IFNlY3VyZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkgLSBHMjAeFw0xNDA5
MTgxNDM0MjFaFw0xNzEwMjAxODU3NDRaMIGTMQswCQYDVQQGEwJVUzERMA8GA1UECBMITmV3IFlv
cmsxFzAVBgNVBAcTDkVhc3QgR3JlZW5idXNoMSswKQYDVQQKEyJDZW50ZXIgZm9yIEludGVybmV0
IFNlY3VyaXR5LCBJbmMuMSswKQYDVQQDEyJDZW50ZXIgZm9yIEludGVybmV0IFNlY3VyaXR5LCBJ
bmMuMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0MGnj6yX2QHklGadAfTBxssvP+2f
YegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzNgOhQx3HcclRwQB4xj/14hOoZSeQ3
haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WYFpSRjZ/Z7m5QKii0feJPxbf+wrZ+
UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKcUY2d3WZ4Zk+zawFcRUYslVIrOhMb
0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7enWCRfZrRWAlDHFaouLdtU/OmXc+
Um7cLwz8VQIDAQABo4IBezCCAXcwDAYDVR0TAQH/BAIwADATBgNVHSUEDDAKBggrBgEFBQcDAzAO
BgNVHQ8BAf8EBAMCB4AwNQYDVR0fBC4wLDAqoCigJoYkaHR0cDovL2NybC5nb2RhZGR5LmNvbS9n
ZGlnMnM1LTAuY3JsMFMGA1UdIARMMEowSAYLYIZIAYb9bQEHFwIwOTA3BggrBgEFBQcCARYraHR0
cDovL2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5LzB2BggrBgEFBQcBAQRqMGgw
JAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmdvZGFkZHkuY29tLzBABggrBgEFBQcwAoY0aHR0cDov
L2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5L2dkaWcyLmNydDAfBgNVHSMEGDAW
gBRAwr0njsw0gzCiM9f7bLPwtCyAzjAdBgNVHQ4EFgQU+3zn+CEg6a2xPqlBXvn64hUyoB4wDQYJ
KoZIhvcNAQELBQADggEBAEh76h1GtJ0pj04in+RUymB7fqPh6HFILkOLlTPnveyXCoHYT2M46DET
EA/NKYkoF2KA3QiZ1b+PMViuTYG2pDs71eFVPADuBCGf9IFufCDY9mPvjQiFDlLNMknXxACD8TjC
hqz+uZT2uLPw/YxkJIsCxrTQJ//ga/fHfZDrKgQfbVzxjD/4WKDe8HktjKcn+NWGPJNMgmO+IHrK
if6TB1xTo32W9QzwoXvBdLnziAUGZZghEulq6h3RCMzKPzpx5JiLlOz6JzqXHvrua+yUbr4A29Vy
vkwWgJWjyvJd2uq9MQ9l49kkrD84m41PSwpaHO99nEHRgRykopxIt8AHsIQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>