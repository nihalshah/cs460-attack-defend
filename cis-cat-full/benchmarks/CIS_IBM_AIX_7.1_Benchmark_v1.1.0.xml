<?xml version="1.0" encoding="UTF-8" standalone="no"?><xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1" xmlns="http://checklists.nist.gov/xccdf/1.1" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:ecl="http://cisecurity.org/check" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.1.0_CIS_IBM_AIX_7.1_Benchmark" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 ../misc/xsd/xccdf-1.1.xsd http://cisecurity.org/check ../misc/xsd/ecl.xsd">
   <xccdf:status date="2013-09-20">accepted</xccdf:status>
   <xccdf:title xml:lang="en">CIS IBM AIX 7.1 Benchmark</xccdf:title>
   <xccdf:description xml:lang="en">
      <xhtml:p>This benchmark was created using a consensus review process comprised of volunteer and contract subject matter experts. Consensus participants provide perspective from a diverse set of backgrounds including consulting, software development, audit and compliance, security research, operations, government, and legal.</xhtml:p>
      <xhtml:p> </xhtml:p>
      <xhtml:p>Each CIS benchmark undergoes two phases of consensus review. The first phase occurs during initial benchmark development. During this phase, subject matter experts convene to discuss, create, and test working drafts of the benchmark. This discussion occurs until consensus has been reached on benchmark recommendations. The second phase begins after the benchmark has been released to the public Internet. During this phase, all feedback provided by the Internet community is reviewed by the consensus team for incorporation in to the CIS benchmark. If you are interested in participating in the consensus review process, please send us a note to <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>.</xhtml:p>
   </xccdf:description>
   <xccdf:notice id="terms-of-use" xml:lang="en"> BACKGROUND. The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide. Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature. The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices. Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements. The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs. NO REPRESENTATIONS, WARRANTIES, OR COVENANTS. CIS makes no representations, warranties, or covenants whatsoever as to (i)
      the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of the Products or the Recommendations. CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind. USER AGREEMENTS. By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that: 1. No network, system, device, hardware, software, or component can be made fully secure; 2. We are using the Products and the Recommendations solely at our own risk; 3. We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from CIS's negligence or failure to perform; 4. We have the sole responsibility to
      evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the Recommendations to our particular circumstances and requirements; 5. Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of the need for any such corrections, updates, upgrades, or bug fixes; and 6. Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way
      Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, viruses, worms, backdoors, Trojan horses or other harmful items. GRANT OF LIMITED RIGHTS. CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use: 1. Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and use each of the Products on a single computer; 2. Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use
      in its entirety. RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION. The Products are protected by copyright and other intellectual property laws and by international treaties. We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties. CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights." Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute,
      redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their
      functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product. We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph. We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter
      subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim. We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use. SPECIAL RULES. CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship. Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules. CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means. Each such Member acknowledges and agrees that the
      foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time. CHOICE OF LAW; JURISDICTION; VENUE. We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action. If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions. BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO
      BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>

   <xccdf:version>1.1.0</xccdf:version>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
      <xccdf:title xml:lang="en">Level 1</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Level-I Benchmark recommendations are intended to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be practical and prudent,</xhtml:li>
            <xhtml:li>provide a clear security benefit</xhtml:li>
            <xhtml:li>do not inhibit the utility of the technology beyond acceptable means</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_etcsecurityuser_-_mindiff" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2_etcsecurityuser_-_minage" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3_etcsecurityuser_-_maxage" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4_etcsecurityuser_-_minlen" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.5_etcsecurityuser_-_minalpha" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.6_etcsecurityuser_-_minother" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.7_etcsecurityuser_-_maxrepeats" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.8_etcsecurityuser_-_histexpire" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.9_etcsecurityuser_-_histsize" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.15_etcsecuritylogin.cfg_-_pwd_algorithm" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.10_etcsecurityuser_-_maxexpired" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_etcsecuritylogin.cfg_-_logininterval" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.3_etcsecuritylogin.cfg_-_logindisable" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.4_etcsecuritylogin.cfg_-_loginreenable" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.5_etcsecuritylogin.cfg_-_logintimeout" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.6_etcsecuritylogin.cfg_-_logindelay" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.7_etcsecurityuser_-_loginretries" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.8_etcsecurityuser_-_rlogin" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.9_etcsecurityuser_-_sugroups" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.24_etcinetd.conf_-_telnet" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.25_etcinetd.conf_-_exec" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.26_etcinetd.conf_-_daytime" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.27_etcinetd.conf_-_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.32_etcinetd.conf_-_login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.35_etcinetd.conf_-_ftp" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.36_etcinetd.conf_-_chargen" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.37_etcinetd.conf_-_discard" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.39_etcinetd.conf_-_echo" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.44_etcinetd.conf_-_sprayd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.51_etcinetd.conf_-_finger" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.53_etcinetd.conf_-_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.3_Miscellaneous_Enhancements_-_etcftpusers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.4_Miscellaneous_Enhancements_-_login_herald" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.5_Miscellaneous_Enhancements_-_guest_account_removal" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.6_Miscellaneous_Enhancements_-_crontab_permissions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Configuring_SSH_-_disabling_direct_root_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Configuring_SSH_-_server_protocol_2" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Configuring_SSH_-_client_protocol_2" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Configuring_SSH_-_banner_configuration" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Configuring_SSH_-_ignore_.shosts_and_.rhosts" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Configuring_SSH_-_disable_null_passwords" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Configuring_SSH_-_set_privilege_separation" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.18_Configuring_SSH_-_sshd_config_permissions_lockdown" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.19_Configuring_SSH_-_ssh_config_permissions_lockdown" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.1_etcmailsendmail.cf_-_SmtpGreetingMessage" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.2_etcmailsendmail.cf_-_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.3_varspoolmqueue_-_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.3_CDE_-_sgidsuid_binary_lockdown" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.5_CDE_-_screensaver_lock" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.7_CDE_-_etcdtconfigXconfig_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.8_CDE_-_etcdtconfigXservers_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.6_CDE_-_login_screen_hostname_masking" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.9_CDE_-_etcdtconfigXresources_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.3_NFS_-_nosuid_on_NFS_client_mounts" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.4_NFS_-_localhost_removal" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.6_NFS_-_no_root_squash_option" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10.2_TCP_Wrappers_-_creating_a_hosts.deny_file" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10.3_TCP_Wrappers_-_creating_a_hosts.allow_file" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.1_Permissions_and_Ownership_-_etcsecurity" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.2_Permissions_and_Ownership_-_etcgroup" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.3_Permissions_and_Ownership_-_etcpasswd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.4_Permissions_and_Ownership_-_etcsecurityaudit" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.5_Permissions_and_Ownership_-_audit" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.6_Permissions_and_Ownership_-_smit.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.7_Permissions_and_Ownership_-_varadmcronlog" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.8_Permissions_and_Ownership_-_varspoolcroncrontabs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.9_Permissions_and_Ownership_-_varadmcronat.allow" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.10_Permissions_and_Ownership_-_varadmcroncron.allow" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.11_Permissions_and_Ownership_-_etcmotd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.12_Permissions_and_Ownership_-_varadmras" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.13_Permissions_and_Ownership_-_varctRMstart.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.14_Permissions_and_Ownership_-_vartmpdpid2.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.15_Permissions_and_Ownership_-_vartmphostmibd.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.16_Permissions_and_Ownership_-_vartmpsnmpd.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.17_Permissions_and_Ownership_-_varadmsa" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.20_Permissions_and_Ownership_-_worldgroup_writable_directory_in_root_PATH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.18_Permissions_and_Ownership_-_home_directory_configuration_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.19_Permissions_and_Ownership_-_home_directory_permissions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.10_Miscellaneous_Config_-_ftp_umask" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.11_Miscellaneous_Config_-_ftp_banner" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.12_Miscellaneous_Config_-_etcmotd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.13_Miscellaneous_Config_-_authorized_users_in_at.allow_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.14_Miscellaneous_Config_-_authorized_users_in_cron.allow" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.15_Miscellaneous_Config_-_all_unlocked_accounts_must_have_a_password_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.16_Miscellaneous_Config_-_all_user_id_must_be_unique_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.17_Miscellaneous_Config_-_all_group_id_must_be_unique" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.18_Miscellaneous_Config_-_unnecessary_user_and_group_removal" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.19_Miscellaneous_Config_-_removing_current_working_directory_from_roots_PATH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.20_Miscellaneous_Config_-_removing_current_working_directory_from_default_etcenvironment_PATH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.11_etcsecurityuser_-_minloweralpha_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.12_etcsecurityuser_-_minupperalpha_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.13_etcsecurityuser_-_mindigit" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.14_etcsecurityuser_-_minspecialchar_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.12_Configuring_SSH_-_set_LogLevel_to_INFO" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.13_Configuring_SSH_-_set_MaxAuthTries_to_4_or_Less" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.14_Configuring_SSH_-_set_Idle_Timeout_Interval_for_User_Login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.15_Configuring_SSH_-_restrict_Cipher_list" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.16_Configuring_SSH_-_ignore_user-provided_environment_variables" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.17_Configuring_SSH_-_limit_access_via_SSH" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
      <xccdf:title xml:lang="en">Level 2</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Level-II Benchmark recommendations exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
            <xhtml:li>acts as defense in depth measure</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_etcsecurityuser_-_mindiff" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2_etcsecurityuser_-_minage" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3_etcsecurityuser_-_maxage" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4_etcsecurityuser_-_minlen" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.5_etcsecurityuser_-_minalpha" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.6_etcsecurityuser_-_minother" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.7_etcsecurityuser_-_maxrepeats" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.8_etcsecurityuser_-_histexpire" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.9_etcsecurityuser_-_histsize" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.15_etcsecuritylogin.cfg_-_pwd_algorithm" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.10_etcsecurityuser_-_maxexpired" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_etcsecuritylogin.cfg_-_logininterval" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.3_etcsecuritylogin.cfg_-_logindisable" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.4_etcsecuritylogin.cfg_-_loginreenable" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.5_etcsecuritylogin.cfg_-_logintimeout" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.6_etcsecuritylogin.cfg_-_logindelay" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.7_etcsecurityuser_-_loginretries" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.8_etcsecurityuser_-_rlogin" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.9_etcsecurityuser_-_sugroups" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.24_etcinetd.conf_-_telnet" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.25_etcinetd.conf_-_exec" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.26_etcinetd.conf_-_daytime" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.27_etcinetd.conf_-_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.32_etcinetd.conf_-_login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.35_etcinetd.conf_-_ftp" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.36_etcinetd.conf_-_chargen" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.37_etcinetd.conf_-_discard" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.39_etcinetd.conf_-_echo" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.44_etcinetd.conf_-_sprayd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.51_etcinetd.conf_-_finger" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.53_etcinetd.conf_-_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.3_Miscellaneous_Enhancements_-_etcftpusers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.4_Miscellaneous_Enhancements_-_login_herald" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.5_Miscellaneous_Enhancements_-_guest_account_removal" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.6_Miscellaneous_Enhancements_-_crontab_permissions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Configuring_SSH_-_disabling_direct_root_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Configuring_SSH_-_server_protocol_2" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Configuring_SSH_-_client_protocol_2" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Configuring_SSH_-_banner_configuration" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Configuring_SSH_-_ignore_.shosts_and_.rhosts" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Configuring_SSH_-_disable_null_passwords" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Configuring_SSH_-_set_privilege_separation" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.18_Configuring_SSH_-_sshd_config_permissions_lockdown" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.19_Configuring_SSH_-_ssh_config_permissions_lockdown" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.1_etcmailsendmail.cf_-_SmtpGreetingMessage" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.2_etcmailsendmail.cf_-_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.3_varspoolmqueue_-_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.3_CDE_-_sgidsuid_binary_lockdown" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.5_CDE_-_screensaver_lock" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.7_CDE_-_etcdtconfigXconfig_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.8_CDE_-_etcdtconfigXservers_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.6_CDE_-_login_screen_hostname_masking" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.9_CDE_-_etcdtconfigXresources_permissions_and_ownership" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.3_NFS_-_nosuid_on_NFS_client_mounts" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.4_NFS_-_localhost_removal" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.6_NFS_-_no_root_squash_option" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10.2_TCP_Wrappers_-_creating_a_hosts.deny_file" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10.3_TCP_Wrappers_-_creating_a_hosts.allow_file" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.1_Permissions_and_Ownership_-_etcsecurity" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.2_Permissions_and_Ownership_-_etcgroup" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.3_Permissions_and_Ownership_-_etcpasswd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.4_Permissions_and_Ownership_-_etcsecurityaudit" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.5_Permissions_and_Ownership_-_audit" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.6_Permissions_and_Ownership_-_smit.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.7_Permissions_and_Ownership_-_varadmcronlog" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.8_Permissions_and_Ownership_-_varspoolcroncrontabs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.9_Permissions_and_Ownership_-_varadmcronat.allow" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.10_Permissions_and_Ownership_-_varadmcroncron.allow" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.11_Permissions_and_Ownership_-_etcmotd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.12_Permissions_and_Ownership_-_varadmras" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.13_Permissions_and_Ownership_-_varctRMstart.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.14_Permissions_and_Ownership_-_vartmpdpid2.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.15_Permissions_and_Ownership_-_vartmphostmibd.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.16_Permissions_and_Ownership_-_vartmpsnmpd.log" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.17_Permissions_and_Ownership_-_varadmsa" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.20_Permissions_and_Ownership_-_worldgroup_writable_directory_in_root_PATH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.18_Permissions_and_Ownership_-_home_directory_configuration_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11.19_Permissions_and_Ownership_-_home_directory_permissions" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.10_Miscellaneous_Config_-_ftp_umask" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.11_Miscellaneous_Config_-_ftp_banner" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.12_Miscellaneous_Config_-_etcmotd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.13_Miscellaneous_Config_-_authorized_users_in_at.allow_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.14_Miscellaneous_Config_-_authorized_users_in_cron.allow" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.15_Miscellaneous_Config_-_all_unlocked_accounts_must_have_a_password_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.16_Miscellaneous_Config_-_all_user_id_must_be_unique_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.17_Miscellaneous_Config_-_all_group_id_must_be_unique" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.18_Miscellaneous_Config_-_unnecessary_user_and_group_removal" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.19_Miscellaneous_Config_-_removing_current_working_directory_from_roots_PATH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.20_Miscellaneous_Config_-_removing_current_working_directory_from_default_etcenvironment_PATH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.11_etcsecurityuser_-_minloweralpha_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.12_etcsecurityuser_-_minupperalpha_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.13_etcsecurityuser_-_mindigit" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.14_etcsecurityuser_-_minspecialchar_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.12_Configuring_SSH_-_set_LogLevel_to_INFO" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.13_Configuring_SSH_-_set_MaxAuthTries_to_4_or_Less" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.14_Configuring_SSH_-_set_Idle_Timeout_Interval_for_User_Login" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.15_Configuring_SSH_-_restrict_Cipher_list" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.16_Configuring_SSH_-_ignore_user-provided_environment_variables" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.17_Configuring_SSH_-_limit_access_via_SSH" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.1_etcinittab_-_qdaemon" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.2_etcinittab_-_lpd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.3_etcinittab_-_piobe" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.4_etcinittab_-_dt" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.1_system_account_lockdown_-_daemon" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.2_system_account_lockdown_-_bin" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.3_system_account_lockdown_-_sys" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.4_system_account_lockdown_-_adm" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.6_system_account_lockdown_-_uucp" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.5_system_account_lockdown_-_nobody" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1.7_system_account_lockdown_-_lpd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.5_etcinittab_-_rcnfs" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.6_etcrc.tcpip_-_sendmail" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.7_etcrc.tcpip_-_snmpd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.8_etcrc.tcpip_-_dhcpcd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.9_etcrc.tcpip_-_dhcprd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.10_etcrc.tcpip_-_dhcpsd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.11_etcrc.tcpip_-_autoconf6" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.12_etcrc.tcpip_-_gated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.13_etcrc.tcpip_-_mrouted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.14_etcrc.tcpip_-_named" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.15_etcrc.tcpip_-_routed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.16_etcrc.tcpip_-_rwhod" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.17_etcrc.tcpip_-_timed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.18_etcrc.tcpip_-_dpid2" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.19_etcrc.tcpip_-_hostmibd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.20_etcrc.tcpip_-_snmpmibd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.21_etcrc.tcpip_-_aixmibd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.22_etcrc.tcpip_-_ndpd-host" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.23_etcrc.tcpip_-_ndpd-router" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.28_etcinetd.conf_-_cmsd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.29_etcinetd.conf_-_ttdbserver" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.30_etcinetd.conf_-_uucp" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.31_etcinetd.conf_-_time" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.33_etcinetd.conf_-_talk" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.34_etcinetd.conf_-_ntalk" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.38_etcinetd.conf_-_dtspc" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.40_etcinetd.conf_-_pcnfsd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.41_etcinetd.conf_-_rstatd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.42_etcinetd.conf_-_rusersd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.43_etcinetd.conf_-_rwalld" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.45_etcinetd.conf_-_klogin" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.46_etcinetd.conf_-_kshell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.47_etcinetd.conf_-_rquotad" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.48_etcinetd.conf_-_tftp" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.49_etcinetd.conf_-_imap2" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.50_etcinetd.conf_-_pop3" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3.52_etcinetd.conf_-_instsrv" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4.1_Remote_command_lockdown" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4.2_Remote_daemon_lockdown" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5.1_Removal_of_.rhosts_and_.netrc_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5.2_Removal_of_entries_from_etchosts.equiv" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.1_TCPIP_Tuning_-_ipsrcrouteforward" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.2_TCPIP_Tuning_-_ipignoreredirects" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.4_TCPIP_Tuning_-_ipsrcroutesend" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.5_TCPIP_Tuning_-_ipforwarding" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.6_TCPIP_Tuning_-_ipsendredirects" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.7_TCPIP_Tuning_-_ip6srcrouteforward" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.8_TCPIP_Tuning_-_directed_broadcast" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.9_TCPIP_Tuning_-_tcp_pmtu_discover" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.10_TCPIP_Tuning_-_bcastping" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.11_TCPIP_Tuning_-_icmpaddressmask" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.12_TCPIP_Tuning_-_udp_pmtu_discover" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.13_TCPIP_Tuning_-_ipsrcrouterecv" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.14_TCPIP_Tuning_-_nonlocsrcroute" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.15_TCPIP_Tuning_-_tcp_tcpsecure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.3_TCPIP_Tuning_-_clean_partial_conns" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.16_TCPIP_Tuning_-_sockthresh" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.17_TCPIP_Tuning_-_rfc1323" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.18_TCPIP_Tuning_-_tcp_sendspace" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.19_TCPIP_Tuning_-_tcp_recvspace" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.20_TCPIP_Tuning_-_tcp_mssdflt" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6.21_TCPIP_Tuning_-_nfs_use_reserved_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.1_Miscellaneous_Enhancements_-_crontab_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.2_Miscellaneous_Enhancements_-_at_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.7_Miscellaneous_Enhancements_-_default_umask" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.8_Miscellaneous_Enhancements_-_disabling_core_dumps" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7.9_Miscellaneous_Enhancements_-_AIX_Auditing" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Configuring_syslog_-_local_logging" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Configuring_syslog_-_remote_logging" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Configuring_syslog_-_remote_messages" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Configuring_SSH_-_installation" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Configuring_SSH_-_disallow_host_based_authentication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.10_Configuring_SSH_-_removal_of_.shosts_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.11_Configuring_SSH_-_removal_of_etcshosts.equiv" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.1_CDE_-_de-installing_CDE" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.2_CDE_-_disabling_dtlogin" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.4_CDE_-_remote_GUI_login_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.1_NFS_-_de-install_NFS_client" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.5_NFS_-_restrict_NFS_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.7_NFS_-_secure_NFS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.1_NIS_-_de-install_NIS_client" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.2_NIS_-_de-install_NIS_server" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.3_NIS_-_remove_NIS_markers_from_password_and_group_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.4_NIS_-_restrict_NIS_server_communication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7.1_SNMP_-_disable_private_community_string" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7.2_SNMP_-_disable_system_community_string" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7.3_SNMP_-_disable_public_community_string" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7.5_SNMP_-_restrict_community_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7.4_SNMP_-_disable_Readwrite_community_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.8.1_inetd_-_disabling_inetd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.9.1_etcrc.tcpip_-_portmap" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10.1_TCP_Wrappers_-_installing_TCP_Wrappers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10.4_TCP_Wrappers_-_wrapping_inetd_services" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.1_Miscellaneous_Config_-_serial_port_restriction" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.2_Miscellaneous_Config_-_disable_i4ls" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.3_Miscellaneous_Config_-_disable_NCS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.4_Miscellaneous_Config_-_disable_httpdlite" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.5_Miscellaneous_Config_-_disable_pmd" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.6_Miscellaneous_Config_-_disable_writesrv" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.7_Miscellaneous_Config_-_block_talkwrite" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.8_Miscellaneous_Config_-_enable_sar_accounting" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.12.9_Miscellaneous_Config_-_etcftpusers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.14.1_PCM_-_sudo" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.14.2_PCM_-_enhanced_RBAC" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.13.1_EFS_-_implementation" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.15.1_TE_-_implementation_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.16.1_General_Permissions_Management_-_suid_and_sgid_files_and_programs_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.16.2_General_Permissions_Management_-_un-owned_files_and_directories_" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.16.3_General_Permissions_Management_-_world_writable_files_and_directories" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.2_NFS_-_de-install_NFS_server" selected="true"/>
   </xccdf:Profile>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Introduction">
      <xccdf:title xml:lang="en">Introduction</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This bechmark provides security configuration guidance for use during the configuration of the AIX 7.1 Operating System. The scope of the guide is applicable to AIX 7.1 TL-0 SP1 and above. The recommendations in this guide have been explicitly tested on AIX 7.1 TL-0 SP1 and AIX 7.1 TL-01.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.1_Approach">
         <xccdf:title xml:lang="en">Approach</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The suggested approach in terms of implementing this guide would be to install a vanilla AIX image, via NIM or the AIX product DVD's, followed by the recommendations detailed in this guide and any other corporate standardization i.e. software installation, filesystem and user creation. Once completed, a mksysb backup of the system could then be taken and this image could be deployed via NIM for any subsequent operating system builds. This would provide a standard build mechanism, ensuring 100% compliance to all company standards and the best practice recommendations detailed in this benchmark.</xhtml:p>
            <xhtml:p>Within the AIX Base Operating System Installation Menus it is recommended that the following options are selected:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>JFS2 filesystems</xhtml:li>
               <xhtml:li>Enable System Backups to install any system = yes *</xhtml:li>
            </xhtml:ul>
            <xhtml:p>* This is to ensure that all device drivers are installed into the operating system image for deploying to different server hardware configurations.</xhtml:p>
            <xhtml:p>Also consider selecting the following option (dependant on environmental requirements as this may be too restrictive):</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Secure By Default = yes *</xhtml:li>
            </xhtml:ul>
            <xhtml:p>* This option performs a minimal software installation, and removes all clear password access such as <xhtml:span class="inline_block">telnet</xhtml:span> and <xhtml:span class="inline_block">rlogin</xhtml:span>. Secure by Default (SbD) also applies the <xhtml:span class="ph">AIX Security Expert</xhtml:span> high-security settings. Once installed the expansion pack cd is prompted for as SSH and SSL are installed for secure remote system accessibility. If the SbD installation option is selected through NIM, the system administrator should ensure that the relevant NIM <xhtml:span class="inline_block">lpp_source</xhtml:span> has the <xhtml:span class="inline_block">openssh </xhtml:span>and <xhtml:span class="inline_block">openssl </xhtml:span>images in place.</xhtml:p>
         </xccdf:description>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.2_Maintenance_Cadence">
         <xccdf:title xml:lang="en">Maintenance Cadence</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Before entering into the recommendation section of this paper it is important to put into context the relevance of an AIX software maintenance strategy. It is imperative that regular Technology Level (TL) and Service Pack (SP) updates are regularly applied, to ensure that all known security vulnerabilities are addressed and to remain within a supported TL stream.</xhtml:p>
            <xhtml:p>The current IBM software maintenance strategy revolves around the release of Technology Levels and Service Packs. Technology Levels are released twice per year, one in the spring and the other in fall. They introduce support for new hardware, new functionality, and new features and contain cumulative fixes since the release of the previous TL. The fix support window for a given TL is two years from its release date.</xhtml:p>
            <xhtml:p>Service Packs are released throughout the lifecycle of the TL and address security vulnerabilities and other critical fixes. They are typically released every 12 weeks; obviously this timeframe is dependant on the number and criticality of the issues found.</xhtml:p>
            <xhtml:p>It is recommended that full TL's or SP's are applied rather than individual fixes, due to the far more rigorous certification and testing process. The large and complex matrix of possible fix combinations are not subjected to the same degree of testing and therefore installing individual fixes is not recommended.</xhtml:p>
            <xhtml:p>A security fix will be initially released as an interim fix, which is installed and maintained via the <xhtml:span class="inline_block">emgr </xhtml:span>framework. It is recommended that, unless it is an extremely critical security issue, to wait and apply the fix as part of a full SP release to ensure maximum system stability.</xhtml:p>
         </xccdf:description>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.2.1_Summary">
            <xccdf:title xml:lang="en">Summary</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The recommended maintenance strategy is as follows:-</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>Stay current and refresh the TL of each system at least once a year - For maximum system stability wait until SP3 is released on the newer TL and then migrate</xhtml:li>
                  <xhtml:li>Review the Service Packs for any security or critical fixes - apply these regularly throughout the life cycle of a TL</xhtml:li>
                  <xhtml:li>Do not apply interim fixes or individual fixes unless there is an urgent requirement to do so. Instead apply full TL's and SP's for maximum stability</xhtml:li>
                  <xhtml:li>There should be a monthly review of the security advisory bulletins to remain apprised of all known security issues. These can currently be viewed at the following URL:</xhtml:li>
               </xhtml:ul>
               <xhtml:p>
                  <xhtml:a href="http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd">http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd</xhtml:a>
               </xhtml:p>
               <xhtml:ul>
                  <xhtml:li>The security fixes published in the vulnerability advisories are posted here for download:</xhtml:li>
               </xhtml:ul>
               <xhtml:p>
                  <xhtml:a href="ftp://aix.software.ibm.com/aix/efixes/security">ftp://aix.software.ibm.com/aix/efixes/security</xhtml:a>
               </xhtml:p>
               <xhtml:ul>
                  <xhtml:li>When any new AIX operating system images are deployed, review the latest available TL and SP releases and update where required. The information regarding the latest fixes can be gleaned from the IBM Fix Central website:</xhtml:li>
               </xhtml:ul>
               <xhtml:p>
                  <xhtml:a href="http://www-933.ibm.com/support/fixcentral/">http://www-933.ibm.com/support/fixcentral/</xhtml:a>
               </xhtml:p>
               <xhtml:ul>
                  <xhtml:li>Further details on the IBM recommended maintenance strategies can be found in the "IBM AIX Operating System Service Strategy Details and Best Practices" guide:</xhtml:li>
               </xhtml:ul>
               <xhtml:p>
                  <xhtml:a href="http://www14.software.ibm.com/webapp/set2/sas/f/best/home.html">http://www14.software.ibm.com/webapp/set2/sas/f/best/home.html</xhtml:a>
               </xhtml:p>
            </xccdf:description>
         </xccdf:Group>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_AIX_Security_Expert_Introduction">
      <xccdf:title xml:lang="en">AIX Security Expert Introduction</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section will focus on the AIX Security Expert framework. The tool has been introduced to standardize and simplify the security hardening process in AIX, with over 300 settings and commands within its scope. It can be used to replace in-house security scripts and procedures.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Security_Levels">
         <xccdf:title xml:lang="en">Security Levels</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>There are three standard security levels, other than default, and the ability to create a customized hybrid policy.</xhtml:p>
         </xccdf:description>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1.1_Low_Level_Security">
            <xccdf:title xml:lang="en">Low Level Security</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This policy implements common non-disruptive security enhancements.</xhtml:p>
               <xhtml:p>Typically this is suited to servers residing in an internal and secure local network environment. It provides a basic security lockdown, from a minimal default level.</xhtml:p>
            </xccdf:description>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1.2_Medium_Level_Security">
            <xccdf:title xml:lang="en">Medium Level Security</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This policy implements more advanced hardening parameters than the Low Level. These include: port scan protection and an enhanced password management policy. This security level does allow clear text password protocol access, e.g. <xhtml:span class="inline_block">ftp</xhtml:span>, <xhtml:span class="inline_block">rlogin</xhtml:span>, and <xhtml:span class="inline_block">telnet</xhtml:span>.</xhtml:p>
               <xhtml:p>Typically, this is suited to servers residing in a corporate network protected by a firewall.</xhtml:p>
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;"> </xhtml:p>
            </xccdf:description>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1.3_High_Level_Security">
            <xccdf:title xml:lang="en">High Level Security</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This policy implements the highest possible security hardening standards. These include: port scan protection and no access for any clear text password protocols. It assumes that the local network is not trusted and is potentially unsafe.</xhtml:p>
               <xhtml:p>Typically, this is suited to servers residing in an unsafe network. For example, those which are internet facing.</xhtml:p>
               <xhtml:p>Within modern IT infrastructure, internal firewalls are typically implemented to separate the internal network from any corporate or internet environments and external firewalls to further protect these environments from the outside world. These firewall devices are typically only configured to allow access to the systems on the required core application or database ports. Therefore, port shunning and scan protection are typically something implemented by a firewall, rather than at the operating system level.</xhtml:p>
            </xccdf:description>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1.4_Custom_Level_Security">
            <xccdf:title xml:lang="en">Custom Level Security</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The approach of this benchmark is to implement a hybrid policy, which contains a combination of recommended settings from both the Medium and High Level default policies. A customized XML file provides the ultimate flexibility in terms of being able to choose whether or not to implement every recommended AIX Security Expert controlled setting in this benchmark e.g. whether clear text password protocols are allowed. This policy can be easily modified depending on the environmental requirements. A simple edit of the customized XML file, prior to it being implemented, is all that is required. This flexibility is not present within the default Low, Medium and High Level policies which provide a pre-defined rigid level of security hardening standards.</xhtml:p>
            </xccdf:description>
         </xccdf:Group>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1.5_Implementing_the_Custom_Level_Policy">
            <xccdf:title xml:lang="en">Implementing the Custom Level Policy</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This section details how to automatically implement all of the AIX Security Expert managed settings from this benchmark. The use of the supplied AIX Security Expert Customized XML file is purely optional, as there is remediation guidance provided with each recommendation in this benchmark.</xhtml:p>
               <xhtml:p>The absolute path tar file can be extracted via the following command:</xhtml:p>
               <xhtml:code class="pre_0.7025859480218752">
                  <xhtml:span class="inline_block">tar -xvf <xhtml:span>&lt;PATH to tar file&gt;</xhtml:span>/CIS_IBM_AIX_7.1_Benchmark_v1.0.0_AIXPERT_7.1.tar </xhtml:span>
               </xhtml:code>
               <xhtml:p>
                  <xhtml:br/>This will place the customized XML file into its default location:</xhtml:p>
               <xhtml:code class="pre_0.27844603857936956">
                  <xhtml:span class="inline_block">/etc/security/aixpert/custom/custom_7.1.xml </xhtml:span>
               </xhtml:code>
               <xhtml:p>
                  <xhtml:br/>Prior to implementing the AIX Security Expert customized settings, please review the benchmark recommendations in the next section. If there are any settings that need to be changed from a recommended value, based on environmental requirements, edit the XML file using the <xhtml:span class="inline_block">vi</xhtml:span> command.</xhtml:p>
               <xhtml:p>
                  <xhtml:br/>As much of the guide as possible has been automated within the AIX Security Expert customized XML file. This includes a number of recommendations normally outside the remit of the tool. In these instances the <xhtml:span class="inline_block">execmds </xhtml:span>functionality has been used to execute the appropriate commands and implement the recommendations.</xhtml:p>
               <xhtml:p>Once the recommendations have been reviewed, implementation of the customized XML file should be performed in the following way:</xhtml:p>
               <xhtml:code class="pre_0.7357238037646447">
                  <xhtml:span class="inline_block">aixpert -f /etc/security/aixpert/custom/custom_7.1.xml </xhtml:span>
               </xhtml:code>
               <xhtml:p>
                  <xhtml:br/>Once the XML has been successfully implemented, the applied settings are placed in the following file:</xhtml:p>
               <xhtml:code class="pre_0.4808245643434477">
                  <xhtml:span class="inline_block">cat /etc/security/aixpert/core/appliedaixpert.xml </xhtml:span>
               </xhtml:code>
               <xhtml:p>
                  <xhtml:br/>The values set by the customized XML file can be validated via:</xhtml:p>
               <xhtml:code class="pre_0.936686495399566">
                  <xhtml:span class="inline_block">aixpert -c </xhtml:span>
               </xhtml:code>
               <xhtml:p>
                  <xhtml:br/>This compares the settings, defined in the <xhtml:span class="inline_block">appliedaixpert.xml</xhtml:span> file, to those currently set on the system.<xhtml:br/>If there is deviation from these standards i.e. a setting has been changed, it will be reported in the following log file:</xhtml:p>
               <xhtml:code class="pre_0.33725818980123395">
                  <xhtml:span class="inline_block">cat /etc/security/aixpert/check_report.txt </xhtml:span>
               </xhtml:code>
               <xhtml:p>
                  <xhtml:br/>Any deviations can be corrected manually, or the AIX Security Expert Customized XML file can be re-applied.<xhtml:br/>During the customized XML implementation, the following files are copied prior to being changed:</xhtml:p>
               <xhtml:code class="pre_0.5100735468090667">
                  <xhtml:span class="inline_block">cp -p /etc/inittab /etc/inittab.$date<xhtml:br/>cp -p /etc/rc.tcpip /etc/rc.tcpip.$date<xhtml:br/>cp -p /etc/inetd.conf /etc/inetd.conf.$date </xhtml:span>
               </xhtml:code>
            </xccdf:description>
         </xccdf:Group>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_AIX_Security_Expert_Recommendations">
      <xccdf:title xml:lang="en">AIX Security Expert Recommendations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section provides details of the recommended settings controlled within the AIX Security Expert framework. The settings within this section can all be automatically applied, utilizing the <xhtml:span class="inline_block">aixpert</xhtml:span> command to implement the customized XML file.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1_AIX_Security_Expert_-_Password_Policy">
         <xccdf:title xml:lang="en">AIX Security Expert - Password Policy</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section provides guidance on the configuration of the password policy. This includes recommended length, complexity, reuse and expiration.</xhtml:p>
            <xhtml:p>The recommendations in this section affect the parameters of the default user stanza. The values set are only applicable if specific values are not defined during the creation of a user. It is therefore recommended to not set any of these values explicitly, unless there is a specific requirement to do so when a user is created.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.1_etcsecurityuser_-_mindiff" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - mindiff</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the minimum number of characters that are required in a new password which were not in the old password.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">mindiff </xhtml:span>attribute, it ensures that users are not able to reuse the same or similar passwords.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">mindiff</xhtml:span> attribute to be greater than or equal to <xhtml:span class="inline_block">4:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.18919465808702923">
                           <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a mindiff=4</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>This means that when a user password is set it needs to comprise of at least 4 characters not present in the previous password. </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a mindiff'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is greater than or equal 4
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'mindiff' is set to '4' or greater">
                     <ecl:command>lssec -f /etc/security/user -s default -a mindiff</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="4"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.2_etcsecurityuser_-_minage" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - minage</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the minimum number of weeks before a password can be changed.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">minage</xhtml:span> attribute, it prohibits users changing their password until a set number of weeks have passed.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In<xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">minage</xhtml:span> attribute to <xhtml:span class="inline_block">1:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.18044457447868556">
                           <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a minage=1</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>This means that a user cannot change their password until at least a week after being set.</xhtml:p>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a minage'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'minage' is set to '1'">
                     <ecl:command>lssec -f /etc/security/user -s default -a minage</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.3_etcsecurityuser_-_maxage" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - maxage</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the maximum number of weeks that a password is valid.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">maxage</xhtml:span> attribute, it enforces regular password changes.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">maxage</xhtml:span> attribute to a number greater than <xhtml:span class="inline_block">0</xhtml:span> but less than or equal to <xhtml:span class="inline_block">13:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.7349224619790947">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a maxage=13</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that a user password must be changed 13 weeks after being set . If 0 is set then this effectively disables password ageing. </xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a maxage'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 13
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'maxage' is set to '13'">
                     <ecl:command>lssec -f /etc/security/user -s default -a maxage</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="13"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.4_etcsecurityuser_-_minlen" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - minlen</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the minimum length of a password.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">minlen </xhtml:span>attribute, it ensures that passwords meet the required length criteria.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">minlen</xhtml:span> attribute to be greater than or equal to <xhtml:span class="inline_block">8:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.16463877444611224">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a minlen=8</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that all user passwords must be at least 8 characters in length.</xhtml:p>
                     <xhtml:p>NOTE: If a password length greater than 8 is required, an enhanced password hashing algorithm must be selected. The default crypt algorithm only supports 8 character passwords.</xhtml:p>
                     <xhtml:p>
                        <xhtml:br/>
                        <xhtml:span class="inline_block"> </xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a minlen'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is greater than or equal 8
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'minlen' is set to '8' or greater">
                     <ecl:command>lssec -f /etc/security/user -s default -a minlen</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="8"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.5_etcsecurityuser_-_minalpha" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - minalpha</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the minimum number of alphabetic characters in a password.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">minalpha</xhtml:span> attribute, it ensures that passwords have a minimum number of alphabetic characters.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In<xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">minalpha</xhtml:span> attribute to be greater than or equal to <xhtml:span class="inline_block">2:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.22061186004820254">
                           <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a minalpha=2</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>This means that there must be at least 2 alphabetic characters within an 8 character user password.<xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a minalpha'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is greater than or equal 2
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'minalpha' is set to '2' or greater">
                     <ecl:command>lssec -f /etc/security/user -s default -a minalpha</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="2"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.6_etcsecurityuser_-_minother" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - minother</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the number of characters within a password which must be non-alphabetic.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">minother</xhtml:span> attribute, it increases password complexity by enforcing the use of non-alphabetic characters in every user password. </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">minother</xhtml:span> attribute to be greater than or equal to <xhtml:span class="inline_block">2</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.21879888014688725">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a minother=2</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that there must be at least 2 non-alphabetic characters within an 8 character user password. </xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a minother'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is greater than or equal 2
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'minother' is set to '2' or greater">
                     <ecl:command>lssec -f /etc/security/user -s default -a minother</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="2"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.7_etcsecurityuser_-_maxrepeats" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - maxrepeats</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the maximum number of times a character may appear in a password.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">maxrepeats</xhtml:span> attribute, it enforces a maximum number of character repeats within a password.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In<xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">maxrepeats</xhtml:span> attribute to <xhtml:span class="inline_block">2</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.47012658313932043">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a maxrepeats=2</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that a user may not use the same character more than twice in a password.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a maxrepeats'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 2
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'maxrepeats' is set to '2'">
                     <ecl:command>lssec -f /etc/security/user -s default -a maxrepeats</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="2"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.8_etcsecurityuser_-_histexpire" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - histexpire</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the period of time in weeks that a user will not be able to reuse a password.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">histexpire </xhtml:span>attribute, it ensures that a user cannot reuse a password within a set period of time.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">histexpire</xhtml:span> attribute to be greater than or equal to <xhtml:span class="inline_block">13</xhtml:span>
                        <xhtml:span class="inline_block">:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.05525715497106459">chsec -f /etc/security/user -s default -a histexpire=13</xhtml:code>
                     <xhtml:p>This means that a user will not be able to reuse any password set in the last 13 weeks. </xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a histexpire'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is greater than or equal 13
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'histexpire' is set to '13' or greater">
                     <ecl:command>lssec -f /etc/security/user -s default -a histexpire</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="13"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.9_etcsecurityuser_-_histsize" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - histsize</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the number of previous passwords that a user may not reuse.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">histsize</xhtml:span> attribute, it enforces a minimum number of previous passwords a user cannot reuse.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In /etc/security/user, set the default user stanza histsize attribute to be greater than or equal to 20:</xhtml:p>
                     <xhtml:code class="pre_0.5251109450572623">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a histsize=20</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that a user may not reuse any of the previous 20 passwords.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a histsize'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is greater than or equal 20
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'histsize' is set to '20' or greater">
                     <ecl:command>lssec -f /etc/security/user -s default -a histsize</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="20"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.10_etcsecurityuser_-_maxexpired" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - maxexpired</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the number of weeks after <xhtml:span class="inline_block">maxage</xhtml:span>, that a password can be reset by the user.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">maxexpired </xhtml:span>attribute, it limits the number of weeks after password expiry when it may be changed by the user.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">maxexpired </xhtml:span>attribute to <xhtml:span class="inline_block">2</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.8317301127498238">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a maxexpired=2</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that a user can only reset their password up to 2 weeks after it has expired. After this an administrative user would need to reset the password.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a maxexpired'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 2
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'maxexpired' is set to '2'">
                     <ecl:command>lssec -f /etc/security/user -s default -a maxexpired</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="2"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.11_etcsecurityuser_-_minloweralpha_" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - minloweralpha </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the minimum number of lower case alphabetic characters in a password.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">minloweralpha</xhtml:span> attribute, the password must contain a lower case alphabetic character when it is changed by the user.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">minloweralpha </xhtml:span>attribute to <xhtml:span style="font-family: Courier New; font-size: small;">1</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.8317301127498238">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a minloweralpha=1</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that there must be at least 1 lower case alphabetic character within an 8 character user password.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a minloweralpha'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'minloweralpha' is set to '1'">
                     <ecl:command>lssec -f /etc/security/user -s default -a minloweralpha</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.12_etcsecurityuser_-_minupperalpha_" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - minupperalpha </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the minimum number of upper case alphabetic characters in a password.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">minupperalpha</xhtml:span> attribute, the password must contain an upper case alphabetic character when it is changed by the user.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">minupperalpha </xhtml:span>attribute to <xhtml:span style="font-family: Courier New; font-size: small;">1</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.8317301127498238">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a minupperalpha=1</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that there must be at least 1 upper case alphabetic character within an 8 character user password.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a minupperalpha'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'minupperalpha' is set to '1'">
                     <ecl:command>lssec -f /etc/security/user -s default -a minupperalpha</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.13_etcsecurityuser_-_mindigit" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - mindigit</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the minimum number of digits in a password.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">mindigit</xhtml:span> attribute, the password must contain a digit when it is changed by the user.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">mindigit </xhtml:span>attribute to <xhtml:span style="font-family: Courier New; font-size: small;">1</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.8317301127498238">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a mindigit=1</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that there must be at least 1 digit within an 8 character user password.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a mindigit'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'mindigit' is set to '1'">
                     <ecl:command>lssec -f /etc/security/user -s default -a mindigit</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.14_etcsecurityuser_-_minspecialchar_" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - minspecialchar </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the minimum number of special characters in a password. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">minspecialchar </xhtml:span>attribute, the password must contain a special character when it is changed by the user.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default user stanza <xhtml:span class="inline_block">minspecialchar </xhtml:span>attribute to <xhtml:span style="font-family: Courier New; font-size: small;">1</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.8317301127498238">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a minspecialchar=1</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that there must be at least 1 special character within an 8 character user password.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a minspecialchar'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'minspecialchar' is set to '1'">
                     <ecl:command>lssec -f /etc/security/user -s default -a minspecialchar</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.15_etcsecuritylogin.cfg_-_pwd_algorithm" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/login.cfg - pwd_algorithm</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the loadable password algorithm used when storing user passwords.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>A development in AIX 6.1 was the ability to use different password algorithms as defined in <xhtml:span class="inline_block">/etc/security/pwdalg.cfg</xhtml:span>. The traditional UNIX password algorithm is <xhtml:span class="inline_block">crypt</xhtml:span>, which is a one-way hash function supporting only 8 character passwords. The use of brute force password guessing attacks means that <xhtml:span class="inline_block">crypt</xhtml:span> no longer provides an appropriate level of security and so other encryption mechanisms are recommended.</xhtml:p>
               <xhtml:p>The recommendation of this benchmark is to set the password algorithm to <xhtml:span class="inline_block">ssha256</xhtml:span>. This algorithm supports long passwords, up to 255 characters in length and allows passphrases including the use of the extended ASCII table and the space character. Any passwords already set using <xhtml:span class="inline_block">crypt</xhtml:span> will remain supported, but there can only one system password algorithm active at any one time.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In<xhtml:span class="inline_block">/etc/security/login.cfg</xhtml:span>, set the usw user stanza <xhtml:span class="inline_block">pwd_algorithm </xhtml:span>attribute to <xhtml:span class="inline_block">ssha256</xhtml:span>:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8804660320858557">
                           <xhtml:span class="inline_block">chsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha256</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Ensure that all running applications support SHA256 password encyption</xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure that 'pwd_algorithm' is set to 'ssha256'">
                     <ecl:command>lssec -f /etc/security/login.cfg -s usw -a pwd_algorithm</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^usw\spwd_algorithm=ssha256"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.2_AIX_Security_Expert_-_Login_Policy">
         <xccdf:title xml:lang="en">AIX Security Expert - Login Policy</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section provides guidance on the configuration of the system login policy. This includes login timeouts, delays and remote root access.</xhtml:p>
            <xhtml:p>The recommendations in this section affect the general login policy of the system for all users. Every user should have a dedicated account, to ensure accountability and audit trailing. Any generic accounts should be disabled from direct login, where possible. All remote logons as root should also be prohibited, instead elevation to root should only be allowed once a user has authenticated locally through their individual user account.</xhtml:p>
         </xccdf:description>
         <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.2.1_System_Account_Lockdown">
            <xccdf:title xml:lang="en">System Account Lockdown</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:div>
                  <xhtml:p>This section deals with disabling direct local and remote login to the generic system accounts i.e. <xhtml:span class="inline_block">daemon, bin, sys, adm, uucp, nobody</xhtml:span> and <xhtml:span class="inline_block">lpd</xhtml:span>. It is recommended that a password is not set on these accounts to ensure that the only access is via <xhtml:span class="inline_block">su</xhtml:span> from the root account.</xhtml:p>
                  <xhtml:p>There should not be a requirement to log in as any of these users directly. All users should be given their own unique logon ids to ensure traceability and accountability.</xhtml:p>
               </xhtml:div>
            </xccdf:description>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1.1_system_account_lockdown_-_daemon" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">system account lockdown - daemon</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This change disables direct login access for the <xhtml:span class="inline_block">daemon</xhtml:span> user account. </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>This change disables direct local and remote login to the <xhtml:span class="inline_block">daemon </xhtml:span>user account. It is recommended that a password is not set on this account to ensure that the only access is via <xhtml:span class="inline_block">su</xhtml:span> from the root account.</xhtml:p>
                  <xhtml:p>There should not be a requirement to log in as the <xhtml:span class="inline_block">daemon</xhtml:span> user directly. All users should be given unique logon ids to ensure traceability and accountability.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Change the login and remote login user flags to disable <xhtml:span class="inline_block">daemon </xhtml:span>user access:</xhtml:p>
                        <xhtml:code class="pre_0.2823026877104649">
                           <xhtml:span class="inline_block">chuser login=false rlogin=false daemon </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure daemon user cannot login">
                        <ecl:command>lsuser -a login rlogin daemon</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^daemon\slogin=false\srlogin=false"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1.2_system_account_lockdown_-_bin" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">system account lockdown - bin</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This change disables direct login access for the <xhtml:span class="inline_block">bin</xhtml:span> user account. </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>This change disables direct local and remote login to the <xhtml:span class="inline_block">bin </xhtml:span>user account. It is recommended that a password is not set on this account to ensure that the only access is via <xhtml:span class="inline_block">su</xhtml:span> from the root account.</xhtml:p>
                  <xhtml:p>There should not be a requirement to log in as the <xhtml:span class="inline_block">bin</xhtml:span> user directly. All users should be given unique logon ids to ensure traceability and accountability.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Change the login and remote login user flags to disable <xhtml:span class="inline_block">bin </xhtml:span>user access:</xhtml:p>
                        <xhtml:code class="pre_0.2823026877104649">
                           <xhtml:span class="inline_block">chuser login=false rlogin=false bin </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure bin user cannot login">
                        <ecl:command>lsuser -a login rlogin bin</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^bin\slogin=false\srlogin=false"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1.3_system_account_lockdown_-_sys" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">system account lockdown - sys</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This change disables direct login access for the <xhtml:span class="inline_block">sys</xhtml:span> user account. </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>This change disables direct local and remote login to the <xhtml:span class="inline_block">sys </xhtml:span>user account. It is recommended that a password is not set on this account to ensure that the only access is via <xhtml:span class="inline_block">su</xhtml:span> from the root account.</xhtml:p>
                  <xhtml:p>There should not be a requirement to log in as the <xhtml:span class="inline_block">sys</xhtml:span> user directly. All users should be given unique logon ids to ensure traceability and accountability.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Change the login and remote login user flags to disable <xhtml:span class="inline_block">sys </xhtml:span>user access:</xhtml:p>
                        <xhtml:code class="pre_0.2823026877104649">
                           <xhtml:span class="inline_block">chuser login=false rlogin=false sys </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure sys user cannot login">
                        <ecl:command>lsuser -a login rlogin sys</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^sys\slogin=false\srlogin=false"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1.4_system_account_lockdown_-_adm" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">system account lockdown - adm</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This change disables direct login access for the <xhtml:span style="font-family: Courier New; font-size: small;">adm </xhtml:span>user account. </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>This change disables direct local and remote login to the <xhtml:span class="inline_block">adm </xhtml:span>user account. It is recommended that a password is not set on this account to ensure that the only access is via <xhtml:span class="inline_block">su</xhtml:span> from the root account.</xhtml:p>
                  <xhtml:p>There should not be a requirement to log in as the <xhtml:span class="inline_block">adm</xhtml:span> user directly. All users should be given unique logon ids to ensure traceability and accountability.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Change the login and remote login user flags to disable <xhtml:span class="inline_block">adm</xhtml:span>user access:</xhtml:p>
                        <xhtml:code class="pre_0.2823026877104649">
                           <xhtml:span class="inline_block">chuser login=false rlogin=false adm</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure adm user cannot login">
                        <ecl:command>lsuser -a login rlogin adm</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^adm\slogin=false\srlogin=false"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1.5_system_account_lockdown_-_nobody" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">system account lockdown - nobody</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This change disables direct login access for the <xhtml:span class="inline_block">nobody</xhtml:span> user account. </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>This change disables direct local and remote login to the <xhtml:span class="inline_block">
                        <xhtml:span class="inline_block">nobody</xhtml:span>
                     </xhtml:span>user account. It is recommended that a password is not set on this account to ensure that the only access is via <xhtml:span class="inline_block">su</xhtml:span> from the root account.</xhtml:p>
                  <xhtml:p>There should not be a requirement to log in as the <xhtml:span class="inline_block">nobody</xhtml:span> user directly. All users should be given unique logon ids to ensure traceability and accountability.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Change the login and remote login user flags to disable <xhtml:span class="inline_block">
                              <xhtml:span class="inline_block">nobody </xhtml:span>
                           </xhtml:span>user access:</xhtml:p>
                        <xhtml:code class="pre_0.2823026877104649">
                           <xhtml:span class="inline_block">chuser login=false rlogin=false <xhtml:span class="inline_block">
                                 <xhtml:span class="inline_block">nobody</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure nobody user cannot login">
                        <ecl:command>lsuser -a login rlogin nobody</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^nobody\slogin=false\srlogin=false"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1.6_system_account_lockdown_-_uucp" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">system account lockdown - uucp</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This change disables direct login access for the <xhtml:span class="inline_block">uucp</xhtml:span> user account. </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>This change disables direct local and remote login to the <xhtml:span class="inline_block">uucp </xhtml:span>user account. It is recommended that a password is not set on this account to ensure that the only access is via <xhtml:span class="inline_block">su</xhtml:span> from the root account.</xhtml:p>
                  <xhtml:p>There should not be a requirement to log in as the <xhtml:span class="inline_block">uucp</xhtml:span> user directly. All users should be given unique logon ids to ensure traceability and accountability.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Change the login and remote login user flags to disable <xhtml:span class="inline_block">uucp </xhtml:span>user access:</xhtml:p>
                        <xhtml:code class="pre_0.2823026877104649">
                           <xhtml:span class="inline_block">chuser login=false rlogin=false uucp</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure uucp user cannot login" success="pass">
                        <ecl:command>[[ $(grep -c "^uucp:" /etc/passwd) -eq 0 ]] &amp;&amp; RC=0 || lsuser -a login rlogin uucp |grep '^uucp[[:blank:]]login=false[[:blank:]]rlogin=false'</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1.7_system_account_lockdown_-_lpd" role="full" selected="false" weight="1.0">
               <xccdf:title xml:lang="en">system account lockdown - lpd</xccdf:title>
               <xccdf:description xml:lang="en">
                  <xhtml:p>This change disables direct login access for the <xhtml:span class="inline_block">lpd</xhtml:span> user account. </xhtml:p>
               </xccdf:description>
               <xccdf:rationale xml:lang="en">
                  <xhtml:p>This change disables direct local and remote login to the <xhtml:span class="inline_block">lpd </xhtml:span>user account. It is recommended that a password is not set on this account to ensure that the only access is via <xhtml:span class="inline_block">su</xhtml:span> from the root account.</xhtml:p>
                  <xhtml:p>There should not be a requirement to log in as the <xhtml:span class="inline_block">lpd</xhtml:span> user directly. All users should be given unique logon ids to ensure traceability and accountability.</xhtml:p>
               </xccdf:rationale>
               <xccdf:fixtext xml:lang="en">
                  <xhtml:div>
                     <xhtml:p>
                        <xhtml:p>Change the login and remote login user flags to disable <xhtml:span class="inline_block">lpd</xhtml:span>user access:</xhtml:p>
                        <xhtml:code class="pre_0.2823026877104649">
                           <xhtml:span class="inline_block">chuser login=false rlogin=false <xhtml:span class="inline_block">lpd</xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:div>
               </xccdf:fixtext>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure lpd user cannot login" success="pass">
                        <ecl:command>[[ $(grep -c "^lpd:" /etc/passwd) -eq 0 ]] &amp;&amp; RC=0 || lsuser -a login rlogin lpd |grep '^lpd[[:blank:]]login=false[[:blank:]]rlogin=false'</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:Rule>
         </xccdf:Group>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.2_etcsecuritylogin.cfg_-_logininterval" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/login.cfg - logininterval</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the time interval, in seconds, when the unsuccessful logins must occur to disable a port. This parameter is applicable to alltty connections and the system console.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">logininterval</xhtml:span> attribute, a port will be disabled if the incorrect password is entered a pre-defined number of times, set via <xhtml:span class="inline_block">logindisable</xhtml:span>, within this interval.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In<xhtml:span class="inline_block">/etc/security/login.cfg</xhtml:span>, set the default stanza <xhtml:span class="inline_block">logininterval</xhtml:span> attribute to <xhtml:span class="inline_block">300</xhtml:span> or less<xhtml:span class="inline_block">:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.9213483069360695">
                        <xhtml:span class="inline_block">chsec -f /etc/security/login.cfg -s default -a logininterval=300</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that the port will be disabled if the incorrect password is typed the appropriate number of times, within a 300 second interval.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/login.cfg -s default -a logininterval'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is less than or equal 300
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'logininterval' is less than or equal to '300'">
                     <ecl:command>lssec -f /etc/security/login.cfg -s default -a logininterval</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="le" value="300"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.3_etcsecuritylogin.cfg_-_logindisable" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/login.cfg - logindisable</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the number of unsuccessful login attempts required before a port will be locked. This parameter is applicable to all <xhtml:span class="inline_block">tty</xhtml:span> connections and the system console.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">logindisable</xhtml:span> attribute, a port will be disabled if the incorrect password is entered a set number of times within a specified interval, set via <xhtml:span class="inline_block">logininterval</xhtml:span>.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/login.cfg</xhtml:span>, set the default stanza <xhtml:span class="inline_block">logindisable</xhtml:span> attribute to <xhtml:span class="inline_block">10</xhtml:span> or less<xhtml:span class="inline_block">:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.2228842973994396">
                        <xhtml:span class="inline_block">chsec -f /etc/security/login.cfg -s default -a logindisable=10</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that the port will be disabled if the incorrect password is typed 10 times within a 300 second interval.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/login.cfg -s default -a logindisable'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is not equal 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'logindisable' is equal to '10' or less">
                     <ecl:command>lssec -f /etc/security/login.cfg -s default -a logindisable</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ne" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.4_etcsecuritylogin.cfg_-_loginreenable" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/login.cfg - loginreenable</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the number of minutes after a port is locked when it will be automatically un-locked. This parameter is applicable to all <xhtml:span class="inline_block">tty</xhtml:span> connections and the system console.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">loginreenable</xhtml:span> attribute, a locked port will be automatically re-enabled once a given number of minutes have passed.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/login.cfg</xhtml:span>, set the default stanza <xhtml:span class="inline_block">loginreenable </xhtml:span>attribute to <xhtml:span class="inline_block">360</xhtml:span> or greater:</xhtml:p>
                     <xhtml:code class="pre_0.29633863348815165">
                        <xhtml:span class="inline_block">chsec -f /etc/security/login.cfg -s default -a loginreenable=360</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that a locked port will be automatically re-enabled 360 minutes after being locked.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/login.cfg -s default -a loginreenable'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is greater than or equal 360
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'loginreenable' is greater than or equal to '360'">
                     <ecl:command>lssec -f /etc/security/login.cfg -s default -a loginreenable</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="360"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.5_etcsecuritylogin.cfg_-_logintimeout" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/login.cfg - logintimeout</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the number of seconds during which the password must be typed at login.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">logintimeout </xhtml:span>attribute, a password must be entered within a specified time period.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/login.cfg</xhtml:span>, set the usw stanza <xhtml:span class="inline_block">logintimeout</xhtml:span> attribute to <xhtml:span class="inline_block">30</xhtml:span> or less<xhtml:span class="inline_block">:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.48099954568736974">
                        <xhtml:span class="inline_block">chsec -f /etc/security/login.cfg -s usw -a logintimeout=30 </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that a user will have 30 seconds, from prompting, in which to type in their password.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'logintimeout' is less than or equal to '30'">
                     <ecl:command>lssec -f /etc/security/login.cfg -s usw -a logintimeout</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^usw\slogintimeout=30"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.6_etcsecuritylogin.cfg_-_logindelay" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/login.cfg - logindelay</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the number of seconds delay between each failed login attempt. This works as a multiplier, so if the parameter is set to 10, after the first failed login it would delay for 10 seconds, after the second failed login 20 seconds etc.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">logindelay</xhtml:span> attribute, this implements a delay multiplier in-between unsuccessful login attempts.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/login.cfg</xhtml:span>, set the default stanza <xhtml:span class="inline_block">logindelay </xhtml:span>attribute to <xhtml:span class="inline_block">10</xhtml:span> or greater<xhtml:span class="inline_block">:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.6635961411460964">
                        <xhtml:span class="inline_block">chsec -f /etc/security/login.cfg -s default -a logindelay=10</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that a user will have to wait 10 seconds before being able to re-enter their password. During subsequent attempts this delay will increase as a multiplier of (the number of failed login attempts * logindelay)</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/login.cfg -s default -a logindelay'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is greater than or equal 10
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'logindelay' is greater than or equal to '10'">
                     <ecl:command>lssec -f /etc/security/login.cfg -s default -a logindelay</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="ge" value="10"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.7_etcsecurityuser_-_loginretries" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - loginretries</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines the number of attempts a user has to login to the system before their account is disabled.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">loginretries</xhtml:span> attribute, this ensures that a user can have a pre-defined number of attempts to get their password right, prior to locking the account.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the default stanza <xhtml:span class="inline_block">loginretries</xhtml:span> attribute to <xhtml:span class="inline_block">3</xhtml:span>
                        <xhtml:span class="inline_block">:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.8536562525375591">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s default -a loginretries=3</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that a user will have 3 attempts to enter the correct password. This does not apply to the root user, which has its own stanza entry disabling this feature.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a loginretries'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 3
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'loginretries' is set to '3'">
                     <ecl:command>lssec -f /etc/security/user -s default -a loginretries</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="3"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.8_etcsecurityuser_-_rlogin" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - rlogin</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Defines whether or not the root user can login remotely.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">rlogin</xhtml:span> attribute to false, this ensures that the root user cannot remotely log into the system. All remote logins as root should be prohibited, instead elevation to root should only be allowed once a user has authenticated locally through their individual user account.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the root stanza <xhtml:span class="inline_block">rlogin</xhtml:span> attribute to <xhtml:span class="inline_block">false:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.3443732231184637">
                        <xhtml:span class="inline_block">chsec -f /etc/security/user -s root -a rlogin=false</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>This means that the root user will not be able to log in the system directly.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure root cannot 'rlogin'">
                     <ecl:command>lssec -f /etc/security/user -s root -a rlogin</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^root\srlogin=false"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.9_etcsecurityuser_-_sugroups" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/security/user - sugroups</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Restricts access to root, via <xhtml:span class="inline_block">su</xhtml:span>, to members of a specific group.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>In setting the <xhtml:span class="inline_block">sugroups</xhtml:span> attribute to <xhtml:span class="inline_block">system</xhtml:span>, this ensures that only members of the system group are able to su root. This makes it difficult for an attacker to use a stolen root password as the attacker first has to get access to a system user ID.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/security/user</xhtml:span>, set the root stanza <xhtml:span class="inline_block">sugroups a</xhtml:span>ttribute to <xhtml:span class="inline_block">system:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.32312501834142354">
                           <xhtml:span class="inline_block">chuser su=true sugroups=system root</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure root 'su' access is restricted">
                     <ecl:command>lssec -f /etc/security/user -s root -a sugroups -a su</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^root\ssugroups=system\ssu=true"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.3_AIX_Security_Expert_-_System_Services_Management">
         <xccdf:title xml:lang="en">AIX Security Expert - System Services Management</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The objective of this section is to reduce the number of running services down to those which are core to the common functions of a UNIX server. When a superfluous service is not running, the system will not be subject to any latent vulnerability later discovered with that service and not require any subsequent remediation.</xhtml:p>
            <xhtml:p>This section provides guidance on the startup of system services in <xhtml:span class="inline_block">/etc/inittab</xhtml:span>, <xhtml:span class="inline_block">/etc/rc.tcpip </xhtml:span>and <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>. The majority of services within these files are disabled in AIX by default, so this section will focus on those services which are enabled, which if possible, should be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.1_etcinittab_-_qdaemon" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inittab - qdaemon</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This is the printing scheduling daemon that manages the submission of print jobs to <xhtml:span class="inline_block">piobe</xhtml:span>.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>If there is not a requirement to support local or remote printing, remove the <xhtml:span class="inline_block">qdaemon</xhtml:span> entry from<xhtml:span class="inline_block">/etc/inittab</xhtml:span>.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inittab</xhtml:span>, remove the <xhtml:span class="inline_block">qdaemon</xhtml:span> entry:</xhtml:p>
                     <xhtml:code class="pre_0.116282811689073">
                        <xhtml:span class="inline_block">rmitab qdaemon </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab qdaemon'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'qdaemon' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab qdaemon</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.2_etcinittab_-_lpd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inittab - lpd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">lpd</xhtml:span> daemon accepts remote print jobs from other systems.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>If there is not a requirement for the system to act as a remote print server for other servers, remove the <xhtml:span class="inline_block">lpd </xhtml:span>entry.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inittab</xhtml:span>, remove the <xhtml:span class="inline_block">lpd</xhtml:span> entry:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.23470927443360245">
                           <xhtml:span class="inline_block">rmitab lpd</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab lpd'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'lpd' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab lpd</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.3_etcinittab_-_piobe" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inittab - piobe</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">piobe</xhtml:span> daemon is the I/O back end for the printing process, handling the job scheduling and spooling.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>If there is not a requirement for the system to support either local or remote printing, remove the <xhtml:span class="inline_block">piobe</xhtml:span> entry.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inittab</xhtml:span>, remove the <xhtml:span class="inline_block">piobe</xhtml:span> entry:</xhtml:p>
                     <xhtml:code class="pre_0.586093391937013">
                        <xhtml:span class="inline_block">rmitab piobe </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab piobe'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'piobe' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab piobe</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.4_etcinittab_-_dt" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inittab - dt</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This entry executes the CDE startup script which starts the AIX Common Desktop Environment.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>If there is not an <xhtml:span class="inline_block">lft</xhtml:span> connected to the system and there are no other X11 clients that require CDE, remove the dt entry.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inittab</xhtml:span>, remove the <xhtml:span class="inline_block">dt</xhtml:span> entry:</xhtml:p>
                     <xhtml:code class="pre_0.2667174750919101">
                        <xhtml:span class="inline_block">rmitab dt</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab dt'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'dt' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab dt</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.5_etcinittab_-_rcnfs" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inittab - rcnfs</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">rcnfs</xhtml:span> entry starts the NFS daemons during system boot.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>NFS is a service with numerous historical vulnerabilities and should not be enabled unless there is no alternative. If NFS serving is required, then read-only exports are recommended and no filesystem or directory should be exported with root access. Unless otherwise required the NFS daemons will be disabled. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Use the <xhtml:span class="inline_block">
                              <xhtml:span>rmitab</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> command to remove the NFS start-up script from <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inittab</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.4273638913524365">
                        <xhtml:span class="inline_block">rmitab rcnfs</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab rcnfs'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'rcnfs' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab rcnfs</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.6_etcrc.tcpip_-_sendmail" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - sendmail</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>sendmail</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon on system startup. This means that the system can operate as a mail server. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>sendmail</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> is a service with many historical vulnerabilities and where possible should be disabled. If the system is not required to operate as a mail server i.e. sending, receiving or processing e-mail, comment out the <xhtml:span class="inline_block">
                        <xhtml:span>sendmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>entry.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span>sendmail </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.04015029232804679">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d sendmail</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/lib/sendmail"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/lib/sendmail' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/lib/sendmail" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.7_etcrc.tcpip_-_snmpd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - snmpd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>snmpd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon on system startup. This allows remote monitoring of network and server configuration.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">snmpd</xhtml:span> daemon is used by many 3rd party applications to monitor the health of the system. If <xhtml:span class="inline_block">snmpd</xhtml:span> is not required, it is recommended that it is disabled.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/rc.tcpip</xhtml:span>, comment out the <xhtml:span class="inline_block">snmpd</xhtml:span> entry:</xhtml:p>
                     <xhtml:code class="pre_0.8945595367637353">
                        <xhtml:span class="inline_block">chrctcp -d snmpd</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/snmpd"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/snmpd' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/snmpd" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.8_etcrc.tcpip_-_dhcpcd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - dhcpcd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>dhcpcd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon on system startup. </xhtml:span>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>dhcpcd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>deamon receives address and configuration information from the DHCP server.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>dhcpcd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon is the DHCP client that receives address and configuration information from the DHCP server. This must be disabled if DHCP is not used to serve IP address to the local system. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/rc.tcpip</xhtml:span>, comment out the <xhtml:span class="inline_block">dhcpcd </xhtml:span>entry:</xhtml:p>
                     <xhtml:code class="pre_0.10440787636363696">
                        <xhtml:span class="inline_block">chrctcp -d dhcpcd </xhtml:span>
                     </xhtml:code>
                     <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/dhcpcd"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/dhcpcd' is not enabled '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/dhcpcd" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.9_etcrc.tcpip_-_dhcprd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - dhcprd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>dhcprd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon on system startup. </xhtml:span>
                  <xhtml:span>The <xhtml:span class="inline_block">dhcprd </xhtml:span>daemon listens for broadcast packets, receives them, and forwards them to the appropriate server.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">dhcprd</xhtml:span> daemon is the DHCP relay deamon that forwards the DHCP and BOOTP packets in the network. You must disable this service if DHCP is not enabled in the network.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/rc.tcpip</xhtml:span>, comment out the <xhtml:span class="inline_block">dhcprd</xhtml:span> entry:</xhtml:p>
                     <xhtml:code class="pre_0.9172452051745265">
                        <xhtml:span class="inline_block">chrctcp -d dhcprd </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/dhcprd"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/dhcprd' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/dhcprd" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.10_etcrc.tcpip_-_dhcpsd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - dhcpsd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This entry starts the <xhtml:span class="inline_block">dhcpsd</xhtml:span> daemon on system startup. The <xhtml:span class="inline_block">dhcpsd</xhtml:span> deamon is the DHCP server that serves addresses and configuration information to DHCP clients in the network.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">dhcpsd</xhtml:span> daemon is the DHCP server that serves addresses and configuration information to DHCP clients in the network. You must disable this service if the server is not a DHCP server.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/rc.tcpip</xhtml:span>, comment out the <xhtml:span class="inline_block">dhcpsd</xhtml:span> entry:</xhtml:p>
                     <xhtml:code class="pre_0.16569120394067516">
                        <xhtml:span class="inline_block">chrctcp -d dhcpsd </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/dhcpsd"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/dhcpsd' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/dhcpsd" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.11_etcrc.tcpip_-_autoconf6" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - autoconf6</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts <xhtml:span class="inline_block">
                        <xhtml:span>autoconf6</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> on system startup. </xhtml:span>
                  <xhtml:span>This is to automatically configure </xhtml:span>
                  <xhtml:span>IPv6 </xhtml:span>
                  <xhtml:span>interfaces at boot time.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>authoconf6</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>
                     <xhtml:span>is used to automatically configure IPv6 interfaces at boot time. Running this service may allow other hosts on the same physical subnet to connect via IPv6, even when the network does not support it. You must disable this unless you utilize IPv6 on the server. </xhtml:span>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In<xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span>autoconf6</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9695999737878833">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d autoconf6</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/autoconf6"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/autoconf6' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/autoconf6" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.12_etcrc.tcpip_-_gated" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - gated</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>gated</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon system startup. </xhtml:span>
                  <xhtml:span>This daemon provides gateway routing functions for protocols such as RIP and SNMP.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>gated</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon provides gateway routing functions for protocols such as RIP and SNMP. It is recommended that this daemon is disabled, unless the server is functioning as a network router.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/rc.tcpip</xhtml:span>, comment out the <xhtml:span class="inline_block">gated</xhtml:span> entry:</xhtml:p>
                     <xhtml:code class="pre_0.21117256154165986">
                        <xhtml:span class="inline_block">chrctcp -d gated</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/gated"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/gated' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/gated" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.13_etcrc.tcpip_-_mrouted" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - mrouted</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>mrouted</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon at system startup. </xhtml:span>
                  <xhtml:span>This </xhtml:span>
                  <xhtml:span>daemon is an implementation of the multicast routing protocol.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>mrouted</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon is an implementation of the multicast routing protocol. It is recommended that this daemon is disabled, unless the server is functioning as a multicast router.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:span>
                              <xhtml:span>In <xhtml:span class="inline_block">
                                    <xhtml:span>
                                       <xhtml:span>/etc/rc.tcpip</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>
                              <xhtml:span>, comment out the <xhtml:span class="inline_block">
                                    <xhtml:span>mrouted</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>
                              <xhtml:span> entry:</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6966379274975616">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d </xhtml:span>
                                 <xhtml:span>mrouted</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*/usr/sbin/mrouted[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/mrouted' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*/usr/sbin/mrouted[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.14_etcrc.tcpip_-_named" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - named</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>named</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon at system startup. </xhtml:span>
                  <xhtml:span>This </xhtml:span>
                  <xhtml:span>is the server for the DNS protocol and controls domain name resolution for its clients.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">named </xhtml:span>daemon is the server for the DNS protocol and controls domain name resolution for its clients. It is recommended that this daemon is disabled, unless the server is functioning as a DNS server.This entry starts the <xhtml:span class="inline_block">named</xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon at system startup. </xhtml:span>
                  <xhtml:span>This </xhtml:span>
                  <xhtml:span>is the server for the DNS protocol and controls domain name resolution for its clients.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span>named</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7943581611043669">
                           <xhtml:span class="inline_block">chrctcp -d named</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/named"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/named' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/named" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.15_etcrc.tcpip_-_routed" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - routed</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>routed</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon at system startup. </xhtml:span>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>routed </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemo</xhtml:span>
                  <xhtml:span>n</xhtml:span>
                  <xhtml:span>manages the network routing tables in the kernel.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>routed</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon manages the network routing tables in the kernel. It is recommended that this daemon is disabled, unless the server is functioning as a network router.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span>routed </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d </xhtml:span>
                                 <xhtml:span>routed</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/routed"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/routed' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/routed" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.16_etcrc.tcpip_-_rwhod" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - rwhod</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>rwhod </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon at system startup. </xhtml:span>
                  <xhtml:span>This </xhtml:span>
                  <xhtml:span>is the remote WHO service.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>rwhod</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon is the remote WHO service, which collects and broadcasts status information to peer servers on the same network. It is recommended that this daemon is disabled, unless it is required.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span>rwhod </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d </xhtml:span>
                                 <xhtml:span>rwhod</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/rwhod"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/rwhod' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/rwhod" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.17_etcrc.tcpip_-_timed" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - timed</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>timed</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon at system startup. </xhtml:span>
                  <xhtml:span>This </xhtml:span>
                  <xhtml:span>is the old UNIX time service.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>timed</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon is the old UNIX time service. You must disable this service and use <xhtml:span class="inline_block">
                        <xhtml:span>xntp</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, if time synchronization is required in your environment.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">timed </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d timed</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/timed"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/timed' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/timed" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.18_etcrc.tcpip_-_dpid2" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - dpid2</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>dpid2</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon on system startup. </xhtml:span>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>dpid2 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon acts as a protocol converter, which enables DPI (SNMP v2) sub-agents, such as <xhtml:span class="inline_block">
                        <xhtml:span>hostmibd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, </xhtml:span>
                  <xhtml:span>to talk to a SNMP v1 agent that follows SNMP MUX protocol.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>dpid2 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>deamon acts as a protocol converter, which enables DPI (SNMP v2) sub-agents, such as <xhtml:span class="inline_block">
                        <xhtml:span>hostmibd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, </xhtml:span>
                  <xhtml:span>to talk to a SNMP v1 agent that follows SNMP MUX protocol</xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>Unless the server hosts an SNMP agent, it is recommended that <xhtml:span class="inline_block">
                        <xhtml:span>dpid2</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> is disabled. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the<xhtml:span class="inline_block"> dpid2 </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d dpid2</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/dpid2"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/dpid2' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/dpid2" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.19_etcrc.tcpip_-_hostmibd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - hostmibd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>hostmibd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>hostmibd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon is a dpi2 sub-agent which manages a number of MIB variables. If <xhtml:span class="inline_block">
                        <xhtml:span>snmpd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> is not required, it is recommended that it is disabled. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The specific MIB variables which are managed by <xhtml:span class="inline_block">
                        <xhtml:span>hostmibd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>are defined by RFC 2790. Further details relating to these MIBS can be found in the URL below:</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>
                     <xhtml:a href="http://pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds2/hostmibd.htm?resultof=%22%68%6f%73%74%6d%69%62%64%22%20">http://pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds2/hostmibd.htm?resultof=%22%68%6f%73%74%6d%69%62%64%22%20</xhtml:a>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the<xhtml:span class="inline_block"> hostmibd </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d hostmibd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/hostmibd"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/hostmibd' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/hostmibd" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.20_etcrc.tcpip_-_snmpmibd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - snmpmibd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>snmpmibd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>snmpmibd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon is a dpi2 sub-agent which manages a number of MIB variables. If </xhtml:span>
                  <xhtml:span>snmpd</xhtml:span>
                  <xhtml:span> is not required, it is recommended that it is disabled. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The specific MIB variables which are managed by <xhtml:span class="inline_block">
                        <xhtml:span>snmpmibd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>are defined by numerous RFCs. Further details relating to these MIBS can be found in the URL below:</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>
                     <xhtml:a href="http://pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds5/snmpmibd.htm?resultof=%22%73%6e%6d%70%6d%69%62%64%22%20">http://pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds5/snmpmibd.htm?resultof=%22%73%6e%6d%70%6d%69%62%64%22%20</xhtml:a>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the<xhtml:span class="inline_block"> s<xhtml:span>nmpmib</xhtml:span>d </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d <xhtml:span style="background-color: #ddd9c3;">s<xhtml:span>nmpmibd</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/snmpmibd"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/snmpmibd' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/snmpmibd" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.21_etcrc.tcpip_-_aixmibd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - aixmibd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>aixmibd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>aixmibd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon is a dpi2 sub-agent which manages a number of MIB variables. If <xhtml:span class="inline_block">
                        <xhtml:span>snmpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is not required, it is recommended that it is disabled. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>aixmibd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>collects data from an AIX specific MIB. </xhtml:span>
                  <xhtml:span>Further details relating to this MIB can be found in the URL below:</xhtml:span>
               </xhtml:p>
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:a href="http://pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds1/aixmibd.htm?resultof=%22%61%69%78%6d%69%62%64%22%20">http://pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds1/aixmibd.htm?resultof=%22%61%69%78%6d%69%62%64%22%20</xhtml:a>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the<xhtml:span class="inline_block"> aixmibd </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d <xhtml:span style="background-color: #ddd9c3;">aixmibd</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/aixmibd"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/aixmibd' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/aixmibd" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.22_etcrc.tcpip_-_ndpd-host" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - ndpd-host</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts <xhtml:span class="inline_block">
                        <xhtml:span>ndpd-host </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>on system startup. </xhtml:span>
                  <xhtml:span>This is the </xhtml:span>
                  <xhtml:span>Neighbor Discovery Protocol</xhtml:span>
                  <xhtml:span> (NDP) daemon, required in IPv6.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ndpd-</xhtml:span>
                        <xhtml:span>host</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> is the NDP deamon for the server. Unless the server utilizes IPv6, this is not required and should be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the<xhtml:span class="inline_block"> ndpd-host </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d <xhtml:span style="background-color: #ddd9c3;">ndpd-host</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/ndpd-host"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/ndpd-host' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/ndpd-host" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.23_etcrc.tcpip_-_ndpd-router" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - ndpd-router</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts <xhtml:span class="inline_block">
                        <xhtml:span>ndpd-router</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> on system startup. </xhtml:span>
                  <xhtml:span>This manages the </xhtml:span>
                  <xhtml:span>Neighbor Discovery Protocol</xhtml:span>
                  <xhtml:span> (NDP) for non kernel activities, required in IPv6.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ndpd-</xhtml:span>
                        <xhtml:span>router</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> manages NDP for non-kernel activities. Unless the server utilizes IPv6, this is not required and should be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/rc.tcpip</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the<xhtml:span class="inline_block"> ndpd-router </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6266710774565507">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chrctcp -d <xhtml:span style="background-color: #ddd9c3;">ndpd-router</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/ndpd-router"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/ndpd-router' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/ndpd-router" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.24_etcinetd.conf_-_telnet" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - telnet</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>telnetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon when required. This provides a protocol for command line access, from a remote machine.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This <xhtml:span class="inline_block">
                        <xhtml:span>telnet</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> service is used to service remote user connections. This is historically the most commonly used remote access method for UNIX servers. The username and passwords are passed over the network in clear text and therefore insecurely. </xhtml:span>
                  <xhtml:span>Unless required the <xhtml:span class="inline_block">
                        <xhtml:span>telnetd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon will be disabled. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>Many older legacy systems do not support SSH and still require </xhtml:span>
                  <xhtml:span>telnet</xhtml:span>
                  <xhtml:span> as a protocol for access. If this is not required, it is recommended that telnet is disabled and SSH is used as a replacement authentication mechanism.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span>telnet </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.16148458004698785">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                 <xhtml:span>-v 'telnet' -p 'tcp6'</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*telnet[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'telnet' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*telnet[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.25_etcinetd.conf_-_exec" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - exec</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>rexecd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon when required. This daemon executes a command from a remote system, once the connection has been authenticated.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>exec</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> service is used to execute a command sent from a remote server. The username and passwords are passed over the network in clear text and therefore insecurely. </xhtml:span>
                  <xhtml:span>Unless required the <xhtml:span class="inline_block">
                        <xhtml:span>rexecd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon will be disabled. This function, if required, should be facilitated through SSH.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span class="n_romve">exec </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.16148458004698785">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                 <xhtml:span>-v 'exec' -p 'tcp6'</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*exec[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'exec' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*exec[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.26_etcinetd.conf_-_daytime" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - daytime</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>daytime </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service</xhtml:span>
                  <xhtml:span>when required. This provides the current date and time to other servers on a network.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This <xhtml:span class="inline_block">
                        <xhtml:span>daytime </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is a defunct time service, typically used for testing purposes only. The service should be disabled as it can leave the system vulnerable to DoS </xhtml:span>
                  <xhtml:span>ping </xhtml:span>
                  <xhtml:span>attacks. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">daytime </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entries:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.49622538761138">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>
                                          <xhtml:span class="inline_block">
                                             <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                             <xhtml:span>-v 'daytime' -p 'tcp'</xhtml:span>
                                          </xhtml:span>
                                       </xhtml:span>
                                       <xhtml:br/>
                                       <xhtml:span>
                                          <xhtml:span class="inline_block">
                                             <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                             <xhtml:span>-v 'daytime' -p 'udp'</xhtml:span>
                                          </xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*daytime[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'daytime' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*daytime[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.27_etcinetd.conf_-_shell" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - shell</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>rshd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This daemon executes a command from a remote system.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This <xhtml:span class="inline_block">
                        <xhtml:span>shell </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used to execute a command from a remote server. The username and passwords are passed over the network in clear text and therefore insecurely. </xhtml:span>
                  <xhtml:span>Unless required the <xhtml:span class="inline_block">
                        <xhtml:span>rshd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> daemon will be disabled. This function, if required, should be facilitated through SSH.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">shell </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.49622538761138">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>
                                          <xhtml:span class="inline_block">
                                             <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                             <xhtml:span>-v 'shell' -p 'tcp6'</xhtml:span>
                                          </xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*shell[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'shell' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*shell[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.28_etcinetd.conf_-_cmsd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - cmsd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>cmsd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> service </xhtml:span>
                  <xhtml:span>when required. This is a calendar and appointment service.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>cmsd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is utilized by CDE to provide calendar functionality. If CDE is not required, this service should be disabled. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">cmsd </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:code class="pre_0.9917297196409682">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                    <xhtml:span>-v 'cmsd' -p 'sunrpc_udp'</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:br/>
                           </xhtml:p>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*cmsd[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'cmsd' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*cmsd[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.29_etcinetd.conf_-_ttdbserver" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - ttdbserver</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>ttdbserver </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service</xhtml:span>
                  <xhtml:span>when required. It is not a pre-requisite service for CDE, which is fully functional when it is disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ttdbserver </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is the tool-talk database service for CDE. This service runs as root and should be disabled. </xhtml:span>
                  <xhtml:span>Unless required the <xhtml:span class="inline_block">
                        <xhtml:span>ttdbserver </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service will be disabled. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span style="font-family: Courier New; font-size: small;">ttdbserver </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div style="padding-bottom: 1pt; padding-left: 4pt; padding-right: 4pt; background: #ddd9c3; padding-top: 2pt; mso-border-alt: solid windowtext .5pt; mso-element: para-border-div; border: windowtext 1pt solid;">
                              <xhtml:p class="CISC0de" style="margin: 0cm 0cm 0pt; background: #ddd9c3; mso-border-alt: solid windowtext .5pt; mso-padding-alt: 2.0pt 4.0pt 1.0pt 4.0pt; padding: 0cm;">
                                 <xhtml:span>
                                    <xhtml:span style="font-size: small;">
                                       <xhtml:span style="color: #000000;">
                                          <xhtml:span style="font-family: Courier New;">chsubserver -r inetd -C /etc/inetd.conf -d<xhtml:span style="mso-spacerun: yes;"> </xhtml:span>-v 'ttdbserver' -p 'sunrpc_tcp'</xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:p>
                           </xhtml:div>
                           <xhtml:p>
                              <xhtml:br/>
                           </xhtml:p>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*ttdbserver[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'ttdbserver' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*ttdbserver[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.30_etcinetd.conf_-_uucp" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - uucp</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>uucp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This service facilitates file copying between networked servers.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>uucp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>(UNIX to UNIX Copy Program), service allows users to copy files between networked machines. Unless an application or process requires UUCP this should be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span style="font-family: Courier New; font-size: small;">uucp </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div style="padding-bottom: 1pt; padding-left: 4pt; padding-right: 4pt; background: #ddd9c3; padding-top: 2pt; mso-border-alt: solid windowtext .5pt; mso-element: para-border-div; border: windowtext 1pt solid;">
                              <xhtml:p class="CISC0de" style="margin: 0cm 0cm 0pt; background: #ddd9c3; mso-border-alt: solid windowtext .5pt; mso-padding-alt: 2.0pt 4.0pt 1.0pt 4.0pt; padding: 0cm;">
                                 <xhtml:span>
                                    <xhtml:span style="font-size: small;">
                                       <xhtml:span style="color: #000000;">
                                          <xhtml:span style="font-family: Courier New;">chsubserver -r inetd -C /etc/inetd.conf -d<xhtml:span style="mso-spacerun: yes;"> </xhtml:span>-v 'uucp' -p 'tcp'</xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:p>
                           </xhtml:div>
                           <xhtml:p>
                              <xhtml:br/>
                           </xhtml:p>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*uucp[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'uucp' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*uucp[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.31_etcinetd.conf_-_time" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - time</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>time </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This service can be used to synchronize system clocks.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>time </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is an obsolete process used to synchronize system clocks at boot time. This has been superseded by NTP, which should be use if time synchronization is necessary. Unless required the <xhtml:span class="inline_block">
                        <xhtml:span>time </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service will be disabled. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">time </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:code class="pre_0.4638284224784204">
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'time' -p 'udp'</xhtml:span>
                                       <xhtml:br/>
                                       <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                       <xhtml:span>-v 'time' -p 'tcp' </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:code>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*time[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'time' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*time[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.32_etcinetd.conf_-_login" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - login</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>rlogin </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This service authenticates remote user logins.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This <xhtml:span class="inline_block">
                        <xhtml:span>login </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used to authenticate a remote user connection when logging in via the <xhtml:span class="inline_block">
                        <xhtml:span>rlogin </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>command. The username and password are passed over the network in clear text and therefore insecurely. </xhtml:span>
                  <xhtml:span>Unless required the </xhtml:span>
                  <xhtml:span>rlogin</xhtml:span>
                  <xhtml:span> daemon will be disabled. This function, if required, should be facilitated through SSH.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">login </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:code class="pre_0.17864055389013417">
                                    <xhtml:span>
                                       <xhtml:span class="inline_block">
                                          <xhtml:span>chsubserver </xhtml:span>
                                          <xhtml:span>-r inetd -C /etc/inetd.conf -d -v 'login' -p 'tcp'</xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:code>
                                 <xhtml:p>
                                    <xhtml:br/>
                                 </xhtml:p>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*login[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'login' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*login[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.33_etcinetd.conf_-_talk" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - talk</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>
                     <xhtml:span>
                        <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                              <xhtml:span>talkd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:span>
                     <xhtml:span>
                        <xhtml:span>
                           <xhtml:span>daemon </xhtml:span>
                           <xhtml:span>when required. This service establishes a two-way communication link between two users, either locally or remotely.</xhtml:span>
                        </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This <xhtml:span class="inline_block">
                        <xhtml:span>talk </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used to establish an interactive two-way communication link between two UNIX users</xhtml:span>
                  <xhtml:span>. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the <xhtml:span class="inline_block">
                        <xhtml:span>talk </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service will be disabled</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">talk </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:code class="pre_0.17864055389013417">
                                    <xhtml:span>
                                       <xhtml:span class="inline_block">
                                          <xhtml:span>chsubserver </xhtml:span>
                                          <xhtml:span>-r inetd -C /etc/inetd.conf -d -v 'talk' -p 'udp'</xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:code>
                                 <xhtml:p>
                                    <xhtml:br/>
                                 </xhtml:p>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*talk[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'talk' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*talk[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.34_etcinetd.conf_-_ntalk" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - ntalk</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>talkd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This service establishes a two-way communication link between two users, either locally or remotely. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This <xhtml:span class="inline_block">nt</xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>alk </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used to establish an interactive two-way communication link between two UNIX users</xhtml:span>
                  <xhtml:span>. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the <xhtml:span class="inline_block">
                        <xhtml:span>ntalk </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service will be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">nt<xhtml:span class="inline_block">alk </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:code class="pre_0.17864055389013417">
                                    <xhtml:span>
                                       <xhtml:span class="inline_block">
                                          <xhtml:span>chsubserver </xhtml:span>
                                          <xhtml:span>-r inetd -C /etc/inetd.conf -d -v 'ntalk' -p 'udp'</xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:code>
                                 <xhtml:p>
                                    <xhtml:br/>
                                 </xhtml:p>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*ntalk[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'ntalk' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*ntalk[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.35_etcinetd.conf_-_ftp" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - ftp</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>ftpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This service is used for transferring files from/to a remote machine.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used to transfer files from or to a remote machine</xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>The username and passwords are passed over the network in clear text and therefore insecurely. </xhtml:span>
                  <xhtml:span>Unless required the <xhtml:span class="inline_block">
                        <xhtml:span>ftpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon will be disabled. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>Many older legacy systems do not support SSH and still required <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>as a service for data copying. If this is not required it is recommended that <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is disabled and <xhtml:span class="inline_block">
                        <xhtml:span>sftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is used as a replacement file and directory copying mechanism.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span class="inline_block">ftp </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:code class="pre_0.8852308306678954">
                                          <xhtml:span>
                                             <xhtml:span class="inline_block">
                                                <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'ftp' -p 'tcp6'</xhtml:span>
                                             </xhtml:span>
                                          </xhtml:span>
                                       </xhtml:code>
                                    </xhtml:div>
                                    <xhtml:span>
                                       <xhtml:span>
                                          <xhtml:span>
                                             <xhtml:br/>
                                          </xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:div>
                                 <xhtml:p>
                                    <xhtml:br/>
                                 </xhtml:p>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*ftp[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'ftp' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*ftp[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.36_etcinetd.conf_-_chargen" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - chargen</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>chargen </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This service is used to test the integrity of TCP/IP packets arriving at the destination.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This <xhtml:span class="inline_block">
                        <xhtml:span>chargen </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is </xhtml:span>
                  <xhtml:span>a character generator service and is used for testing the integrity of TCP/IP packets arriving at the destination. An attacker may spoof packets between machines running the </xhtml:span>
                  <xhtml:span>chargen</xhtml:span>
                  <xhtml:span> service and thus provide an opportunity for DoS </xhtml:span>
                  <xhtml:span>attacks. You must disable this service unless you are testing your network.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">chargen </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entries:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:div>
                                          <xhtml:code class="pre_0.5790491602408191">
                                             <xhtml:span>
                                                <xhtml:span class="inline_block">
                                                   <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'chargen' -p 'tcp'</xhtml:span>
                                                   <xhtml:br/>
                                                   <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'chargen' -p 'udp'</xhtml:span>
                                                </xhtml:span>
                                             </xhtml:span>
                                          </xhtml:code>
                                          <xhtml:p> </xhtml:p>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*chargen[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'chargen' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*chargen[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.37_etcinetd.conf_-_discard" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - discard</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>discard </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This service is used as a debugging tool by setting up a listening socket which ignores the data it receives.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>discard </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used as a debugging and measurement tool. It sets up a listening socket and ignores data that it receives. This is a </xhtml:span>
                  <xhtml:span>/dev/null</xhtml:span>
                  <xhtml:span> service and is obsolete. This can be used in DoS attacks and therefore, must be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span class="inline_block">discard </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entries:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:div>
                                          <xhtml:code class="pre_0.8257631046763232">
                                             <xhtml:span>
                                                <xhtml:span class="inline_block">
                                                   <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'discard' -p 'tcp'</xhtml:span>
                                                   <xhtml:br/>
                                                   <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'discard' -p 'udp'</xhtml:span>
                                                </xhtml:span>
                                             </xhtml:span>
                                          </xhtml:code>
                                          <xhtml:p>
                                             <xhtml:br/>
                                          </xhtml:p>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*discard[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'discard' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*discard[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.38_etcinetd.conf_-_dtspc" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - dtspc</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>dtspc </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This service is used in response to a CDE client request. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>dtspc </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service deals with the CDE interface of the X11 daemon. It is started automatically by the <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon in response to a CDE client requesting a process to be started on the daemon's host. This makes it vulnerable to buffer overflow attacks, which may allow an attacker to gain root privileges on a host. This service must be disabled unless it is absolutely required. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span class="inline_block">dtspc </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:div>
                                          <xhtml:code class="pre_0.9786367980493522">
                                             <xhtml:span>
                                                <xhtml:span class="inline_block">
                                                   <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'dtspc' -p 'tcp'</xhtml:span>
                                                </xhtml:span>
                                             </xhtml:span>
                                          </xhtml:code>
                                          <xhtml:p>
                                             <xhtml:span>
                                                <xhtml:span>
                                                   <xhtml:span>
                                                      <xhtml:br/>
                                                   </xhtml:span>
                                                </xhtml:span>
                                             </xhtml:span>
                                          </xhtml:p>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                                 <xhtml:p>
                                    <xhtml:br/>
                                 </xhtml:p>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*dtspc[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'dtspc' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*dtspc[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.39_etcinetd.conf_-_echo" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - echo</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>echo </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This service sends </xhtml:span>
                  <xhtml:span>back data received by it on a specified port.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>echo </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service sends </xhtml:span>
                  <xhtml:span>back data received by it on a specified port. This can be misused by an attacker to launch DoS attacks or Smurf attacks by initiating a data storm and causing network congestion. The service is used for testing purposes and therefore must be disabled if not required.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">echo </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entries:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:div>
                                          <xhtml:div>
                                             <xhtml:code class="pre_0.8178194958743157">
                                                <xhtml:span>
                                                   <xhtml:span class="inline_block">
                                                      <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'echo' -p 'tcp'</xhtml:span>
                                                      <xhtml:br/>
                                                      <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'echo' -p 'udp'</xhtml:span>
                                                   </xhtml:span>
                                                </xhtml:span>
                                             </xhtml:code>
                                             <xhtml:p>
                                                <xhtml:br/>
                                             </xhtml:p>
                                          </xhtml:div>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*echo[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'echo' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*echo[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.40_etcinetd.conf_-_pcnfsd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - pcnfsd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>pcnfsd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This service </xhtml:span>
                  <xhtml:span>is an authentication and printing program, which uses NFS to provide file transfer services</xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">pcnfsd </xhtml:span>service is an authentication and printing program, which uses NFS to provide file transfer services. This service is vulnerable and exploitable and permits the machine to be compromised both locally and remotely. If PC NFS clients are required within the environment, Samba is recommended as an alternative software solution. The <xhtml:span class="inline_block">pcnfsd </xhtml:span>daemon predates Microsoft's release of SMB specifications. This service should therefore be disabled.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">
                              <xhtml:span class="inline_block">pcnfsd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:div>
                                          <xhtml:code class="pre_0.4824237561442665">
                                             <xhtml:span>
                                                <xhtml:span class="inline_block">
                                                   <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'pcnfsd' -p 'udp'</xhtml:span>
                                                </xhtml:span>
                                             </xhtml:span>
                                          </xhtml:code>
                                          <xhtml:p> </xhtml:p>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*pcnfsd[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'pcnfsd' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*pcnfsd[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.41_etcinetd.conf_-_rstatd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - rstatd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>rstatd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This service </xhtml:span>
                  <xhtml:span>is used to provide kernel statistics and other monitorable parameters suc</xhtml:span>
                  <xhtml:span>h as CPU usage, system uptime, n</xhtml:span>
                  <xhtml:span>etwork usage</xhtml:span>
                  <xhtml:span> etc.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>rstatd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>is used to provide kernel statistics and other monitorable parameters pertinent to the system such as: CPU usage, system uptime, network usage etc. An attacker may use this information in a DoS attack. This service should be disabled. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">rstat<xhtml:span class="inline_block">
                                 <xhtml:span class="inline_block">d </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:div>
                                          <xhtml:div>
                                             <xhtml:div>
                                                <xhtml:code class="pre_0.7640234475073908">
                                                   <xhtml:span>
                                                      <xhtml:span class="inline_block">
                                                         <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'rstatd' -p 'udp'</xhtml:span>
                                                      </xhtml:span>
                                                   </xhtml:span>
                                                </xhtml:code>
                                                <xhtml:p> </xhtml:p>
                                             </xhtml:div>
                                          </xhtml:div>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                                 <xhtml:p>
                                    <xhtml:br/>
                                 </xhtml:p>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*rstatd[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'rstatd' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*rstatd[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.42_etcinetd.conf_-_rusersd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - rusersd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>rsusersd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This service </xhtml:span>
                  <xhtml:span>provides a list of current users active on a</xhtml:span>
                  <xhtml:span> system.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>rusersd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>runs as <xhtml:span class="inline_block">root </xhtml:span>and provides a list of current users active on a system. An attacker may use this service to learn valid account names on the system. This is not an essential service and should be disabled</xhtml:span>
                  <xhtml:span>.</xhtml:span>
                  <xhtml:span> </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">rusers<xhtml:span class="inline_block">
                                 <xhtml:span class="inline_block">d </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:div>
                                          <xhtml:div>
                                             <xhtml:div>
                                                <xhtml:div>
                                                   <xhtml:code class="pre_0.5289669728894257">
                                                      <xhtml:span>
                                                         <xhtml:span class="inline_block">
                                                            <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'rusersd' -p 'udp'</xhtml:span>
                                                         </xhtml:span>
                                                      </xhtml:span>
                                                   </xhtml:code>
                                                   <xhtml:p> </xhtml:p>
                                                </xhtml:div>
                                             </xhtml:div>
                                          </xhtml:div>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                                 <xhtml:p>
                                    <xhtml:br/>
                                 </xhtml:p>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*rusersd[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'rusersd' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*rusersd[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.43_etcinetd.conf_-_rwalld" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - rwalld</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>rwalld </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This service </xhtml:span>
                  <xhtml:span>allows remote users to broadcast system wide messages.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>rwalld </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service allows remote users to broadcast system wide messages. The service runs as root and should be disabled unless absolutely necessary. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, comment out the <xhtml:span class="inline_block">rwall<xhtml:span class="inline_block">
                                 <xhtml:span class="inline_block">d </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:div>
                                    <xhtml:div>
                                       <xhtml:div>
                                          <xhtml:div>
                                             <xhtml:div>
                                                <xhtml:div>
                                                   <xhtml:div style="padding-bottom: 1pt; padding-left: 4pt; padding-right: 4pt; background: #ddd9c3; padding-top: 1pt; mso-border-alt: solid windowtext .5pt; mso-element: para-border-div; border: windowtext 1pt solid;">
                                                      <xhtml:p class="CISC0de" style="margin: 0cm 0cm 0pt;">
                                                         <xhtml:span>
                                                            <xhtml:span style="font-size: small;">
                                                               <xhtml:span style="color: #000000;">
                                                                  <xhtml:span style="font-family: Courier New;">chsubserver -r inetd -C /etc/inetd.conf -d<xhtml:span style="mso-spacerun: yes;"> </xhtml:span>-v 'rwalld' -p 'udp'</xhtml:span>
                                                               </xhtml:span>
                                                            </xhtml:span>
                                                         </xhtml:span>
                                                      </xhtml:p>
                                                   </xhtml:div>
                                                   <xhtml:p>
                                                      <xhtml:br/>
                                                   </xhtml:p>
                                                </xhtml:div>
                                             </xhtml:div>
                                          </xhtml:div>
                                       </xhtml:div>
                                    </xhtml:div>
                                 </xhtml:div>
                                 <xhtml:p>
                                    <xhtml:br/>
                                 </xhtml:p>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*rwalld[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'rwalld' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*rwalld[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.44_etcinetd.conf_-_sprayd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - sprayd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>sprayd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon </xhtml:span>
                  <xhtml:span>when required. This service </xhtml:span>
                  <xhtml:span>is used as a tool to generate UDP packets for testing and diagnosing network problems.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>sprayd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used as a tool to generate UDP packets for testing and diagnosing network problems. The service must be disabled if you are not running NFS, as it can be used by attackers in a Distributed Denial of Service (DDoS) attack.</xhtml:span>
                  <xhtml:span> </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">sprayd </xhtml:span>entry: </xhtml:p>
                     <xhtml:code class="pre_0.7493753926854675">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                              <xhtml:span>-v 'sprayd' -p 'udp'</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*sprayd[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'sprayd' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*sprayd[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.45_etcinetd.conf_-_klogin" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - klogin</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>klogin</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This </xhtml:span>
                  <xhtml:span>is a kerberized login service, which provides a higher degree of security over traditional <xhtml:span class="inline_block">
                        <xhtml:span>rlogin </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>telnet</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>klogin </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>offers a higher degree of security than traditional </xhtml:span>
                  <xhtml:span>rlogin</xhtml:span>
                  <xhtml:span>or </xhtml:span>
                  <xhtml:span>telnet</xhtml:span>
                  <xhtml:span>by eliminating most clear-text password exchanges on the network. However, it is still not as secure as SSH, which encrypts all traffic. If you use </xhtml:span>
                  <xhtml:span>klogin</xhtml:span>
                  <xhtml:span>to login to a system, the password is not sent in clear text; however, if you </xhtml:span>
                  <xhtml:span>su</xhtml:span>
                  <xhtml:span>to another user, that password exchange is open to detection from network-sniffing programs. The recommendation is to utilize SSH wherever possible instead of </xhtml:span>
                  <xhtml:span>klogin</xhtml:span>
                  <xhtml:span>.<xhtml:br/>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;"> </xhtml:p>
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If the <xhtml:span class="inline_block">
                        <xhtml:span>klogin </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used, you must use the latest kerberos version available and make sure that all the latest patches are installed. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">klogin </xhtml:span>entry: </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.21479561549551523">
                           <xhtml:span>
                              <xhtml:span>
                                 <xhtml:span>
                                    <xhtml:span>
                                       <xhtml:span class="inline_block">
                                          <xhtml:span>
                                             <xhtml:span>
                                                <xhtml:span>
                                                   <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                                </xhtml:span>
                                             </xhtml:span>
                                          </xhtml:span>
                                          <xhtml:span>
                                             <xhtml:span>
                                                <xhtml:span>
                                                   <xhtml:span>-v 'klogin' -p 'tcp'</xhtml:span>
                                                </xhtml:span>
                                             </xhtml:span>
                                          </xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*klogin[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'klogin' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*klogin[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.46_etcinetd.conf_-_kshell" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - kshell</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>kshell </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This </xhtml:span>
                  <xhtml:span>is a kerberized remote shell service, which provides a higher degree of security over traditional <xhtml:span class="inline_block">
                        <xhtml:span>rsh</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>kshell </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>offers a higher degree of security than traditional </xhtml:span>
                  <xhtml:span>rsh</xhtml:span>
                  <xhtml:span> services. However, it still does not use encrypted communications. The recommendation is to utilize SSH wherever possible instead of <xhtml:span class="inline_block">
                        <xhtml:span>kshell</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.<xhtml:br/>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If the <xhtml:span class="inline_block">
                        <xhtml:span>kshell </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service is used, you should use the latest kerberos version available and must make sure that all the latest patches are installed. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">kshell </xhtml:span>entry: </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9754971796804668">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d </xhtml:span>
                                 <xhtml:span>-v 'kshell' -p 'tcp'</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*kshell[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'kshell' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*kshell[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.47_etcinetd.conf_-_rquotad" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - rquotad</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>rquotad </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. This allows NFS clients to enforce disk quotas on locally mounted filesystems.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>rquotad </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service</xhtml:span>
                  <xhtml:span>allows NFS clients to enforce disk quotas on file systems that are mounted on the local system. This service should be disabled if it is not required.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">rquotad </xhtml:span>entry: </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:code class="pre_0.5386257788557792">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'rquotad' -p 'udp'</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:br/>
                           </xhtml:p>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*rquotad[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'rquotad' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*rquotad[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.48_etcinetd.conf_-_tftp" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - tftp</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>tftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>allows remote systems to download or upload files to the <xhtml:span class="inline_block">
                        <xhtml:span>tftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>server</xhtml:span>
                  <xhtml:span> without any authentication. It is therefore a service that should not run, unless needed. One of the main reasons for requiring this service to be activated is if the host is a NIM master. However, the service can be enabled and then disabled once a NIM operation has completed, rather than left running permanently.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">tftp </xhtml:span>entry: </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:code class="pre_0.7277356257299161">
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'tftp' -p 'udp'</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:code>
                              <xhtml:p>
                                 <xhtml:br/>
                                 <xhtml:br/>
                              </xhtml:p>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*tftp[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'tftp' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*tftp[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.49_etcinetd.conf_-_imap2" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - imap2</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>imap2 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>imap2 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service or</xhtml:span>
                  <xhtml:span>Internet Message Access Protocol (IMAP) supports the IMAP4 remote mail access protocol. It works with <xhtml:span class="inline_block">
                        <xhtml:span>sendmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>bellmail</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>This service should be disabled if it is not required.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">imap2 </xhtml:span>entry: </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:div>
                                 <xhtml:code class="pre_0.650431836972402">chsubserver -r inetd -C /etc/inetd.conf -d -v 'imap2' -p 'tcp' </xhtml:code>
                              </xhtml:div>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*imap2[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'imap2' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*imap2[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.50_etcinetd.conf_-_pop3" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - pop3</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>pop3 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>pop3 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>provides a</xhtml:span>
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>pop3 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>server. It supports the <xhtml:span class="inline_block">
                        <xhtml:span>pop3 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>remote mail access protocol. </xhtml:span>
                  <xhtml:span>It works with <xhtml:span class="inline_block">
                        <xhtml:span>sendmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>bellmail</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>This service should be disabled if it is not required.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">pop3 </xhtml:span>entry: </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.39552612187935765">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'pop3' -p 'tcp'</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*pop3[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'pop3' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*pop3[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.51_etcinetd.conf_-_finger" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - finger</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>fingerd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>fingerd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon provides the server function for the <xhtml:span class="inline_block">
                        <xhtml:span>finger </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>command. This a</xhtml:span>
                  <xhtml:span>llows users to view real-time pertinent user login information on other remote systems. This service should be disabled as it may provide an attacker with a valid user list to target. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">finger </xhtml:span>entry: </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:code class="pre_0.9615422462037026">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'finger' -p 'tcp'</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p> </xhtml:p>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*finger[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'finger' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*finger[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.52_etcinetd.conf_-_instsrv" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - instsrv</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This entry starts the <xhtml:span class="inline_block">
                        <xhtml:span>instsrv </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>when required. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>instsrv </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service </xhtml:span>
                  <xhtml:span>is part of the Network Installation Tools, used for servicing servers running AIX 3.2. </xhtml:span>
                  <xhtml:span>This service should be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, comment out the <xhtml:span class="inline_block">instsrv </xhtml:span>entry: </xhtml:p>
                     <xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:code class="pre_0.25181079171264875">
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>chsubserver -r inetd -C /etc/inetd.conf -d -v 'instsrv' -p 'tcp'</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:code>
                              <xhtml:p>
                                 <xhtml:br/>
                                 <xhtml:br/>
                              </xhtml:p>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*instsrv[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'instsrv' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*instsrv[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3.53_etcinetd.conf_-_permissions_and_ownership" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/inetd.conf - permissions and ownership</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommended permissions and ownership for <xhtml:span class="inline_block">
                        <xhtml:span>/etc/inetd.conf </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>are applied.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The<xhtml:span class="inline_block">
                        <xhtml:span>/etc/inetd.conf </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file contains the list of services that <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>controls and determines their current status i.e. active or disabled. This file must be protected from unauthorized access and modifications to ensure that the services disabled in this benchmark remain locked down. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Set the recommended permissions and ownership to <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5276133149239474">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chmod u=rw,go=r /etc/inetd.conf</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chown root:system /etc/inetd.conf</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/inetd.conf' exists">
                           <ecl:command>if [ ! -e "/etc/inetd.conf" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/inetd.conf against the provided permissions (0133).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions of '/etc/inetd.conf' are 'u-x,go-wx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/inetd.conf 0133</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/inetd.conf' exists">
                           <ecl:command>if [ ! -e "/etc/inetd.conf" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/inetd.conf
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/etc/inetd.conf' is 'root:system'">
                           <ecl:command>ls -l /etc/inetd.conf | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.4_AIX_Security_Expert_-_Disabling_Remote_Services">
         <xccdf:title xml:lang="en">AIX Security Expert - Disabling Remote Services</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section provides guidance on the local disablement of remote system services. In the previous section, recommendations were made to disable the remote services in <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>. This stops the server from accepting connections, but the binaries to initiate remote connections from the server to another host should also be restricted along with the daemons themselves being fully disabled. There are also many known security vulnerabilities that relate to these services, they are a primary target for any DoS attack.<xhtml:br/>It is recommended that, unless otherwise required, that the following services and daemons will have their execute permissions removed:<xhtml:br/>
               <xhtml:span class="inline_block">/usr/bin/rcp <xhtml:br/>/usr/bin/rlogin<xhtml:br/>/usr/bin/rsh<xhtml:br/>/usr/sbin/rlogind<xhtml:br/>/usr/sbin/rshd</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4.1_Remote_command_lockdown" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Remote command lockdown</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>Removes all permissions from the remote service commands: <xhtml:span class="inline_block">
                        <xhtml:span>rsh</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, <xhtml:span class="inline_block">
                        <xhtml:span>rlogin </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>rcp</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>This effectively disables the following commands, for all users:<xhtml:br/>
                  <xhtml:span class="inline_block">/usr/bin/rcp<xhtml:br/>/usr/bin/rlogin<xhtml:br/>/usr/bin/rsh<xhtml:br/>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p>These remote services send usernames and passwords in clear text and should not be used. Unless required these binaries will be disabled for all users. The SSH suite of commands should be utilized to provide equivalent functionality</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Use the <xhtml:span class="inline_block">
                              <xhtml:span>chmod </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>command to remove all permissions on the remote services:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.800392150925934">
                           <xhtml:span class="inline_block">chmod ugo= /usr/bin/rcp<xhtml:br/>chmod ugo= /usr/bin/rlogin<xhtml:br/>chmod ugo= /usr/bin/rsh</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/bin/rcp' exists">
                           <ecl:command>if [ ! -e "/usr/bin/rcp" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/bin/rcp against the provided permissions (0777).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'rcp' has no permissions">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/bin/rcp 0777</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/bin/rlogin' exists">
                           <ecl:command>if [ ! -e "/usr/bin/rlogin" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/bin/rlogin against the provided permissions (0777).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'rlogin' has no permissions">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/bin/rlogin 0777</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/bin/rsh' exists">
                           <ecl:command>if [ ! -e "/usr/bin/rsh" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/bin/rsh against the provided permissions (0777).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'rsh' has no permissions">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/bin/rsh 0777</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4.2_Remote_daemon_lockdown" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Remote daemon lockdown</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Removes all permissions from the remote service daemons: , <xhtml:span class="inline_block">rlogind, rshd </xhtml:span>and also <xhtml:span class="inline_block">tftpd</xhtml:span>. </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>This effectively disables the following daemons, for all users:<xhtml:br/>
                  <xhtml:span class="inline_block">/usr/sbin/rlogind<xhtml:br/>/usr/sbin/rshd<xhtml:br/>/usr/sbin/tftpd</xhtml:span>
               </xhtml:p>
               <xhtml:p>These remote services both send and receive usernames and passwords in clear text and should not be used. Unless required these daemons will be disabled for all users.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Use the <xhtml:span class="inline_block">
                              <xhtml:span>chmod </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>command to remove all permissions on the remote services:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.33501897892214705">
                           <xhtml:span class="inline_block">chmod ugo= /usr/sbin/rlogind<xhtml:br/>chmod ugo= /usr/sbin/rshd<xhtml:br/>chmod ugo= /usr/sbin/tftpd</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/sbin/rlogind' exists">
                           <ecl:command>if [ ! -e "/usr/sbin/rlogind" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/sbin/rlogind against the provided permissions (0777).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'rlogind' has no permissions">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/sbin/rlogind 0777</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/sbin/rshd' exists">
                           <ecl:command>if [ ! -e "/usr/sbin/rshd" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/sbin/rshd against the provided permissions (0777).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'rshd' has no permissions">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/sbin/rshd 0777</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/sbin/tftpd' exists">
                           <ecl:command>if [ ! -e "/usr/sbin/tftpd" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/sbin/tftpd against the provided permissions (0777).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'tftpd' has no permissions">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/sbin/tftpd 0777</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.5_AIX_Security_Expert_-_Automated_Authentication">
         <xccdf:title xml:lang="en">AIX Security Expert - Automated Authentication</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p class="CISNormal" style="margin: 0cm 0cm 12pt;">
               <xhtml:span>This section provides guidance on the removal of <xhtml:span class="inline_block">
                     <xhtml:span>.nertrc</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>, <xhtml:span class="inline_block">
                     <xhtml:span>.rhosts</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>files and <xhtml:span class="inline_block">
                     <xhtml:span>/etc/hosts.equiv </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>entries. The existence of these files could allow remote access to the system without user or password authentication. </xhtml:span>
               <xhtml:span>It is recommended, that unless otherwise required, any such files are removed from all home directories on the system. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5.1_Removal_of_.rhosts_and_.netrc_files" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Removal of .rhosts and .netrc files</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This recommendation removes all instances of <xhtml:strong>
                        <xhtml:span class="inline_block">.rhosts </xhtml:span>
                     </xhtml:strong>
                  </xhtml:span>
                  <xhtml:span>and<xhtml:span class="inline_block">
                        <xhtml:span>.netrc </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>files from the system. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>.rhosts</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> and <xhtml:span class="inline_block">
                        <xhtml:span>.netrc</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> files can be used to circumvent normal login or change control procedures. The existence of such files, with the relevant entries, can allow remote user access to a system bypassing local user and password authentication</xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>Unless required these files will be removed from all user home directories. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove the<xhtml:span class="inline_block">
                              <xhtml:span>.rhosts </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and <xhtml:span class="inline_block">
                              <xhtml:span>.netrc </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>files from all user home directories:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.9280658667201034">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>find / -name </xhtml:span>"<xhtml:span>.netrc</xhtml:span>"<xhtml:span> -exec rm {} \;</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>find / -name </xhtml:span>"<xhtml:span>.rhosts</xhtml:span>"<xhtml:span> -exec rm {} \;</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="none exist" comment="Ensure all '.netrc' files are removed from the system">
                        <ecl:command>find / -name ".netrc" -print</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="none exist" comment="Ensure all '.rhosts' files are removed from the system">
                        <ecl:command>find / -name ".rhosts" -print</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5.2_Removal_of_entries_from_etchosts.equiv" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Removal of entries from /etc/hosts.equiv</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This process removes all entries from the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.equiv </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.equiv </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file can be used to circumvent normal login or change control procedures. The existence of this file, with the relevant entries, can allow remote user access to a system bypassing local user and password authentication</xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>Unless required all entries will be removed from this file. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Remove all entries from the <xhtml:span class="inline_block">/etc/hosts.equiv </xhtml:span>file:</xhtml:p>
                     <xhtml:code class="pre_0.4267227214984803">
                        <xhtml:span class="inline_block">sed '/^\s*$/d; s/^\(\s*[^#].*\)/#\1/' /etc/hosts.equiv &gt; /etc/hosts.equiv.work<xhtml:br/>mv hosts.equiv.work hosts.equiv<xhtml:br/>chown root:system /etc/hosts.equiv<xhtml:br/>chmod 644 /etc/hosts.equiv </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>Note: the above command removes blank lines and comments out any non commented entries.</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that all hosts entries are commented out in '/etc/hosts.equiv'">
                     <ecl:command>[[ ! -f /etc/hosts.equiv ]] &amp;&amp; RC=0 || grep -v "^\s*#" /etc/hosts.equiv </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.6_AIX_Security_Expert_-_TCPIP_Hardening">
         <xccdf:title xml:lang="en">AIX Security Expert - TCP/IP Hardening</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
               <xhtml:span>This section of the benchmark will focus on the hardening of standard TCP/IP tuning parameters. </xhtml:span>
               <xhtml:span>This is particularly important for the security of the system as the risk of SYN, source routing and smurf attacks can all be significantly reduced or eliminated by following the recommendations in this section. It is anticipated that any firewalls will also be configured to safeguard against these types of attack.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.1_TCPIP_Tuning_-_ipsrcrouteforward" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - ipsrcrouteforward</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipsrcrouteforward </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether or not the system forwards IPV4 source-routed packets.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipsrcrouteforward </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>ipsrcrouteforward </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>ipsrcrouteforward</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o ipsrcrouteforward'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'ipsrcrouteforward' is set to '0'">
                     <ecl:command>no -o ipsrcrouteforward</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.2_TCPIP_Tuning_-_ipignoreredirects" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - ipignoreredirects</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipignoreredirects </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether or not the system will process IP redirects.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipignoreredirects</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>will be set to 1, to prevent IP re-directs being processed by the system. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>ipignoreredirects </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>ipignoreredirects</xhtml:span>
                                    </xhtml:span>=1</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o ipignoreredirects'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'ipignoreredirects' is set to '1'">
                     <ecl:command>no -o ipignoreredirects</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.3_TCPIP_Tuning_-_clean_partial_conns" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - clean_partial_conns</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>clean_partial_conns</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> parameter determines whether or not the system is open to SYN attacks. This parameter, when enabled, clears down connections in the SYN RECEIVED state after a set period of time. This attempts to stop DoS attacks when a hacker may flood a system with SYN flag set packets.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>clean_partial_conns</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 1, to clear down pending SYN received connections after a set period of time.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span style="font-family: Courier New; font-size: small;">clean_partial_conns</xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o clean_partial_conns=1</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o clean_partial_conns'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'clean_partial_conns' is set to '1'">
                     <ecl:command>no -o clean_partial_conns</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.4_TCPIP_Tuning_-_ipsrcroutesend" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - ipsrcroutesend</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipsrcroutesend </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether or not the system can send source-routed packets. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipsrcroutesend </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 0, to ensure that any local applications cannot send source routed packets.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>ipsrcroutesend</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>ipsrcroutesend</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o ipsrcroutesend'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'ipsrcroutesend' is set to '0'">
                     <ecl:command>no -o ipsrcroutesend</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.5_TCPIP_Tuning_-_ipforwarding" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - ipforwarding</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipforwarding </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether or not the system forwards TCP/IP packets.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipforwarding </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 0, to ensure that redirected packets do not reach remote networks. This should only be enabled if the system is performing the function of an IP router. This is typically handled by a dedicated network device. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>ipforwarding </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>ipforwarding</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o ipforwarding'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'ipforwarding' is set to '0'">
                     <ecl:command>no -o ipforwarding</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.6_TCPIP_Tuning_-_ipsendredirects" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - ipsendredirects</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipsendredirects </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether or not the system forwards re-directed TCP/IP packets.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipsendredirects </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 0, to ensure that redirected packets do not reach remote networks. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the</xhtml:span>
                        <xhtml:span class="inline_block">
                           <xhtml:span>ipsendredirects</xhtml:span>
                           <xhtml:span>
                              <xhtml:span style="font-family: 'Cambria','serif'; font-size: 12pt; mso-fareast-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">
                                 <xhtml:span style="color: #000000;"> </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>ipsendredirects</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o ipsendredirects'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'ipsendredirects' is set to '0'">
                     <ecl:command>no -o ipsendredirects</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.7_TCPIP_Tuning_-_ip6srcrouteforward" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - ip6srcrouteforward</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ip6srcrouteforward </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether or not the system forwards IPV6 source-routed packets.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ip6srcrouteforward </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>ip6srcrouteforward</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>ip6srcrouteforward</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o ip6srcrouteforward'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'ip6srcrouteforward' is set to '0'">
                     <ecl:command>no -o ip6srcrouteforward</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.8_TCPIP_Tuning_-_directed_broadcast" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - directed_broadcast</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>directed_broadcast </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether or not the system allows a directed broadcast to a network gateway.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>directed_broadcast </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter will be set to 0, to prevent directed broadcasts being sent network gateways. This would prevent a redirected packet from reaching a remote network. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span style="font-family: Courier New; font-size: small;">directed_broadcast</xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o directed_broadcast=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o directed_broadcast'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'directed_broadcast' is set to '0'">
                     <ecl:command>no -o directed_broadcast</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.9_TCPIP_Tuning_-_tcp_pmtu_discover" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - tcp_pmtu_discover</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_pmtu_discover</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> parameter controls whether TCP MTU discovery is enabled.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_pmtu_discover </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks. This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When <xhtml:span class="inline_block">
                        <xhtml:span>tcp_pmtu_discover</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> is enabled, it leaves the system vulnerable to source routing attacks.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>tcp_pmtu_discover</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>tcp_pmtu_discover</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o tcp_pmtu_discover'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'tcp_pmtu_discover' is set to '0'">
                     <ecl:command>no -o tcp_pmtu_discover</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.10_TCPIP_Tuning_-_bcastping" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - bcastping</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>bcastping </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether the system responds to ICMP echo packets sent to the broadcast address.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>bcastping </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter</xhtml:span>
                  <xhtml:span>will be set to 0. This means that the system will not respond to ICMP packets sent to the broadcast address. By default, when this is enabled the system is susceptible to smurf attacks, where a hacker utilizes this tool to send a small number of ICMP echo packets. These packets can generate huge numbers of ICMP echo replies and seriously affect the performance of the targeted host and network. This parameter will be disabled to ensure protection from this type of attack.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span style="font-family: Courier New; font-size: small;">bcastping</xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o bcastping=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o bcastping'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'bcastping' is set to '0'">
                     <ecl:command>no -o bcastping</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.11_TCPIP_Tuning_-_icmpaddressmask" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - icmpaddressmask</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>icmpaddressmask </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether the system responds to an ICMP address mask ping.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>icmpaddressmask </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 0, This means that the system will not respond to ICMP address mask request pings. By default, when this is enabled the system is susceptible to source routing attacks. This is typically a feature performed by a device such as a network router and should not be enabled within the operating system.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span style="font-family: Courier New; font-size: small;">icmpaddressmask</xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o icmpaddressmask=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o icmpaddressmask'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'icmpaddressmask' is set to '0'">
                     <ecl:command>no -o icmpaddressmask</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.12_TCPIP_Tuning_-_udp_pmtu_discover" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - udp_pmtu_discover</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>udp_pmtu_discover</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> parameter controls whether MTU discovery is enabled.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>udp_pmtu_</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>discover </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks. This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When <xhtml:span class="inline_block">
                        <xhtml:span>udp_pmtu_discover </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is enabled, it leaves the system vulnerable to source routing attacks.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>udp_pmtu_discover</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>udp_pmtu_discover</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o udp_pmtu_discover'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'udp_pmtu_discover' is set to '0'">
                     <ecl:command>no -o udp_pmtu_discover</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.13_TCPIP_Tuning_-_ipsrcrouterecv" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - ipsrcrouterecv</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipsrcrouterecv </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether the system accepts source routed packets.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>ipsrcrouterecv </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 0, This means that the system will not accept source routed packets. By default, when this is enabled the system is susceptible to source routing attacks. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>ipsrcrouterecv</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>ipsrcrouterecv</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o ipsrcrouterecv'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'ipsrcrouterecv' is set to '0'">
                     <ecl:command>no -o ipsrcrouterecv</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.14_TCPIP_Tuning_-_nonlocsrcroute" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - nonlocsrcroute</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>nonlocsrcroute </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether the system allows source routed packets to be addressed to hosts outside of the LAN. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>nonlocsrcroute </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 0. This means that the system will not allow source routed packets to be addressed to hosts outside of the LAN. By default, when this is enabled the system is susceptible to source routing attacks. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>nonlocsrcroute</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>nonlocsrcroute</xhtml:span>
                                    </xhtml:span>=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o nonlocsrcroute'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'nonlocsrcroute' is set to '0'">
                     <ecl:command>no -o nonlocsrcroute</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="0"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.15_TCPIP_Tuning_-_tcp_tcpsecure" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - tcp_tcpsecure</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_tcpsecure</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> parameter value determines if the system is protected from three specific vulnerabilities:</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>Fake SYN - This is used to terminate an established connection. A <xhtml:span class="inline_block">
                        <xhtml:span>tcp_tcpsecure </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>value of </xhtml:span>
                  <xhtml:span>1 </xhtml:span>
                  <xhtml:span>protects the system from this vulnerability. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>Fake RST - As above, this is used to terminate an established connection. A <xhtml:span class="inline_block">
                        <xhtml:span>tcp_tcpsecure </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>value of </xhtml:span>
                  <xhtml:span>2</xhtml:span>
                  <xhtml:span> protects the system from this vulnerability.</xhtml:span>
               </xhtml:p>
               <xhtml:p class="CISRuleComponent" style="margin: 8pt 0cm 0pt;">
                  <xhtml:span>Fake data - A hacker may inject fake data into an established connection. A <xhtml:span class="inline_block">tcp_tcpsecure </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>value of </xhtml:span>
                  <xhtml:span>4 </xhtml:span>
                  <xhtml:span>protects the system from this vulnerability.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_tcpsecure </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter</xhtml:span>
                  <xhtml:span>will be set to </xhtml:span>
                  <xhtml:span>7</xhtml:span>
                  <xhtml:span>. This means that the system will be protected from any connection reset and data integrity attacks. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add </xhtml:span>the <xhtml:span class="inline_block">
                           <xhtml:span>tcp_tcpsecure </xhtml:span>
                        </xhtml:span>entry:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>tcp_tcpsecure</xhtml:span>
                                    </xhtml:span>=7</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o tcp_tcpsecure'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 7
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Title: Ensure 'tcp_tcpsecure' is set to '7'">
                     <ecl:command>no -o tcp_tcpsecure</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="7"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.16_TCPIP_Tuning_-_sockthresh" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - sockthresh</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>sockthresh </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter value determines what percentage of the total memory allocated to networking, set via <xhtml:span class="inline_block">
                        <xhtml:span>thewall</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, can be used for sockets. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoBodyText" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The</xhtml:span>
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>sockthresh </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter</xhtml:span>
                  <xhtml:span>will be set to <xhtml:span class="inline_block">
                        <xhtml:span>60</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>This means that 60% of network memory can be used to service new socket connections, the remaining 40% is reserved for existing sockets. This ensures a quality of service for existing connections.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, </xhtml:span>add the <xhtml:span class="inline_block">sockthresh </xhtml:span>entry:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">sockthresh</xhtml:span>=60</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o sockthresh'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 60
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'sockthresh' is set to '60'">
                     <ecl:command>no -o sockthresh</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="60"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.17_TCPIP_Tuning_-_rfc1323" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - rfc1323</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>rfc1323 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter determines whether the TCP window sizes (<xhtml:span class="inline_block">
                        <xhtml:span>tcp_sendspace </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>tcp_recvspace</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>) can be greater than 64KB. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>rfc1323 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter</xhtml:span>
                  <xhtml:span>will be set to 1. This means that the system will allow the TCP windows sizes to exceed 64KB. This is a requirement for high performance networks, particularly those which utilize large MTU sizes.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, </xhtml:span>add the <xhtml:span class="inline_block">
                           <xhtml:span>rfc1323 </xhtml:span>
                        </xhtml:span>entry:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>rfc1323</xhtml:span>
                                    </xhtml:span>=1</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o rfc1323'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'rfc1323' is set to '1'">
                     <ecl:command>no -o rfc1323</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.18_TCPIP_Tuning_-_tcp_sendspace" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - tcp_sendspace</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_sendspace</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> parameter sets the socket buffer size for sending data. This recommendation changes the default size, but many adapters have specific buffer sizes implemented within the device driver. These are typically 64KB or greater.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_sendspace </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 262144. This means that the system default socket buffer size for sending data will be 262KB. This is the minimum recommendation for modern high performance networks.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>tcp_sendspace</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> entry:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>tcp_sendspace</xhtml:span>
                                    </xhtml:span>=262144</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o tcp_sendspace'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 262144
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'tcp_sendspace' is set to '262144'">
                     <ecl:command>no -o tcp_sendspace</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="262144"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.19_TCPIP_Tuning_-_tcp_recvspace" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - tcp_recvspace</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_recvspace</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> parameter sets the socket buffer size for receiving data. This recommendation changes the default size, but many adapters have specific buffer sizes implemented within the device driver. These are typically 64KB or greater.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_recvspace </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter</xhtml:span>
                  <xhtml:span>will be set to 262144. This means that the system default socket buffer size for receiving data will be 262KB. This is the minimum recommendation for modern high performance networks.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, </xhtml:span>add the <xhtml:span class="inline_block">
                           <xhtml:span>tcp_recvspace </xhtml:span>
                        </xhtml:span>entry:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>tcp_recvspace</xhtml:span>
                                    </xhtml:span>=262144</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o tcp_recvspace'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 262144
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'tcp_recvspace' is set to '262144'">
                     <ecl:command>no -o tcp_recvspace</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="262144"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.20_TCPIP_Tuning_-_tcp_mssdflt" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - tcp_mssdflt</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_mssdflt </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter sets the maximum segment size for communication to a remote network. This parameter is only relevant if MTU discovery is disabled, which is recommended in this benchmark.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>tcp_mssdflt </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter </xhtml:span>
                  <xhtml:span>will be set to 1448 . This value reflects the packet size minus the TCP/IP headers.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, </xhtml:span>add the <xhtml:span class="inline_block">
                           <xhtml:span>tcp_mssdflt </xhtml:span>
                        </xhtml:span>entry:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6686369975922121">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>no -p -o <xhtml:span class="inline_block">
                                       <xhtml:span>tcp_mssdflt</xhtml:span>
                                    </xhtml:span>=1448</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>This makes the change permanent by adding the entry into<xhtml:span class="inline_block">
                                 <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'no -o tcp_mssdflt'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1448
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'tcp_mssdflt' is set to '1448'">
                     <ecl:command>no -o tcp_mssdflt</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1448"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6.21_TCPIP_Tuning_-_nfs_use_reserved_ports" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP/IP Tuning - nfs_use_reserved_ports</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>portcheck </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>nfs_use_reserved_ports </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameters force the NFS server process on the local system to ignore NFS client requests that do not originate from the privileged ports range (ports less than 1024).</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>portcheck </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>nfs_use_reserved_ports </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameters </xhtml:span>
                  <xhtml:span>will both be set to 1. This value means that NFS client requests that do not originate from the </xhtml:span>
                  <xhtml:span>privileged ports range (ports less than 1024) will be ignored by the local system.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>In <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, add the <xhtml:span class="inline_block">
                              <xhtml:span>portcheck </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and <xhtml:span class="inline_block">
                              <xhtml:span>nfs_use_reserved_ports </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>entries:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.07900660329428849">
                        <xhtml:span class="inline_block">nfso -p -o portcheck=1 <xhtml:br/>nfso -p -o nfs_use_reserved_ports=1 </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:span>This makes the change permanent by adding the entry into <xhtml:span class="inline_block">
                              <xhtml:span>/etc/tunables/nextboot</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <!--
                                                           
                                    1. Run 'no -o portcheck'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                     <ecl:shell-command check="all" comment="Ensure 'portcheck' is set to '1'">
                        <ecl:command>nfso -o portcheck</ecl:command>
                        <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                           <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                        </ecl:line-selection>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <!--
                                                           
                                    1. Run 'no -o nfs_use_reserved_ports'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is equals 1
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                     <ecl:shell-command check="all" comment="Ensure 'nfs_use_reserved_ports ' is set to '1'">
                        <ecl:command>nfso -o nfs_use_reserved_ports</ecl:command>
                        <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                           <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                        </ecl:line-selection>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.7_AIX_Security_Expert_-_Miscellaneous_Enhancements">
         <xccdf:title xml:lang="en">AIX Security Expert - Miscellaneous Enhancements</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
               <xhtml:span>This section will detail some of the more generic changes made during the implementation of the customized XML file i.e. those which may not warrant a dedicated section. </xhtml:span>
            </xhtml:p>
            <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;"> </xhtml:p>
            <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">If the customized XML file has been used, the recommendations in this section are the final automated AIX Security Expert changes in this benchmark.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.1_Miscellaneous_Enhancements_-_crontab_access" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - crontab access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This change creates a <xhtml:span class="inline_block">cron.allow </xhtml:span>file with a root user entry and removes the <xhtml:span class="inline_block">cron.deny</xhtml:span> file, if it exists.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>This ensures that only the root user has the ability to create a crontab. A hacker may exploit use of the crontab to execute programs or processes automatically. Limiting access to the root account only reduces this risk.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Create the <xhtml:span class="inline_block">
                              <xhtml:span>/var/adm/cron/cron.allow </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>file and remove <xhtml:span class="inline_block">/var/adm/cron/cron.deny </xhtml:span>(if it exists):</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.4251909443780682">
                        <xhtml:span class="inline_block">print "root\nadm" &gt; /var/adm/cron/cron.allow</xhtml:span>
                        <xhtml:br/>
                        <xhtml:span class="inline_block">rm /var/adm/cron/cron.deny</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure that 'root' is added to 'cron.allow'">
                        <ecl:command>grep "^root$" /var/adm/cron/cron.allow</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="root"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure that 'adm' is added to 'cron.allow'">
                        <ecl:command>grep "^adm$" /var/adm/cron/cron.allow</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="adm"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.2_Miscellaneous_Enhancements_-_at_access" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - at access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This change creates an <xhtml:span class="inline_block">
                        <xhtml:span>at.allow</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file with a root user entry and removes the <xhtml:span class="inline_block">
                        <xhtml:span>at.deny </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file</xhtml:span>
                  <xhtml:span>, if it exists.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This ensures that only the root user has the ability to schedule jobs through the <xhtml:span class="inline_block">
                        <xhtml:span>at </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>command</xhtml:span>
                  <xhtml:span>. A hacker may exploit use of <xhtml:span class="inline_block">
                        <xhtml:span>at</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> to execute programs or processes automatically. Limiting access to the root account only reduces this risk.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:span>Create the <xhtml:span class="inline_block">
                                 <xhtml:span>/var/adm/cron/at.allow </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>file and remove <xhtml:span class="inline_block">/var/adm/cron/at.deny </xhtml:span>(if it exists):</xhtml:span>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.9710318674338165">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>
                                       <xhtml:span class="inline_block">
                                          <xhtml:span>echo </xhtml:span>"<xhtml:span>root</xhtml:span>"<xhtml:span> &gt; /var/adm/cron/at.allow</xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                    <xhtml:br/>
                                    <xhtml:span>
                                       <xhtml:span class="inline_block">
                                          <xhtml:span>rm /var/adm/cron/at.deny</xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure that 'root' is added to 'at.allow'">
                     <ecl:command>grep "^root$" /var/adm/cron/at.allow</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="root"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.3_Miscellaneous_Enhancements_-_etcftpusers" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - /etc/ftpusers</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This change adds the root user to the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ftpusers</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file, which disables <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>for root.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This change ensures that direct root <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>access is disabled. As detailed previously, <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>as a service should be disabled. If the service has to be enabled then this change must be implemented to ensure that remote root file transfer access is not enabled. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Add root to the <xhtml:span class="inline_block">
                              <xhtml:span>/etc/ftpusers</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.24778444456170573">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>echo </xhtml:span>"<xhtml:span>root</xhtml:span>"<xhtml:span> &gt;&gt; /etc/ftpusers</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure that 'root' is added to '/etc/ftpusers'">
                     <ecl:command>grep "^root$" /etc/ftpusers</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="root"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.4_Miscellaneous_Enhancements_-_login_herald" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - login herald</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This change adds a default herald to <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security/login.cfg</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This change puts into place a suggested login herald to replace the default entry. As the herald is presented to a user prior to logon, it should not provide any information about the operating system or version. Instead, it should detail a company standard acceptable use policy. This herald can be subsequently tailored to reflect a corporate standard policy.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Add a default login herald to <xhtml:span class="inline_block">
                              <xhtml:span>/etc/security/login.cfg:</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8425631221398635">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chsec -f /etc/security/login.cfg -s default -a herald="Unauthorized use of\</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span> </xhtml:span>
                                 <xhtml:span>this system is prohibited.\nlogin:"</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure that the login herald is not blank">
                     <ecl:command>lssec -f /etc/security/login.cfg -s default -a herald</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^default\sherald=&quot;...................."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.5_Miscellaneous_Enhancements_-_guest_account_removal" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - guest account removal</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This change removes the <xhtml:span class="inline_block">
                        <xhtml:span>guest </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>user and home directory from the system.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This change removes the <xhtml:span class="inline_block">
                        <xhtml:span>guest</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> user. If a user logs in with a generic username, audit trails are of limited value as it is not necessarily possible to identify who has accessed an account. The </xhtml:span>
                  <xhtml:span>guest </xhtml:span>
                  <xhtml:span>account should be removed and all users should be given specific logon ids to ensure traceability and accountability.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove the <xhtml:span class="inline_block">
                              <xhtml:span>guest </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>user:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.40392528473484823">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>rmuser -p guest</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>rm -r /home/guest</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure that the 'guest' user account is removed">
                     <ecl:command>grep -c "^guest:" /etc/passwd</ecl:command>
                     <ecl:line-selection dt="xs:integer" op="eq" value="0"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.6_Miscellaneous_Enhancements_-_crontab_permissions" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - crontab permissions</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This script checks the permissions of all the root <xhtml:span class="inline_block">
                        <xhtml:span>crontab </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>entries, to ensure that they are owned and writable by the root user only.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>All root <xhtml:span class="inline_block">
                        <xhtml:span>crontab </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>entries must be owned and writable by the root user only. If a script had group or world writable access, it could be replaced or edited with malicious content, which would then subsequently run on the system with root authority.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Ensure that all root </xhtml:span>
                        <xhtml:span>crontab</xhtml:span>
                        <xhtml:span> entries are owned and writable by root only.</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>The script below traverses up each individual directory path, ensuring that all directories are not group/world writable and that they are owned by the root or bin user:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.21485166744102801">
                           <xhtml:span class="inline_block">crontab -l |egrep -v '^#' |awk '{print $6}' |grep "^/" |sort -u | while read DIR<xhtml:br/>do<xhtml:br/>DIR=${DIR:-$(pwd)}<xhtml:br/>while [[ -a ${DIR} ]]<xhtml:br/>do<xhtml:br/>[[ "$(ls -ld ${DIR})" = @(????????w? *) ]] &amp;&amp; print " WARNING ${DIR} is world writable"<xhtml:br/>[[ "$(ls -ld ${DIR})" = @(?????w???? *) ]] &amp;&amp; print " WARNING ${DIR} is group writable"<xhtml:br/>[[ "$(ls -ld ${DIR} |awk '{print $3}')" != @(root|bin) ]] &amp;&amp; print " WARNING ${DIR} is not owned by root or bin"<xhtml:br/>DIR=${DIR%/*}<xhtml:br/>done <xhtml:br/>done</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Review the output and manually change the directories, if possible. Directories which are group and/or world writable or not owned by root are marked with "WARNING"</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:span>To manually change permissions on the files or directories:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>To remove group writable access:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.1632098308119037">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chmod g-w &lt;name&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>To remove world writable access:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.3135652043396094">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chmod o-w &lt;name&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>To remove both group and world writable access:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.1967613657644824">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chmod go-w &lt;name&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>To change the owner of a file or directory:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.12623827358269374">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chown &lt;new user&gt; &lt;name&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure all root crontab entries are owned and writable by root only">
                     <ecl:command>crontab -l |egrep -v '^#' |awk '{print $6}' |grep "^/" |sort -u | while read DIR; do DIR=${DIR:-$(pwd)}; while [[ -a ${DIR} ]]; do [[ "$(ls -ld ${DIR})" = @(????????w? *) ]] &amp;&amp; print " WARNING ${DIR} is world writable"; [[ "$(ls -ld ${DIR})" = @(?????w???? *) ]] &amp;&amp; print " WARNING ${DIR} is group writable"; [[ "$(ls -ld ${DIR} |awk '{print $3}')" != @(root|bin) ]] &amp;&amp; print " WARNING ${DIR} is not owned by root or bin"; DIR=${DIR%/*}; done; done</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.7_Miscellaneous_Enhancements_-_default_umask" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - default umask</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This changes the default user <xhtml:span class="inline_block">
                        <xhtml:span>umask </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>in <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security/user</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The default user <xhtml:span class="inline_block">
                        <xhtml:span>umask </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>will be set to 027. This means that the default file creation permissions give read and write access to the user, read access to the group and no access to other. The default directory creation permissions give read, write and execute access to the user, read and execute to the group and no access to other. This is the recommended <xhtml:span class="inline_block">
                        <xhtml:span>umask </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>setting, as world access should be explicitly defined and not added during default creation. Where possible, access to files and directories should be managed via group membership and ACL's, rather than opening up directory structures for world access. In particular, world write access should be avoided. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>Consideration should be given to further securing the default user</xhtml:span>
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>umask </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>by implementing 077. This means that only the user has read/write access to the files and directories they create. Group and/or world access would need to be explicitly defined.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>As part of this change all explicitly defined <xhtml:span class="inline_block">
                        <xhtml:span>umask </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>user settings are removed (if using the customized XML file). </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Add the <xhtml:span class="inline_block">
                              <xhtml:span>umask </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>attribute to the default user stanza in <xhtml:span class="inline_block">
                              <xhtml:span>/etc/security/user:</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.584197514506976">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chsec -f /etc/security/user -s default -a umask=027</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Run 'lssec -f /etc/security/user -s default -a umask'. 
                                    2. Parse rvalue 
                                    3. Ensure rvalue is pattern match 27
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'default' umask is set to '027'">
                     <ecl:command>lssec -f /etc/security/user -s default -a umask</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s*=\s*(.+?)$">
                        <ecl:regex-group dt="xs:string" group="1" op="pm" value="27"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.8_Miscellaneous_Enhancements_-_disabling_core_dumps" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - disabling core dumps</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This change disables core dumps in the default user stanza of <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security/limits </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and also ensures the <xhtml:span class="inline_block">
                        <xhtml:span>fullcore </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>kernel parameter is set to false.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The creation of core dumps can reveal pertinent system information, potentially even passwords, within the core file. The ability to create a core dump is also a vulnerability to be exploited by a hacker. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The commands below disable core dumps by default, but they may be specifically enabled for a particular user in <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security/limits</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Change the default user stanza attributes <xhtml:span class="inline_block">
                              <xhtml:span>core </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and <xhtml:span class="inline_block">
                              <xhtml:span>core_hard </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>in <xhtml:span class="inline_block">
                              <xhtml:span>/etc/security/limits </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and the set the <xhtml:span class="inline_block">
                              <xhtml:span>fullcore </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>kernel parameter to </xhtml:span>
                        <xhtml:span>false:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.2928990985971628">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chdev -l sys0 -a fullcore=false</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'core' is set to '0' in '/etc/security/limits'">
                        <ecl:command>lssec -f /etc/security/limits -s default -a core</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^default\score=0"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'core_hard' is set to '0' in '/etc/security/limits'">
                        <ecl:command>lssec -f /etc/security/limits -s default -a core_hard</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^default\score_hard=0"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'fullcore' is set to 'false'">
                        <ecl:command>lsattr -El sys0 -a fullcore</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^fullcore\sfalse"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7.9_Miscellaneous_Enhancements_-_AIX_Auditing" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Miscellaneous Enhancements - AIX Auditing</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This recommendation configures AIX auditing in bin mode. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>AIX auditing provides a framework within which to capture pertinent system and security related information, such as failed login attempts, cron usage etc. It is recommended that auditing is enabled as part of a group of measures designed to provide enhanced logging of system and security changes.<xhtml:br/>Further information regarding the setup and management of AIX accounting and auditing can be found in the "Accounting and Auditing for AIX 5L Redbook":<xhtml:br/>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>http://www.redbooks.ibm.com/redbooks/pdfs/sg246396.pdf<xhtml:br/>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:span>Configure AIX auditing in-line with the High Level AIX Security Expert policy.</xhtml:span>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:span>Create a <xhtml:span class="inline_block">
                                 <xhtml:span>/audit </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>filesystem, at least 100 MB in size:</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:code class="pre_0.1065987103774168">
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>mklv -y &lt;LV name&gt; -t jfs2 -u 1 -c 1 rootvg 1 hdisk0</xhtml:span>
                                       <xhtml:br/>
                                       <xhtml:span>crfs -v jfs2 -d auditlv -m /audit -A yes -t no</xhtml:span>
                                       <xhtml:br/>
                                       <xhtml:span>mount /audit</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:code>
                              <xhtml:p>
                                 <xhtml:span>Reflect the following configuration in the</xhtml:span>
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>/etc/security/audit/config </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                                 <xhtml:span>file:</xhtml:span>
                              </xhtml:p>
                           </xhtml:div>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.41793961812413555">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>vi </xhtml:span>
                                 <xhtml:span>/etc/security/audit/config</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Add in:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.10681860183932246">
                           <xhtml:span class="inline_block">start:<xhtml:br/> binmode = on<xhtml:br/> streammode = off<xhtml:br/>bin:<xhtml:br/> trail = /audit/trail<xhtml:br/> bin1 = /audit/bin1<xhtml:br/> bin2 = /audit/bin2<xhtml:br/> binsize = 10240<xhtml:br/> cmds = /etc/security/audit/bincmds</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Add the auditing entries for root and all other users below the pre-defined audit classes:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8348411987792663">
                           <xhtml:span class="inline_block">users:<xhtml:br/> root = general,SRC,mail,cron,tcpip,ipsec,lvm <xhtml:br/> &lt;user 1&gt; = general,SRC,cron,tcpip<xhtml:br/> &lt;user 2&gt; = general,SRC,cron,tcpip<xhtml:br/> etc.</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Update the <xhtml:span class="inline_block">
                                 <xhtml:span>/</xhtml:span>
                                 <xhtml:span>usr/lib/security/mkuser.default </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>auditclasses</xhtml:span>
                           <xhtml:span> entry to ensure that auditing is set up for any newly created users:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:code class="pre_0.05717414064995924">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>chsec -f /usr/lib/security/mkuser.default -s user -a</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>auditclasses=</xhtml:span>general,SRC,cron,tcpip</xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:span>A </xhtml:span>
                        <xhtml:span>cron</xhtml:span>
                        <xhtml:span> job is implemented to monitor the free space in <xhtml:span class="inline_block">
                              <xhtml:span>/audit</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, running hourly, to ensure that <xhtml:span class="inline_block">
                              <xhtml:span>/audit </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>does not fill up. If <xhtml:span class="inline_block">
                              <xhtml:span>/audit</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> is greater than 90% used, <xhtml:span class="inline_block">
                              <xhtml:span>/audit/trail </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>is moved to <xhtml:span class="inline_block">
                              <xhtml:span>/audit/trailOneLevelBack</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.25636369068669234">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>crontab -e</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Add in:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9160715119867786">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>0 * * * * /etc/security/aixpert/bin/cronaudit </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: The implementation of a script to suit internal security policy is recommended to further enhance the log rotation process.</xhtml:span>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:span>Add the audit startup command into <xhtml:span class="inline_block">
                                 <xhtml:span>/etc/inittab</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7648464981739725">
                           <xhtml:span class="inline_block">mkitab "audit:2:boot:audit start &gt; /dev/console 2&gt;&amp;1 # Start audit"</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Non_AIX_Security_Expert_Managed_Recommendations">
      <xccdf:title xml:lang="en">Non AIX Security Expert Managed Recommendations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>
            <xhtml:span>This section of the benchmark will focus on the recommendations which are not automatically applied during the implementation of the AIX Security Expert customized XML file. A number of these recommendations are not scorable, in that the implementation needs to be tailored to suit the needs of a given environment, which also makes compliance checking impossible. </xhtml:span>
         </xhtml:p>
         <xhtml:p>
            <xhtml:span>The following recommendations are detailed in this section:</xhtml:span>
         </xhtml:p>
         <xhtml:ul>
            <xhtml:li>
               <xhtml:span>Configuring syslog</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>Secure remote access</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>Configuring sendmail</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>Configuring CDE</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>Configuring NFS</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>Configuring SNMP</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>TCP Wrappers</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>File and directory permissions and ownership</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>Privileged command management - Enhanced RBAC and sudo</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>Encrypted Filesystem (EFS) </xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>Trusted Execution</xhtml:span>
            </xhtml:li>
            <xhtml:li>
               <xhtml:span>General Permissions Management</xhtml:span>
            </xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.1_Configuring_syslog">
         <xccdf:title xml:lang="en">Configuring syslog</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>This section will detail the recommendations regarding the configuration of </xhtml:span>
               <xhtml:span>syslog</xhtml:span>
               <xhtml:span>. By default the information sent to <xhtml:span class="inline_block">
                     <xhtml:span>syslogd </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>is not logged and important and pertinent information, such as failed switch user and login attempts are not recorded. The type of data which can be captured through this mechanism can be used for real-time and retrospective analysis, and is particularly useful for monitoring access to the system. </xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>Logging data, via <xhtml:span class="inline_block">
                     <xhtml:span>syslogd</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>,</xhtml:span>
               <xhtml:span> may also provide unequivocal evidence against any individual or organization that successfully breach, or attempt to circumvent the security access controls surrounding a system. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Configuring_syslog_-_local_logging" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring syslog - local logging</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This recommendation implements a local <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>configuration.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Establishing a logging process via <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Explicitly define a log file for the <xhtml:span class="inline_block">
                              <xhtml:span>auth.info</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> output in <xhtml:span class="inline_block">
                              <xhtml:span>/etc/syslog.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9315298212812444">
                           <xhtml:span class="inline_block">printf "auth.info\t\t/var/adm/authlog rotate time 1w files 4\n" &gt;&gt; /etc/syslog.conf</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>NOTE: This ensures that remote login, <xhtml:span class="inline_block">sudo </xhtml:span>or <xhtml:span class="inline_block">su </xhtml:span>attempts are logged separately</xhtml:p>
                        <xhtml:p>Create the <xhtml:span class="inline_block">authlog </xhtml:span>file and make it readable by root only:</xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7780342598579077">
                           <xhtml:span class="inline_block">touch /var/adm/authlog<xhtml:br/>chown root:system /var/adm/authlog<xhtml:br/>chmod u=rw,go= /var/adm/authlog</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>Create an entry in <xhtml:span class="inline_block">/etc/syslog.conf </xhtml:span>to capture all other output of level info or higher, excluding authentication information, as this is to be captured within <xhtml:span class="inline_block">/var/adm/authlog</xhtml:span>:</xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7465580226800617">
                           <xhtml:span class="inline_block">printf "*.info;auth.none\t/var/adm/syslog rotate time 1w files 4\n" &gt;&gt; /etc/syslog.conf</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>Create the <xhtml:span class="inline_block">syslog </xhtml:span>file:</xhtml:p>
                        <xhtml:code class="pre_0.17147691393573627">
                           <xhtml:span class="inline_block">
                              <xhtml:span class="inline_block">
                                 <xhtml:span class="inline_block">touch /var/adm/syslog</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span class="inline_block">chmod u=rw,g=r,o= /var/adm/syslog</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:br/>
                        <xhtml:span>Refresh <xhtml:span class="inline_block">
                              <xhtml:span>syslogd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>to force the daemon to read the edited <xhtml:span class="inline_block">
                              <xhtml:span>/etc/syslog.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4952490603318545">
                           <xhtml:span class="inline_block">refresh -s syslogd</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'auth.info' is set in '/etc/syslog.conf'">
                        <ecl:command>grep "^auth.info[[:blank:]]" /etc/syslog.conf</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^auth.info\s*/var/adm/authlog\s*rotate\stime\s*1w\s*files\s*4"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure '*.info' is set in '/etc/syslog.conf'">
                        <ecl:command>egrep "^\*.info;auth.none[[:blank:]]" /etc/syslog.conf</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^\*.info;auth.none\s*/var/adm/syslog\s*rotate\s*time\s*1w\s*files\s*4"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Configuring_syslog_-_remote_logging" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring syslog - remote logging</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This recommendation implements a remote <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>configuration.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>To further enhance the local <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>logging process, it is recommended that </xhtml:span>
                  <xhtml:span>syslog </xhtml:span>
                  <xhtml:span>information, in particular that generated by the auth facility, is logged remotely. This recommendation assumes that a remote and secure syslog server is available on the network. If this is not the case, please skip to the next recommendation.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The primary reason for logging remotely is to provide an un-editable audit trail of system access. If a hacker were to access a system and gain super user authority it would be easy to edit local files and remove all traces of access, providing the system administrator with no way of identifying the individual or group responsible. If the log data is sent remotely at the point of access, these remote logs can then be reconciled with local data to identify tampered and altered files. The logs can also be used as evidence in any subsequent prosecution.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Explicitly define a remote host for </xhtml:span>
                        <xhtml:span>auth.info</xhtml:span>
                        <xhtml:span> data in <xhtml:span class="inline_block">
                              <xhtml:span>/etc/syslog.conf </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>(enter the remote host IP address in the example below):</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6567468183551637">
                           <xhtml:span class="inline_block">printf "auth.info\t\t@&lt;IP address of remote syslog server&gt;\n" &gt;&gt; \ /etc/syslog.conf</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>NOTE: This ensures that remote login, <xhtml:span class="inline_block">sudo </xhtml:span>or <xhtml:span class="inline_block">su </xhtml:span>attempts are logged separately</xhtml:p>
                        <xhtml:p>Create a remote host entry in <xhtml:span class="inline_block">/etc/syslog.conf </xhtml:span>to capture all other output of level info or higher <xhtml:span>(enter the remote host IP address in the example below)</xhtml:span>:</xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.09248179923531674">
                           <xhtml:span class="inline_block">printf "*.info;auth.none\t@&lt;IP address of remote syslog server&gt;\n" &gt;&gt; \ /etc/syslog.conf</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Refresh <xhtml:span class="inline_block">
                                 <xhtml:span>syslogd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>to force the daemon to read the edited <xhtml:span class="inline_block">
                                 <xhtml:span>/etc/syslog.conf</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.06555799171612847">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>refresh -s syslogd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure 'auth.info' is sent to a remote syslog host">
                        <ecl:command>grep "^auth.info[[:blank:]]" /etc/syslog.conf</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^auth.info\s*@[0-9].[0-9]."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure '*.info' is sent to a remote syslog host">
                        <ecl:command>egrep "^\*.info;auth.none[[:blank:]]" /etc/syslog.conf</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^\*.info;auth.none\s*@[0-9].[0-9]."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Configuring_syslog_-_remote_messages" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring syslog - remote messages</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This recommendation prevents the local <xhtml:span class="inline_block">
                        <xhtml:span>syslogd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon from accepting messages from other hosts on the network.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Apart from a central <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>server, all other hosts should not accept remote <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>messages. By default the <xhtml:span class="inline_block">
                        <xhtml:span>syslogd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon accepts all remote </xhtml:span>
                  <xhtml:span>syslog</xhtml:span>
                  <xhtml:span> messages as no authentication is required. This means that a hacker could flood a server with <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>messages and potentially fill up the <xhtml:span class="inline_block">
                        <xhtml:span>/var </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>filesystem. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>If the server does not act as a central <xhtml:span class="inline_block">
                              <xhtml:span>syslog </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>server, suppress the logging of messages originating from remote servers:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.45044235881074657">
                           <xhtml:span class="inline_block">chssys -s syslogd -a "-r"</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Re-cycle <xhtml:span class="inline_block">
                                 <xhtml:span>syslogd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>to activate the configuration change</xhtml:span>
                           <xhtml:span>:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9136508136421488">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>stopsrc -s syslogd</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>startsrc -s syslogd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'syslogd' does not accept messages from other network hosts">
                     <ecl:command>ps -ef |grep "/usr/sbin/syslogd"</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="/usr/sbin/syslogd\s*-r"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.2_Secure_Remote_Access">
         <xccdf:title xml:lang="en">Secure Remote Access</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>The use of SSH provides a secure and encrypted mechanism for connecting to a UNIX server. The recommendations in this benchmark disable clear text password access methods, such as <xhtml:span class="inline_block">
                     <xhtml:span>telnet </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>and <xhtml:span class="inline_block">
                     <xhtml:span>rlogin</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>. There are many legacy scenarios where <xhtml:span class="inline_block">
                     <xhtml:span>telnet </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>and <xhtml:span class="inline_block">
                     <xhtml:span>ftp </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>may still be required, but SSH should not be ignored in these situations and used where ever possible alongside the non-encrypted services. The preferred scenario is that SSH is the only available remote access service.</xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>One of the historical issues relating to the use of OpenSSH was the lack of vendor support for the software. This has now been addressed as it has the full support, and is in fact packaged, by IBM for AIX based on the Open source libraries. </xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>This section of the benchmark will focus on the installation and configuration of SSH. Some of the parameters specified in this section are actually the default values, but explicit declaration is preferred, to ensure that these recommendations remain constant over time. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Configuring_SSH_-_installation" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - installation</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to install OpenSSH</xhtml:span>
                  <xhtml:span>and OpenSSL libraries from the expansion pack media, or the IBM supported packages downloaded from the internet.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This is the preferred mechanism for remote client access as it provides socket level encryption, via OpenSSL. If any clear text password service is required for legacy connections the two services may sit side by side, with SSH utilized wherever possible. Ideally, SSH should be the only available remote access mechanism.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>If the software is not available from the expansion pack media, download from the following locations.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>OpenSSH</xhtml:span>
                  <xhtml:span>:</xhtml:span>
                  <xhtml:span> </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>
                     <xhtml:span>
                        <xhtml:a href="http://sourceforge.net/projects/openssh-aix/files/?source=navbar">http://sourceforge.net/projects/openssh-aix/files/?source=navbar</xhtml:a>
                     </xhtml:span>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>OpenSSL</xhtml:span>
                  <xhtml:span>:</xhtml:span>
                  <xhtml:span> </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>
                     <xhtml:a href="https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp">https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp</xhtml:a>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>NOTE: A login is required to download </xhtml:span>
                  <xhtml:span>OpenSSL</xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;"> </xhtml:p>
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If the Secure By Default option was selected when installing AIX, both SSH and SSL will already have been installed as part of this process. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Place the OpenSSH and OpenSSL software into a convenient location, such as <xhtml:span class="inline_block">
                              <xhtml:span>/tmp</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> and install via</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.2182740836585636">
                           <xhtml:span class="inline_block">/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f openssl,openssh.license,openssh.base,openssh.man.en_US,<xhtml:span>openssh.msg.en_US </xhtml:span>-c -N -g -X -G -Y</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: If the software is not located in <xhtml:span class="inline_block">
                                 <xhtml:span>/tmp</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>, reflect the actual location in the command above.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure that 'openssh.base.server' is installed" success="pass">
                        <ecl:command>lslpp -l openssh.base.server</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure that 'openssl.base' is installed" success="pass">
                        <ecl:command>lslpp -l openssl.base</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Configuring_SSH_-_disabling_direct_root_access" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - disabling direct root access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/sshd_config</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file to disable direct root login. By default direct root login via SSH is enabled</xhtml:span>
                  <xhtml:span style="color: #000000;">
                     <xhtml:span>
                        <xhtml:span style="font-size: medium;">
                           <xhtml:span style="font-family: Cambria;">.</xhtml:span>
                        </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>All root access should be facilitated through a local logon with a unique and identifiable user ID and then via the <xhtml:span class="inline_block">
                        <xhtml:span>su </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>command once locally authenticated. Direct root login is extremely insecure and offers little in the way of audit trailing for accountability. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Edit the<xhtml:span class="inline_block">
                              <xhtml:span>/</xhtml:span>
                              <xhtml:span>etc/ssh/sshd_config</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file and disable direct root login for SSH</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8706838397278911">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Replace:</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8009739699931742">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>#PermitRootLogin yes</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>With:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.19898221032854302">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>PermitRootLogin no</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:br/>
                        <xhtml:span>Re-cycle the <xhtml:span class="inline_block">
                              <xhtml:span>sshd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>daemon to pick up the configuration changes:</xhtml:span>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by PermitRootLogin  
                                    3.    and is followed by a value that is equals no
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'PermitRootLogin' is set to 'no' in '/etc/ssh/sshd_config'">
                     <ecl:command>grep '^[ ]*PermitRootLogin[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="eq" value="no"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Configuring_SSH_-_server_protocol_2" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - server protocol 2</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/sshd_config </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file and allow the SSH2 protocol only. By default the SSH1 protocol is also available. This is the SSH server configuration file.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>There are publicly known vulnerabilities in SSH1 protocol, because of which the SSH1 protocol was deprecated in early 2001. SSH2 is a complete re-write of SSH1 with additional security features. All SSH connections should communicate over the SSH2 protocol. There are numerous benefits of utilizing SSH2 over SSH1, these include: an enhanced and stronger crypto integrity check and support for RSA and DSA keys, rather than just RSA key support in SSH1. The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/sshd_config </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file and allow the SSH2 protocol only. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Edit the<xhtml:span class="inline_block">
                              <xhtml:span>/</xhtml:span>
                              <xhtml:span>etc/ssh/sshd_config</xhtml:span>
                           </xhtml:span>
                        </xhtml:span> file <xhtml:span>and explicitly define the SSH2 protocol:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8706838397278911">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Replace:</xhtml:span>
                        </xhtml:p>
                        <xhtml:div>
                           <xhtml:code class="pre_0.5598197731091352">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>#Protocol 2,1</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:br/>
                              <xhtml:span>With:</xhtml:span>
                              <xhtml:span> </xhtml:span>
                           </xhtml:p>
                           <xhtml:code class="pre_0.36356326800691174">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>Protocol 2</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:br/>
                           <xhtml:span>Re-cycle the <xhtml:span class="inline_block">
                                 <xhtml:span>sshd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>daemon to pick up the configuration changes:</xhtml:span>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by Protocol  
                                    3.    and is followed by a value that is equals 2
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'Protocol' is set to '2' in '/etc/ssh/sshd_config'">
                     <ecl:command>grep '^[ ]*Protocol[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="eq" value="2"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Configuring_SSH_-_client_protocol_2" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - client protocol 2</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/ssh_config </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file and allow the SSH2 protocol only. By default the SSH1 protocol is also available. This is the SSH client configuration file. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>There are publicly known vulnerabilities in SSH1 protocol, because of which the SSH1 protocol was deprecated in early 2001. SSH2 is a complete re-write of SSH1 with additional security features. All SSH connections should communicate over the SSH2 protocol. There are numerous benefits of utilizing SSH2 over SSH1, these include: an enhanced and stronger crypto integrity check and support for RSA and DSA keys, rather than just RSA key support in SSH1. The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/ssh_config </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file and allow the SSH2 protocol only. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Edit the<xhtml:span class="inline_block">
                              <xhtml:span>/</xhtml:span>
                              <xhtml:span>etc/ssh/ssh_config</xhtml:span>
                           </xhtml:span>
                        </xhtml:span> file <xhtml:span>and</xhtml:span>
                        <xhtml:span>explicitly define the SSH2 protocol</xhtml:span>:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8706838397278911">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Replace:</xhtml:span>
                        </xhtml:p>
                        <xhtml:div>
                           <xhtml:code class="pre_0.5598197731091352">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>#Protocol 2,1</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:br/>
                              <xhtml:span>With:</xhtml:span>
                              <xhtml:span> </xhtml:span>
                           </xhtml:p>
                           <xhtml:code class="pre_0.36356326800691174">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>Protocol 2</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:br/>
                           <xhtml:span>Re-cycle the <xhtml:span class="inline_block">
                                 <xhtml:span>sshd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>daemon to pick up the configuration changes:</xhtml:span>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'Protocol' is set to '2' in '/etc/ssh/ssh_config'">
                     <ecl:command>grep "^Protocol[[:blank:]]" /etc/ssh/ssh_config</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^Protocol\s*2"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Configuring_SSH_-_banner_configuration" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - banner configuration</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/sshd_config</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file and configure a path to a login herald message.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The login herald configured previously is not displayed during the initiation of a new SSH connection. Prior to a password being entered the user should accept the terms and conditions of the corporate acceptable usage policy. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Create an SSH banner file:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.1254915556783871">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>printf "Unauthorized use of this system is prohibited.\n"</xhtml:span> &gt; /etc/ssh/ssh_banner</xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>NOTE: The content of the banner file can reflect any internal acceptable usage policy standards</xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Edit the <xhtml:span class="inline_block">
                              <xhtml:span>/</xhtml:span>
                              <xhtml:span>etc/ssh/sshd_config</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file and customize the <xhtml:span class="inline_block">
                              <xhtml:span>Banner </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>parameter</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.3158888281755784">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Replace:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.13768415105702053">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>#Banner /some/path</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:br/>
                        <xhtml:span>With:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4713273058277544">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>Banner /etc/ssh/ssh_banner</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                     <xhtml:div> </xhtml:div>
                     <xhtml:div>
                        <xhtml:span>Re-cycle the <xhtml:span class="inline_block">
                              <xhtml:span>sshd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>daemon to pick up the configuration changes:</xhtml:span>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by Banner  
                                    3.    and is followed by a value that is pattern match .+
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'Banner' is set in '/etc/ssh/sshd_config'">
                     <ecl:command>grep '^[ ]*Banner[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="pm" value=".+"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Configuring_SSH_-_ignore_.shosts_and_.rhosts" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - ignore .shosts and .rhosts</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/sshd_config</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file and set the <xhtml:span class="inline_block">
                        <xhtml:span>IgnoreRhosts</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter to ignore <xhtml:span class="inline_block">
                        <xhtml:span>.shosts </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and<xhtml:span class="inline_block">
                        <xhtml:span>.rhosts </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>files.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>A user can logon to a remote system without authenticating themselves if<xhtml:span class="inline_block">
                        <xhtml:span>.rhosts </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>or <xhtml:span class="inline_block">
                        <xhtml:span>.shosts </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>files exist in the remote home directory and if the client machine name and user name are present in these files. This method is fundamentally insecure as the local system can be exploited by IP, DNS (Domain Name Server) and routing spoofing attacks. Additionally, this authentication method relies on the integrity of the client machine. These weaknesses have been known and exploited for a long time. Since this authentication method is not secure, it must be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:span>Edit the <xhtml:span class="inline_block">
                                 <xhtml:span>/</xhtml:span>
                                 <xhtml:span>etc/ssh/sshd_config </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>file to disable the <xhtml:span class="inline_block">
                                 <xhtml:span>.shosts </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>and <xhtml:span class="inline_block">
                                 <xhtml:span>.rhosts </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>authentication </xhtml:span>
                           <xhtml:span>parameter:</xhtml:span>
                        </xhtml:p>
                        <xhtml:div>
                           <xhtml:code class="pre_0.7255885539874086">
                              <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:br/>
                              <xhtml:span>Replace:</xhtml:span>
                           </xhtml:p>
                        </xhtml:div>
                        <xhtml:div>
                           <xhtml:code class="pre_0.22430473321715433">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>#IgnoreRhosts yes</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:br/>
                              <xhtml:span>With:</xhtml:span>
                           </xhtml:p>
                        </xhtml:div>
                        <xhtml:div>
                           <xhtml:code class="pre_0.9480606714979001">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>IgnoreRhosts yes</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:span>Re-cycle the <xhtml:span class="inline_block">
                              <xhtml:span>sshd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>daemon to pick up the configuration changes:</xhtml:span>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by IgnoreRhosts  
                                    3.    and is followed by a value that is equals yes
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'IgnoreRhosts' is set to 'yes' in '/etc/ssh/sshd_config'">
                     <ecl:command>grep '^[ ]*IgnoreRhosts[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="eq" value="yes"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Configuring_SSH_-_disable_null_passwords" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - disable null passwords</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/sshd_config </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file to ensure that the SSH daemon does not authenticate users with a null password.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If password authentication is used and an account has an empty password, the SSH server must be configured to disallow access to the account. Permitting empty passwords could create an easy path of access for hackers to enter the system.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:span>Edit the <xhtml:span class="inline_block">
                                 <xhtml:span>/</xhtml:span>
                                 <xhtml:span>etc/ssh/sshd_config </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>file to disable the acceptance null passwords:</xhtml:span>
                        </xhtml:p>
                        <xhtml:div>
                           <xhtml:code class="pre_0.423550097511603">
                              <xhtml:span class="inline_block">vi /etc/ssh/sshd_config </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:span>Replace:</xhtml:span>
                           </xhtml:p>
                        </xhtml:div>
                        <xhtml:div>
                           <xhtml:code class="pre_0.7107418793270359">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>#PermitEmptyPasswords no</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:span>With:</xhtml:span>
                           </xhtml:p>
                           <xhtml:code class="pre_0.28917532108320076">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>PermitEmptyPasswords no</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:br/>
                              <xhtml:span>Re-cycle the <xhtml:span class="inline_block">
                                    <xhtml:span>sshd </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                              <xhtml:span>daemon to pick up the configuration changes:</xhtml:span>
                           </xhtml:p>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by PermitEmptyPasswords  
                                    3.    and is followed by a value that is equals no
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'PermitEmptyPasswords' is set to 'no' in '/etc/ssh/sshd_config'">
                     <ecl:command>grep '^[ ]*PermitEmptyPasswords[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="eq" value="no"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Configuring_SSH_-_disallow_host_based_authentication" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - disallow host based authentication</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/sshd_config</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file to ensure that host-based authentication is disallowed.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Using host-based authentication, any user on a trusted host can log into another host on which this feature is enabled. Since this feature depends only on system authentication and not on user authentication, it must be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:span>Edit the <xhtml:span class="inline_block">
                                 <xhtml:span>/</xhtml:span>
                                 <xhtml:span>etc/ssh/sshd_config</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span> file to ensure that host based authentication is disallowed:</xhtml:span>
                        </xhtml:p>
                        <xhtml:div>
                           <xhtml:code class="pre_0.4441730551939492">
                              <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:span>Replace:</xhtml:span>
                           </xhtml:p>
                        </xhtml:div>
                        <xhtml:div>
                           <xhtml:code class="pre_0.43863858976106845">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>#HostbasedAuthentication no</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:span>With:</xhtml:span>
                           </xhtml:p>
                        </xhtml:div>
                        <xhtml:div>
                           <xhtml:div>
                              <xhtml:code class="pre_0.8587387935322622">
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>HostbasedAuthentication no</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:code>
                           </xhtml:div>
                           <xhtml:span>Re-cycle the <xhtml:span class="inline_block">
                                 <xhtml:span>sshd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>daemon to pick up the configuration changes:</xhtml:span>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by HostbasedAuthentication  
                                    3.    and is followed by a value that is equals no
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'HostbasedAuthentication' is set to 'no' in '/etc/ssh/sshd_config'">
                     <ecl:command>grep '^[ ]*HostbasedAuthentication[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="eq" value="no"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Configuring_SSH_-_set_privilege_separation" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - set privilege separation</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to edit the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ssh/sshd_config </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file to ensure that privilege separation is enabled.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Setting privilege separation helps to secure remote <xhtml:span class="inline_block">
                        <xhtml:span>ssh </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>access. Once a user is authenticated the <xhtml:span class="inline_block">
                        <xhtml:span>sshd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon creates a child process which has the privileges of the authenticated user and this then handles incoming network traffic. The aim of this is to prevent privilege escalation through the initial root process. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:div>
                        <xhtml:p>
                           <xhtml:span>Edit the <xhtml:span class="inline_block">
                                 <xhtml:span>/</xhtml:span>
                                 <xhtml:span>etc/ssh/sshd_config </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>file to ensure that privilege separation is enabled:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.6773554853726795">
                           <xhtml:span>
                              <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Replace:</xhtml:span>
                        </xhtml:p>
                        <xhtml:div>
                           <xhtml:code class="pre_0.1523521671404483">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>UsePrivilegeSeparation no</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>
                              <xhtml:span>With:</xhtml:span>
                              <xhtml:span> </xhtml:span>
                           </xhtml:p>
                           <xhtml:code class="pre_0.4112699377024556">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>UsePrivilegeSeparation yes</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:br/>
                           <xhtml:span>Re-cycle the <xhtml:span class="inline_block">
                                 <xhtml:span>sshd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>daemon to pick up the configuration changes:</xhtml:span>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by UsePrivilegeSeparation  
                                    3.    and is followed by a value that is not equal no
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure 'UsePrivilegeSeparation' is set not set to 'no' in '/etc/ssh/sshd_config'">
                     <ecl:command>grep '^[ ]*UsePrivilegeSeparation[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="ne" value="no"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.10_Configuring_SSH_-_removal_of_.shosts_files" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - removal of .shosts files</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The recommendation is to remove any existing <xhtml:span class="inline_block">.shosts </xhtml:span>files from all user home directories.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The </xhtml:span>
                  <xhtml:span>existence of <xhtml:span class="inline_block">
                        <xhtml:span>.shosts</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> files in a user home directory, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method, these files, if they exist, should be removed. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>List out all of the existing <xhtml:span class="inline_block">
                              <xhtml:span>.shost </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>files:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4418783974857362">
                           <xhtml:span class="inline_block">find / -name ".shosts" -print</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Review the list of <xhtml:span class="inline_block">
                                 <xhtml:span>.shost </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>files and remove them individually, or all at once:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Individually:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.13547029601672822">
                           <xhtml:span class="inline_block">rm (full pathname)</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>All at once: </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.37481905580842345">
                           <xhtml:span class="inline_block">find / -name ".shosts" -exec rm {} \;</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that no '.shosts' files exist on the system">
                     <ecl:command>find / -name ".shosts" -print</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.11_Configuring_SSH_-_removal_of_etcshosts.equiv" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - removal of /etc/shosts.equiv</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The recommendation is to remove the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/shosts.equiv </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The </xhtml:span>
                  <xhtml:span>existence of </xhtml:span>
                  <xhtml:span>a <xhtml:span class="inline_block">/etc/shosts.equiv</xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method these files, if they exist, should be removed. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Review the content of the /<xhtml:span class="inline_block">
                              <xhtml:span>etc/shosts.equiv</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5677793169964124">
                           <xhtml:span class="inline_block">cat /etc/shosts.equiv</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If the file exists:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9174949600030928">
                           <xhtml:span class="inline_block">rm /etc/shosts.equiv</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure the '/etc/shosts.equiv' does not exist on  the system">
                     <ecl:command>if [ ! -e "/etc/shosts.equiv" ]; then echo File does not exist ; fi</ecl:command>
                     <ecl:line-selection op="pm" value="File does not exist"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.12_Configuring_SSH_-_set_LogLevel_to_INFO" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - set LogLevel to INFO</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">INFO </xhtml:span>parameter specifices that record login and logout activity will be logged.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>SSH provides several logging levels with varying amounts of verbosity. <xhtml:span class="inline_block">DEBUG </xhtml:span>is specifically <xhtml:em>not</xhtml:em> recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information. <xhtml:span class="inline_block">INFO </xhtml:span>level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Edit the<xhtml:span class="inline_block">/etc/ssh/sshd_config:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8706838397278911">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Set:</xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8009739699931742">
                           <xhtml:span style="font-size: 10pt;">LogLevel INFO</xhtml:span>
                        </xhtml:code>
                        <xhtml:br/>Re-cycle the <xhtml:span class="inline_block">sshd </xhtml:span>daemon to pick up the configuration changes:</xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578" style="font-size: 12px;">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by LogLevel  
                                    3.    and is followed by a value that is equals INFO
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure sshd LogLevel is set to INFO">
                     <ecl:command>grep '^[ ]*LogLevel[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="eq" value="INFO"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.13_Configuring_SSH_-_set_MaxAuthTries_to_4_or_Less" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - set MaxAuthTries to 4 or Less</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">MaxAuthTries </xhtml:span>parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the <xhtml:span class="inline_block">syslog</xhtml:span> file detailing the login failure.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Setting the <xhtml:span class="inline_block">MaxAuthTries </xhtml:span>parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, it is set the number based on site policy.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Edit the<xhtml:span class="inline_block">/etc/ssh/sshd_config</xhtml:span> file:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8706838397278911">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Set:</xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8009739699931742">
                           <xhtml:span class="inline_block">MaxAuthTries 4</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Re-cycle the <xhtml:span class="inline_block">sshd </xhtml:span>daemon to pick up the configuration changes:</xhtml:p>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578" style="font-size: 12px;">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by MaxAuthTries  
                                    3.    and is followed by a value that is less than or equal 4
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure sshd MaxAuthTries set to 4 or less">
                     <ecl:command>grep '^[ ]*MaxAuthTries[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:integer" group="1" op="le" value="4"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.14_Configuring_SSH_-_set_Idle_Timeout_Interval_for_User_Login" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - set Idle Timeout Interval for User Login</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The two options <xhtml:span class="inline_block">ClientAliveInterval </xhtml:span>and <xhtml:span class="inline_block">ClientAliveCountMax </xhtml:span>control the timeout of ssh sessions. When the <xhtml:span class="inline_block">ClientAliveInterval </xhtml:span>variable is set, ssh sessions that have no activity for the specified length of time are terminated. When the <xhtml:span class="inline_block">ClientAliveCountMax </xhtml:span>variable is set, <xhtml:span class="inline_block">sshd </xhtml:span>will send client alive messages at every <xhtml:span class="inline_block">ClientAliveInterval </xhtml:span>interval. When the number of consecutive client alive messages are sent with no response from the client, the <xhtml:span class="inline_block">ssh </xhtml:span>session is terminated. For example, if the <xhtml:span class="inline_block">ClientAliveInterval </xhtml:span>is set to 15 seconds and the <xhtml:span class="inline_block">ClientAliveCountMax
                  </xhtml:span>is set to 3, the client <xhtml:span class="inline_block">ssh </xhtml:span>session will be terminated after 45 seconds of idle time.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Having no timeout value associated with a connection could allow an unauthorized user access to another user's <xhtml:span class="inline_block">ssh </xhtml:span>session (e.g. user walks away from their computer and doesn't lock the screen). Setting a timeout value at least reduces the risk of this happening..</xhtml:p>
               <xhtml:p>While the recommended setting is 300 seconds (5 minutes), set this timeout value based on site policy. The recommended setting for <xhtml:span class="inline_block">ClientAliveCountMax </xhtml:span>is 0. In this case, the client session will be terminated after 5 minutes of idle time and no keepalive messages will be sent.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Edit the<xhtml:span class="inline_block">/etc/ssh/sshd_config</xhtml:span> file:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8706838397278911">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Set: </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8009739699931742">
                           <xhtml:span class="inline_block">ClientAliveCountMax 300<xhtml:br/>ClientAliveInterval 0<xhtml:br/>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Re-cycle the <xhtml:span class="inline_block">sshd </xhtml:span>daemon to pick up the configuration changes:</xhtml:p>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578" style="font-size: 12px;">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by ClientAliveInterval  
                                    3.    and is followed by a value that is less than or equal 300
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                     <ecl:shell-command check="all" comment="Ensure sshd ClientAliveInterval is set to 300 or less">
                        <ecl:command>grep '^[ ]*ClientAliveInterval[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                        <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                           <ecl:regex-group dt="xs:integer" group="1" op="le" value="300"/>
                        </ecl:line-selection>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by ClientAliveCountMax  
                                    3.    and is followed by a value that is equals 0
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                     <ecl:shell-command check="all" comment="Ensure sshd ClientAliveCountMax is set to 0">
                        <ecl:command>grep '^[ ]*ClientAliveCountMax[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                        <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                           <ecl:regex-group dt="xs:string" group="1" op="eq" value="0"/>
                        </ecl:line-selection>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.15_Configuring_SSH_-_restrict_Cipher_list" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - restrict Cipher list</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This variable limits the types of ciphers that SSH can use during communication.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Based on research conducted at various institutions, it was determined that the symmetric portion of the SSH Transport Protocol (as described in RFC 4253) has security weaknesses that allowed recovery of up to 32 bits of plaintext from a block of ciphertext that was encrypted with the Cipher Block Chaining (CBD) method. From that research, new Counter mode algorithms (as described in RFC4344) were designed that are not vulnerable to these types of attacks and these algorithms are now recommended for standard use.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Edit the<xhtml:span class="inline_block">/etc/ssh/sshd_config</xhtml:span> file:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8706838397278911">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Set: </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8009739699931742">
                           <xhtml:span class="inline_block">Ciphers aes128-ctr,aes192-ctr,aes256-ctr<xhtml:br/>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Re-cycle the <xhtml:span class="inline_block">sshd </xhtml:span>daemon to pick up the configuration changes:</xhtml:p>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578" style="font-size: 12px;">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by Ciphers  
                                    3.    and is followed by a value that is equals aes128-ctr,aes192-ctr,aes256-ctr
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure sshd Ciphers is set to aes128-ctr,aes192-ctr,aes256-ctr">
                     <ecl:command>grep '^[ ]*Ciphers[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="eq" value="aes128-ctr,aes192-ctr,aes256-ctr"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.16_Configuring_SSH_-_ignore_user-provided_environment_variables" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - ignore user-provided environment variables</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">PermitUserEnvironment </xhtml:span>option allows users to present environment options to the <xhtml:span class="inline_block">ssh </xhtml:span>daemon.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Permitting users the ability to set environment variables through the SSH daemon could potentially allow users to bypass security controls (e.g. setting an execution path that has <xhtml:span class="inline_block">ssh </xhtml:span>executing trojan'd programs)</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Edit the<xhtml:span class="inline_block">/etc/ssh/sshd_config</xhtml:span> file:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8706838397278911">
                           <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Set: </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8009739699931742">
                           <xhtml:span class="inline_block">PermitUserEnvironment no<xhtml:br/>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>Re-cycle the <xhtml:span class="inline_block">sshd </xhtml:span>daemon to pick up the configuration changes:</xhtml:p>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578" style="font-size: 12px;">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Read contents of /etc/ssh/sshd_config
                                    2. Find first line (SSHD respects first occurrence only) that starts with 0 or more spaces (uncommented) 
                                    3.    and is followed by PermitUserEnvironment  
                                    3.    and is followed by a value that is equals no
                                    4. If no such lines are found, fail.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="all" comment="Ensure ssh PermitUserEvironment is set to no">
                     <ecl:command>grep '^[ ]*PermitUserEnvironment[ ]' /etc/ssh/sshd_config | head -1</ecl:command>
                     <ecl:line-selection op="pm" value="\s*\S+\s+(.+?)\s*(#.*)?$">
                        <ecl:regex-group dt="xs:string" group="1" op="eq" value="no"/>
                     </ecl:line-selection>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.17_Configuring_SSH_-_limit_access_via_SSH" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - limit access via SSH</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>There are several options available to limit which users and group can access the system via SSH. It is recommended that at least of the following options be leveraged:</xhtml:p>
               <xhtml:p>
                  <xhtml:span class="inline_block">
                     <xhtml:span style="text-decoration: underline;">AllowUsers</xhtml:span>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p>The <xhtml:span class="inline_block">AllowUsers </xhtml:span>variable gives the system administrator the option of allowing specific users to <xhtml:span class="inline_block">ssh </xhtml:span>into the system. The list consists of comma separated user names. Numeric userIDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular host, the entry can be specified in the form of user@host.</xhtml:p>
               <xhtml:p>
                  <xhtml:span class="inline_block">
                     <xhtml:span style="text-decoration: underline;">AllowGroups</xhtml:span>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p>The <xhtml:span class="inline_block">AllowGroups </xhtml:span>variable gives the system administrator the option of allowing specific groups of users to <xhtml:span class="inline_block">ssh </xhtml:span>into the system. The list consists of comma separated group names. Numeric groupIDs are not recognized with this variable.</xhtml:p>
               <xhtml:p>
                  <xhtml:span class="inline_block">
                     <xhtml:span style="text-decoration: underline;">DenyUsers</xhtml:span>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p>The <xhtml:span class="inline_block">DenyUsers </xhtml:span>variable gives the system administrator the option of denying specific users to <xhtml:span class="inline_block">ssh </xhtml:span>into the system. The list consists of comma separated user names. Numeric userIDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host.</xhtml:p>
               <xhtml:p>
                  <xhtml:span class="inline_block">
                     <xhtml:span style="text-decoration: underline;">DenyGroups</xhtml:span>
                  </xhtml:span>
               </xhtml:p>
               <xhtml:p>The <xhtml:span class="inline_block">DenyGroups </xhtml:span>variable gives the system administrator the option of denying specific groups of users to <xhtml:span class="inline_block">ssh </xhtml:span>into the system. The list consists of comma separated group names. Numeric groupIDs are not recognized with this variable.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Restricting which users can remotely access the system via SSH will help ensure that only authorized users access the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:div>
                        <xhtml:p>Edit the <xhtml:span class="inline_block">/etc/ssh/sshd_config</xhtml:span> file:</xhtml:p>
                        <xhtml:div>
                           <xhtml:code class="pre_0.4441730551939492">
                              <xhtml:span class="inline_block">vi /etc/ssh/sshd_config</xhtml:span>
                           </xhtml:code>
                           <xhtml:p>Set one of the following:</xhtml:p>
                        </xhtml:div>
                        <xhtml:div>
                           <xhtml:code class="pre_0.43863858976106845">
                              <xhtml:span class="inline_block">
                                 <xhtml:span style="font-size: 9pt;">AllowUsers &lt;userlist&gt;<xhtml:br/>
                                 </xhtml:span>
                                 <xhtml:span style="font-size: 9pt;">AllowGroups &lt;grouplist&gt;<xhtml:br/>
                                 </xhtml:span>
                                 <xhtml:span style="font-size: 9pt;">DenyUsers &lt;userlist&gt;<xhtml:br/>
                                 </xhtml:span>
                                 <xhtml:span style="font-size: 9pt;">DenyGroups &lt;grouplist&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                           <xhtml:p>Re-cycle the <xhtml:span class="inline_block">sshd </xhtml:span>daemon to pick up the configuration changes:</xhtml:p>
                        </xhtml:div>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9280285379473578" style="font-size: 12px;">
                        <xhtml:span class="inline_block">stopsrc -s sshd<xhtml:br/>startsrc -s sshd</xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:file-content check="at least one" comment="Ensure SSH remote user restriction is configured">
                     <ecl:path>/etc/ssh/sshd_config</ecl:path>
                     <ecl:line-selection op="pm" value="^\s*(AllowUsers|AllowGroups|DenyUsers|DenyGroups)\s+.*"/>
                  </ecl:file-content>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.18_Configuring_SSH_-_sshd_config_permissions_lockdown" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - sshd_config permissions lockdown</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">/etc/ssh/sshd_config</xhtml:span> file defines SSH server behavior.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The SSH daemon </xhtml:span>
                  <xhtml:span>reads the configuration information from this file and includes the authentication mode and cryptographic levels to use during SSH communication. The recommended value is not to provide any access rights for any user, other than the owner of the file.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Change the permissions of the <xhtml:span class="inline_block">/etc/ssh/sshd_config</xhtml:span> file to ensure that only the owner can read and write to the file:</xhtml:p>
                     <xhtml:code class="pre_0.5314909473306524">
                        <xhtml:span class="inline_block">chmod u=rw,go= /etc/ssh/sshd_config </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/ssh/sshd_config' exists">
                           <ecl:command>if [ ! -e "/etc/ssh/sshd_config" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/ssh/sshd_config against the provided permissions (0177).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/ssh/sshd_config are 'u-x,og-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/ssh/sshd_config 0177</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/ssh/sshd_config' exists">
                           <ecl:command>if [ ! -e "/etc/ssh/sshd_config" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/ssh/sshd_config
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/etc/ssh/sshd_config' is 'root:system'">
                           <ecl:command>ls -l /etc/ssh/sshd_config | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.19_Configuring_SSH_-_ssh_config_permissions_lockdown" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Configuring SSH - ssh_config permissions lockdown</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">/etc/ssh/sshd_config</xhtml:span> file defines SSH client behavior.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/</xhtml:span>
                        <xhtml:span>etc/ssh/ssh_config</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file is the system-wide client configuration file for OpenSSH, which allows you to set options that modify the operation of the client programs. </xhtml:span>
                  <xhtml:span>The recommended value is not to provide any writable access rights for any user, other than the owner of the file.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Change the permissions of the <xhtml:span class="inline_block">/etc/ssh/ssh_config</xhtml:span> file to ensure that only the owner can read and write to the file:</xhtml:p>
                     <xhtml:code class="pre_0.23932415595775763">
                        <xhtml:span class="inline_block">chmod u=rw,go=r /etc/ssh/ssh_config </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/ssh/ssh_config' exists">
                           <ecl:command>if [ ! -e "/etc/ssh/ssh_config" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/ssh/ssh_config against the provided permissions (0133).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/ssh/ssh_config' are 'u-x,og-wx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/ssh/ssh_config 0133</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/ssh/ssh_config&#10;' exists">
                           <ecl:command>if [ ! -e "/etc/ssh/ssh_config " ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/ssh/ssh_config

                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/etc/ssh/ssh_config' is 'root:system'">
                           <ecl:command>ls -l /etc/ssh/ssh_config | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.3_Sendmail_Configuration">
         <xccdf:title xml:lang="en">Sendmail Configuration</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
               <xhtml:span>During the implementation of the default customized aixpert XML file the <xhtml:span class="inline_block">
                     <xhtml:span>sendmail </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>daemon will have been disabled. However, if the <xhtml:span class="inline_block">
                     <xhtml:span>sendmail </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>service is active and required in the environment, </xhtml:span>the recommendations in this section should be applied.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3.1_etcmailsendmail.cf_-_SmtpGreetingMessage" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/mail/sendmail.cf - SmtpGreetingMessage</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to change the default <xhtml:span class="inline_block">
                        <xhtml:span>sendmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>greeting string to not display the <xhtml:span class="inline_block">
                        <xhtml:span>sendmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>version and other related information. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>s</xhtml:span>
                        <xhtml:span>endmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>deamon has a history of security vulnerabilities. The recommendation is to change the default <xhtml:span class="inline_block">
                        <xhtml:span>sendmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>greeting string so as not to display the </xhtml:span>
                  <xhtml:span>sendmail </xhtml:span>
                  <xhtml:span>version and other related information, which can be used by an attacker for fingerprinting purposes.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Create a backup copy of <xhtml:span class="inline_block">/etc/mail/sendmail.cf</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.14480647931178592">
                        <xhtml:span class="inline_block">cp -p /etc/mail/sendmail.cf /etc/mail/sendmail.cf.pre_cis </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>Edit:</xhtml:p>
                     <xhtml:code class="pre_0.5024119488323654">
                        <xhtml:span class="inline_block">vi /etc/mail/sendmail.cf </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>Change:</xhtml:p>
                     <xhtml:code class="pre_0.20944182919779491">
                        <xhtml:span class="inline_block">O SmtpGreetingMessage=$j Sendmail $b </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>To:</xhtml:p>
                     <xhtml:code class="pre_0.5198328045997389">
                        <xhtml:span class="inline_block">O SmtpGreetingMessage=mailerready </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure 'SmtpGreetingMessage' is changed in '/etc/mail/sendmail.cf' to supress the sendmail version">
                     <ecl:command>grep "SmtpGreetingMessage=" /etc/mail/sendmail.cf</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^O\s*SmtpGreetingMessage=mailerready"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3.2_etcmailsendmail.cf_-_permissions_and_ownership" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/mail/sendmail.cf - permissions and ownership</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommended permissions and ownership for <xhtml:span class="inline_block">
                        <xhtml:span>/etc/mail/sendmail.cf</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> are applied.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/mail/sendmail.cf </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file is used by the <xhtml:span class="inline_block">
                        <xhtml:span>sendmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon to determine its default configuration. This file must be protected from unauthorized access and modifications.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Set the recommended permissions and ownership on <xhtml:span class="inline_block">
                           <xhtml:span>/etc/mail/sendmail.cf</xhtml:span>
                        </xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.9233357804722647">
                        <xhtml:span class="inline_block">chmod u=rw,g=r,o= /etc/mail/sendmail.cf<xhtml:br/>chown root /etc/mail/sendmail.cf </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/mail/sendmail.cf' exists">
                           <ecl:command>if [ ! -e "/etc/mail/sendmail.cf" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/mail/sendmail.cf against the provided permissions (0137).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/mail/sendmail.cf' are 'u-x,g-wx,o-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/mail/sendmail.cf 0137</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/mail/sendmail.cf' exists">
                           <ecl:command>if [ ! -e "/etc/mail/sendmail.cf" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/mail/sendmail.cf
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/etc/mail/sendmail.cf' is 'root:system'">
                           <ecl:command>ls -l /etc/mail/sendmail.cf | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3.3_varspoolmqueue_-_permissions_and_ownership" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/var/spool/mqueue - permissions and ownership</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The recommended permissions and ownership for </xhtml:span>
                  <xhtml:span>the <xhtml:span class="inline_block">/var/spool/mqueue </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>directory</xhtml:span>
                  <xhtml:span>are applied.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>sendmail </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon generally stores its queued mail in the <xhtml:span class="inline_block">
                        <xhtml:span>/</xhtml:span>
                        <xhtml:span>var/spool/mqueue </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>directory. Queued messages are the messages that have not yet reached their final destination. To ensure the integrity of the messages during storage, the mail queue directory must be secured from unauthorized access. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>NOTE: </xhtml:span>
                  <xhtml:span>It is possible to specify an alternate spool directory in the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/mail/sendmail.cf</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file via the <xhtml:span class="inline_block">
                        <xhtml:span>QueueDirectory </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>parameter.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Set the recommended permissions and ownership on <xhtml:span class="inline_block">
                              <xhtml:span>/var/spool/mqueue</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.09072123640782176">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chmod u=rwx,go= /var/spool/mqueue</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chown root /var/spool/mqueue</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/spool/mqueue' exists">
                           <ecl:command>if [ ! -e "/var/spool/mqueue" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/spool/mqueue against the provided permissions (0077).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions of '/var/spool/mqueue' are 'go-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/spool/mqueue 0077</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/spool/mqueue' exists">
                           <ecl:command>if [ ! -e "/var/spool/mqueue" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -ld on /var/spool/mqueue
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/var/spool/mqueue' is 'root:system'">
                           <ecl:command>ls -ld /var/spool/mqueue | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.4_Common_Desktop_Environment_CDE">
         <xccdf:title xml:lang="en">Common Desktop Environment (CDE)</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>During the implementation of the default customized aixpert XML file, CDE will have been disabled as the <xhtml:span class="inline_block">
                     <xhtml:span>/etc/rc.dt</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span> startup file will have been removed from <xhtml:span class="inline_block">
                     <xhtml:span>/etc/inittab</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>. </xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>CDE has a history of security problems and should remain disabled. However, if the server has a graphics adapter and CDE is used then the recommendations in this section should be followed to enhance security. If CDE is not required and the filesets are installed, is recommended that the filesets are de-installed to avoid exposure to potential security vulnerabilities. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.1_CDE_-_de-installing_CDE" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">CDE - de-installing CDE</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to de-install CDE from the system, assuming that it is not required and is already installed. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>CDE has a history of security problems and should be disabled. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>NOTE: If CDE is required, it is vital to patch the software and consider TCP Wrappers to further enhance security. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Identity if CDE is already installed:</xhtml:p>
                     <xhtml:code class="pre_0.9039737984958439">
                        <xhtml:span class="inline_block">lslpp -L |grep -i CDE </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>If there are CDE filesets installed - de-install them if CDE is not required.<xhtml:br/>For each fileset preview the de-installation:</xhtml:p>
                     <xhtml:code class="pre_0.29863585734118436">
                        <xhtml:span class="inline_block">installp -up &lt;fileset name&gt;</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>Review the fileset removal preview output, paying particular attention to the other pre-requisites that will also be removed. Typically only <xhtml:span class="inline_block">X11.Dt </xhtml:span>filesets should be de-installed as pre-requisites.<xhtml:br/>Once reviewed, de-install the fileset and pre-requisites:</xhtml:p>
                     <xhtml:code class="pre_0.6198196167712333">
                        <xhtml:span class="inline_block">installp -ug &lt;fileset name&gt; </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>NOTE: Repeat until all CDE filesets are de-installed</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure all CDE filesets are removed from the system" success="fail">
                     <ecl:command>lslpp -L |grep -i "CDE"</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.2_CDE_-_disabling_dtlogin" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">CDE - disabling dtlogin</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Do not start CDE automatically on system boot. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The implementation of the customized aixpert XML file disables CDE if there is not a graphical console attached to the system. If there is a graphical console or the XML file has not been executed, consider disabling CDE anyway.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Disable CDE start up:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.35695246097252886">
                           <xhtml:span class="inline_block">/usr/dt/bin/dtconfig -d</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: If CDE is not installed the command will not be found</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.3_CDE_-_sgidsuid_binary_lockdown" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">CDE - sgid/suid binary lockdown</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>CDE buffer overflow vulnerabilities may be exploited by a local user to obtain root privilege via <xhtml:span class="inline_block">
                        <xhtml:span>suid</xhtml:span>
                        <xhtml:span>/</xhtml:span>
                        <xhtml:span>sgid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>programs owned by <xhtml:span class="inline_block">
                        <xhtml:span>root:bin </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>or <xhtml:span class="inline_block">
                        <xhtml:span>root:sys</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>CDE has been associated with major security risks, most of which are buffer overflow vulnerabilities. These vulnerabilities may be exploited by a local user to obtain root privilege via <xhtml:span class="inline_block">
                        <xhtml:span>suid/sgid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>programs owned by <xhtml:span class="inline_block">
                        <xhtml:span>root:bin </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>or <xhtml:span class="inline_block">
                        <xhtml:span>root:sys</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>It is recommended that the CDE binaries have the <xhtml:span class="inline_block">
                        <xhtml:span>suid/sgid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>removed.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove the <xhtml:span class="inline_block">
                              <xhtml:span>suid/sgid </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>from the following CDE binaries</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7226728190358505">
                           <xhtml:span class="inline_block">chmod ug-s /usr/dt/bin/dtaction<xhtml:br/>chmod ug-s /usr/dt/bin/dtappgather<xhtml:br/>chmod ug-s /usr/dt/bin/dtprintinfo<xhtml:br/>chmod ug-s /usr/dt/bin/dtsession</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/dt/bin/dtaction' exists">
                           <ecl:command>if [ ! -e "/usr/dt/bin/dtaction" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/dt/bin/dtaction against the provided permissions (4222).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'suid' and 'sgid' permissions are removed from '/usr/dt/bin/dtaction'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/dt/bin/dtaction 4222</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/dt/bin/dtappgather' exists">
                           <ecl:command>if [ ! -e "/usr/dt/bin/dtappgather" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/dt/bin/dtappgather against the provided permissions (4222).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'suid' and 'sgid' permissions are removed from '/usr/dt/bin/dtappgather'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/dt/bin/dtappgather 4222</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/dt/bin/dtprintinfo' exists">
                           <ecl:command>if [ ! -e "/usr/dt/bin/dtprintinfo" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/dt/bin/dtprintinfo against the provided permissions (4222).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'suid' and 'sgid' permissions are removed from '/usr/dt/bin/dtprintinfo'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/dt/bin/dtprintinfo 4222</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/usr/dt/bin/dtsession' exists">
                           <ecl:command>if [ ! -e "/usr/dt/bin/dtsession" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /usr/dt/bin/dtsession against the provided permissions (4222).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure 'suid' and 'sgid' permissions are removed from '/usr/dt/bin/dtsession'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /usr/dt/bin/dtsession 4222</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.4_CDE_-_remote_GUI_login_disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">CDE - remote GUI login disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The XDMCP service allows remote systems to start local </xhtml:span>
                  <xhtml:span>X login sessions.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The XDMCP service should be disabled unless there is a requirement to allow remote X servers to start login sessions. If the ability to host remote X servers is not required, disable the service. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Copy <xhtml:span class="inline_block">
                              <xhtml:span>/usr/dt/config/Xconfig </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>to <xhtml:span class="inline_block">
                              <xhtml:span>/etc/dt/config </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>if it does not already exist:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.20678843797684565">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>ls -l /etc/dt/config/Xconfig</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>If the file does not exist, create it:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.17152793579970943">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>mkdir -p /etc/dt/config </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>cp /usr/dt/config/Xconfig /etc/dt/config </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Disable remote X sessions from being started:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.1409151302700941">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>vi /etc/dt/config/Xconfig</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Replace:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5558643904061862">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span># Dtlogin.requestPort: 0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>With:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.03230746396034456">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>Dtlogin.requestPort: 0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure 'Dtlogin.requestPort' is set to '0' in '/etc/dt/config/Xconfig'" success="pass">
                     <ecl:command>[[ ! -f /etc/dt/config/Xconfig ]] &amp;&amp; RC=0 || grep "^Dtlogin.requestPort:[[::blank::]]*0" /etc/dt/config/Xconfig </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.5_CDE_-_screensaver_lock" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">CDE - screensaver lock</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The default timeout is 30 minutes of keyboard and mouse inactivity before a password protected screensaver is invoked by the CDE session manager.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The default timeout of 30 minutes prior to a password protected screensaver being invoked is too long. The recommendation is to set this to 10 minutes to protect from unauthorized access on unattended systems. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Set the default timeout parameters <xhtml:span class="inline_block">
                              <xhtml:span>dtsession*saverTimeout:</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> and <xhtml:span class="inline_block">
                              <xhtml:span>dtsession*lockTimeout</xhtml:span>
                              <xhtml:span>:</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.16869855843434905">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>for file in /usr/dt/config/*/sys.resources; do</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span> dir=`dirname $file | sed -e s/usr/etc/`</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span> mkdir -p $dir</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span> echo 'dtsession*saverTimeout: 10' &gt;&gt; $dir/sys.resources</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span> echo 'dtsession*lockTimeout: 10' &gt;&gt; $dir/sys.resources</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>done</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure 'dtsession lockTimeout' is set to '10' in '/etc/dt/config/*/sys.resources'" success="pass">
                        <ecl:command>[[ ! -d /etc/dt/config ]] &amp;&amp; RC=0 || [[ $(ls /etc/dt/config/*/sys.resources |wc -l) -eq $(grep '^dtsession\*lockTimeout:[[:blank:]]*10' /etc/dt/config/*/sys.resources |wc -l) ]]</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure 'dtsession saverTimeout' is set to '10' in '/etc/dt/config/*/sys.resources'" success="pass">
                        <ecl:command>[[ ! -d /etc/dt/config ]] &amp;&amp; RC=0 || [[ $(ls /etc/dt/config/*/sys.resources |wc -l) -eq $(grep '^dtsession\*saverTimeout:[[:blank:]]*10' /etc/dt/config/*/sys.resources |wc -l) ]]</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.6_CDE_-_login_screen_hostname_masking" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">CDE - login screen hostname masking</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">Dtlogin*greeting.labelString </xhtml:span>parameter is the message displayed in the first dialogue box on the CDE login screen. This is where the username is entered.</xhtml:p>
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>Dtlogin*greeting.persLabelString </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is the message displayed in the second dialogue box on the CDE login screen. This is where the password is entered.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Potential hackers may gain access to valuable information such as the hostname and the version of the operating system from the default AIX login screen. This information would assist hackers in choosing the exploitation methods to break into the system. For security reasons, change the login screen default messages. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Copy the files from <xhtml:span class="inline_block">
                              <xhtml:span>/usr/dt/config/*/Xresources </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>to <xhtml:span class="inline_block">
                              <xhtml:span>/etc/dt/config/*/Xresources </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and add the <xhtml:span class="inline_block">
                              <xhtml:span>Dtlogin*greeting.labelString </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and <xhtml:span class="inline_block">
                              <xhtml:span>Dtlogin*greeting.persLabelString </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>parameters to all copied <xhtml:span class="inline_block">
                              <xhtml:span>Xresources</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> files:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.5309625050186881">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>for file in /usr/dt/config/*/Xresources; do</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>dir=`dirname $file | sed s/usr/etc/`</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>mkdir -p $dir</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>if [ ! -f $dir/Xresources ]; then</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>cp $file $dir/Xresources</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>fi</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>WARN="Authorized uses only. All activity may be monitored and</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>reported."</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>echo "Dtlogin*greeting.labelString: $WARN" &gt;&gt;$dir/Xresources</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>echo "Dtlogin*greeting.persLabelString: $WARN" &gt;&gt;$dir/Xresources</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>done</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure 'Dtlogin*greeting.labelString' is set to an AUP in '/etc/dt/config/*/Xresources'" success="pass">
                        <ecl:command>[[ ! -d /etc/dt/config ]] &amp;&amp; RC=0 || [[ $(ls /etc/dt/config/*/Xresources |wc -l) -eq $(grep '^Dtlogin\*greeting.labelString:[ ]Authorized[ ]uses[ ]only.' /etc/dt/config/*/Xresources |wc -l) ]]</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure 'Dtlogin*greeting.persLabelString' is set to an AUP in '/etc/dt/config/*/Xresources'" success="pass">
                        <ecl:command>[[ ! -d /etc/dt/config ]] &amp;&amp; RC=0 || [[ $(ls /etc/dt/config/*/Xresources |wc -l) -eq $(grep '^Dtlogin\*greeting.persLabelString:[ ]Authorized[ ]uses[ ]only.' /etc/dt/config/*/Xresources |wc -l) ]]</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.7_CDE_-_etcdtconfigXconfig_permissions_and_ownership" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">CDE - /etc/dt/config/Xconfig permissions and ownership</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/dt/config/Xconfig</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file is used to customize CDE DT login attributes. Ensure this file is owned by <xhtml:span class="inline_block">r<xhtml:span class="inline_block">oot:bin</xhtml:span>
                     </xhtml:span>and permissions prevent <xhtml:span class="inline_block">group </xhtml:span>and <xhtml:span class="inline_block">other </xhtml:span>from writing to the file.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/dt/config/Xconfig</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file can be used to customize CDE DT login attributes. The default file, <xhtml:span class="inline_block">
                        <xhtml:span>/usr/dt/config/Xconfig</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Check to see if the <xhtml:span class="inline_block">/etc/dt/config/Xconfig </xhtml:span>exists:</xhtml:p>
                     <xhtml:code class="pre_0.07111839561453981">
                        <xhtml:span class="inline_block">ls -l /etc/dt/config/Xconfig </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>Apply the appropriate ownership and permissions to <xhtml:span class="inline_block">/etc/dt/config/Xconfig</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.4197087018696329">
                        <xhtml:span class="inline_block">chown root:bin /etc/dt/config/Xconfig<xhtml:br/>chmod go-w /etc/dt/config/Xconfig </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/dt/config/Xconfig' exists">
                           <ecl:command>if [ ! -e "/etc/dt/config/Xconfig" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/dt/config/Xconfig
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:bin
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/etc/dt/config/Xconfig' is owned by 'root:bin'">
                           <ecl:command>ls -l /etc/dt/config/Xconfig | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:bin"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/dt/config/Xconfig' exists">
                           <ecl:command>if [ ! -e "/etc/dt/config/Xconfig" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/dt/config/Xconfig against the provided permissions (0022).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/dt/config/Xconfig' are 'og-w'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/dt/config/Xconfig 0022</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.8_CDE_-_etcdtconfigXservers_permissions_and_ownership" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">CDE - /etc/dt/config/Xservers permissions and ownership</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/dt/config/Xservers </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>contains entries to start the Xserver on the local display. Ensure this file is owned by <xhtml:span class="inline_block">root:bin</xhtml:span> and prevents <xhtml:span class="inline_block">group </xhtml:span>and <xhtml:span class="inline_block">other </xhtml:span>from writing to it.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/dt/config/Xservers</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> contains entries to start the Xserver on the local display</xhtml:span>
                  <xhtml:span>. The default file</xhtml:span>
                  <xhtml:span>, <xhtml:span class="inline_block">
                        <xhtml:span>/usr/dt/config/Xservers</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, </xhtml:span>
                  <xhtml:span>is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions</xhtml:span>
                  <xhtml:span> and ownership</xhtml:span>
                  <xhtml:span> are applied to</xhtml:span>
                  <xhtml:span> secure </xhtml:span>
                  <xhtml:span>the file. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Check to see if the <xhtml:span class="inline_block">
                              <xhtml:span>/etc/dt/config/Xservers </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>exists:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.579040313380558">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>ls -l /etc/dt/config/Xservers</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If it exists ensure that it is explicitly defined in</xhtml:span>
                           <xhtml:span>
                              <xhtml:span class="inline_block">/etc/dt/config/Xconfig</xhtml:span>:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.05731572055598755">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>vi /etc/dt/config/Xconfig</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Replace:</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.24439684823806812">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>Dtlogin.servers: Xservers</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:br/>
                        <xhtml:span>With:</xhtml:span>
                     </xhtml:div>
                     <xhtml:code class="pre_0.5514043213485684">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>Dtlogin*servers: /etc/dt/config/Xservers</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:span>Apply the appropriate ownership and permissions to <xhtml:span class="inline_block">
                              <xhtml:span>/etc/dt/config/Xservers</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.9154159139671758">
                        <xhtml:span class="n_romve">
                           <xhtml:span class="inline_block">
                              <xhtml:span class="n_romve">chown root:bin /etc/dt/config/Xservers<xhtml:br/>chmod go-w /etc/dt/config/Xservers </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/dt/config/Xservers' exists">
                           <ecl:command>if [ ! -e "/etc/dt/config/Xservers" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/dt/config/Xservers against the provided permissions (0044).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/dt/config/Xservers' are 'og-w'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/dt/config/Xservers 0044</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/dt/config/Xservers' exists">
                           <ecl:command>if [ ! -e "/etc/dt/config/Xservers" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/dt/config/Xservers
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:bin
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/etc/dt/config/Xservers' is owned by 'root:bin'">
                           <ecl:command>ls -l /etc/dt/config/Xservers | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:bin"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.9_CDE_-_etcdtconfigXresources_permissions_and_ownership" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">CDE - /etc/dt/config/*/Xresources permissions and ownership</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/dt/config/*/Xresources </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file contains appearance and behavior resources for the <xhtml:span class="inline_block">Dtlogin</xhtml:span> login screen.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/dt/config/*/Xresources </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file d</xhtml:span>
                  <xhtml:span>efines the customization of the <xhtml:span class="inline_block">Dtlogin </xhtml:span>screen. The default file</xhtml:span>
                  <xhtml:span>,</xhtml:span>
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>/usr/dt/config/*/Xresources</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, </xhtml:span>
                  <xhtml:span>is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions</xhtml:span>
                  <xhtml:span> and ownership</xhtml:span>
                  <xhtml:span> are applied to</xhtml:span>
                  <xhtml:span> secure </xhtml:span>
                  <xhtml:span>the file. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Set the appropriate permissions and ownership on all <xhtml:span class="inline_block">Xresources </xhtml:span>files:</xhtml:p>
                     <xhtml:code class="pre_0.6295877732403377">
                        <xhtml:span class="inline_block">chown root:sys /etc/dt/config/*/Xresources<xhtml:br/>chmod u=rw,go=r /etc/dt/config/*/Xresources </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="none exist" comment="Ensure permissions of '/etc/dt/config/*/Xresources' are 'u-x,go-wx'">
                        <ecl:command> [[ ! -d /etc/dt/config ]] &amp;&amp; RC=0 || ls -l /etc/dt/config/*/Xresources |awk '{print $1 , $9}' |egrep '^.....w....|^........w.' </ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure ownership of '/etc/dt/config/*/Xresources' is root:sys" success="pass">
                        <ecl:command>[[ ! -d /etc/dt/config ]] &amp;&amp; RC=0 || [[ $(ls /etc/dt/config/*/Xresources |wc -l) -eq $(find /etc/dt/config/*/Xresources -user root -group sys |wc -l) ]] &amp;&amp; RC=0</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.5_NFS">
         <xccdf:title xml:lang="en">NFS</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>During the implementation of the default customized aixpert XML file, NFS services will have been disabled as the <xhtml:span class="inline_block">
                     <xhtml:span>/etc/rc.nfs </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>startup file will have been removed from <xhtml:span class="inline_block">
                     <xhtml:span>/etc/inittab</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>. </xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>The first recommendation in this section is to de-install NFS to complete the lockdown of this service. However, if the server acts as either an NFS server or NFS client there are further security recommendations to implement. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.1_NFS_-_de-install_NFS_client" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NFS - de-install NFS client</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>De-install NFS client if the server does not remotely mount NFS shares.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>NFS is frequently exploited to gain unauthorized access to file and directories. Unless the server needs to act as an NFS server or client, the filesets should be de-installed. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure that there are no current NFS client mounts:</xhtml:p>
                     <xhtml:code class="pre_0.6613426813014456">
                        <xhtml:span class="inline_block">mount |grep "nfs"<xhtml:br/>cat /etc/filesystems |grep "nfs" </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>The above commands should yield no output.</xhtml:p>
                     <xhtml:p>De-install the NFS client software:</xhtml:p>
                     <xhtml:code class="pre_0.07912281907163648">
                        <xhtml:span class="inline_block">installp -u bos.net.nfs.client </xhtml:span>
                     </xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure the 'bos.net.nfs.client' fileset is removed from the system" success="fail">
                     <ecl:command>lslpp -L bos.net.nfs.client</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.2_NFS_-_de-install_NFS_server" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NFS - de-install NFS server</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>De-install NFS server if the server does not act as an NFS server to remote clients.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>NFS is frequently exploited to gain unauthorized access to file and directories. Unless the server needs to act as an NFS server or client, the filesets should be de-installed. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure that there are no current NFS exports:</xhtml:p>
                     <xhtml:code class="pre_0.7832325471800026">
                        <xhtml:span class="inline_block">cat /etc/exports </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>The above command should yield no output. Or the file should not exist. </xhtml:p>
                     <xhtml:p>De-install the NFS sever software:</xhtml:p>
                     <xhtml:code class="pre_0.5433414167873702">
                        <xhtml:span class="inline_block">installp -u bos.net.nfs.server </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>If there was an empty <xhtml:span class="inline_block">/etc/exports</xhtml:span> file, remove it:</xhtml:p>
                     <xhtml:code class="pre_0.8944059231559408">
                        <xhtml:span class="inline_block">rm /etc/exports </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure the 'bos.net.nfs.server' fileset is removed from the system" success="fail">
                     <ecl:command>lslpp -L |grep bos.net.nfs.server</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.3_NFS_-_nosuid_on_NFS_client_mounts" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NFS - nosuid on NFS client mounts</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Disable </xhtml:span>
                  <xhtml:span>suid/sgid </xhtml:span>
                  <xhtml:span>program execution within any mounted NFS filesystem. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Setting the <xhtml:span class="inline_block">
                        <xhtml:span>nosuid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>option means that on the NFS server the root user cannot make an </xhtml:span>
                  <xhtml:span>suid</xhtml:span>
                  <xhtml:span>-root program within an exported filesystem. Then log onto an NFS client as a standard user and use the </xhtml:span>
                  <xhtml:span>suid</xhtml:span>
                  <xhtml:span>-root program to effectively become root on that client. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>For each NFS mount, disable suid programs.<xhtml:br/>List the current NFS mounts:</xhtml:p>
                     <xhtml:code class="pre_0.26713102805295396">
                        <xhtml:span class="inline_block">mount |grep "nfs" </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>For each NFS filesystem add the nosuid option, this change should be made via an edit to the <xhtml:span class="inline_block">/etc/filesystems </xhtml:span>file.<xhtml:br/>Create a copy of <xhtml:span class="inline_block">/etc/filesystems</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.3428476707044879">
                        <xhtml:span class="inline_block">cp -p /etc/filesystems /etc/filesystems.pre_cis </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>For each NFS mount edit the options line to reflect the nosuid option:</xhtml:p>
                     <xhtml:code class="pre_0.13657152586480792">
                        <xhtml:span class="inline_block">vi /etc/filesystems </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>Reflect in each NFS options line:</xhtml:p>
                     <xhtml:code class="pre_0.9354000907426596">
                        <xhtml:span class="inline_block">options = rw,bg,hard,intr,nosuid,sec=sys </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>NOTE: The above options line is an example, the nosuid should be added to the existing options<xhtml:br/>The NFS mount needs to be re-mounted to reflect this change</xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure 'nosuid' is set on all NFS client mounts">
                     <ecl:command>mount |grep "nfs" |egrep -v "nosuid"; lsfs |grep "nfs" |egrep -v "nosuid"</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.4_NFS_-_localhost_removal" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NFS - localhost removal</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Remove any reference to localhost or localhost aliases from <xhtml:span class="inline_block">
                        <xhtml:span>/etc/exports</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If the RPC portmapper has proxy forwarding enabled, which is a default setting in many vendor versions. You must not export your local filesytems back to the localhost, either by name or to the alias localhost, and you must not export to any netgroups of which your host is a member. If proxy forwarding is enabled, an attacker may carefully craft NFS packets and send them to the portmapper, which in turn, forwards them to the NFS server. As the packets come from the portmapper process, which runs as root, they appear to be coming from a trusted system. This configuration may allow anyone to alter and delete files at will. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Remove any reference to localhost or localhost aliases in <xhtml:span class="inline_block">/etc/exports</xhtml:span>:<xhtml:br/>Review the content of <xhtml:span class="inline_block">/etc/exports</xhtml:span> and check for localhost or localhost aliases:</xhtml:p>
                     <xhtml:code class="pre_0.008330747372892188">
                        <xhtml:span class="inline_block">cat /etc/exports </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>NOTE: If instances of localhost or localhost aliases are found, edit the file and remove them.<xhtml:br/>Create a copy of <xhtml:span class="inline_block">
                           <xhtml:span class="n_romve">/etc/exports</xhtml:span>
                        </xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.6563651723068129">
                        <xhtml:span class="inline_block">cp -p /etc/exports /etc/exports.pre_cis</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>Edit the file:</xhtml:p>
                     <xhtml:code class="pre_0.6601127396517566">
                        <xhtml:span class="inline_block">vi /etc/exports</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>Edit the relevant NFS exports to remove the localhost access, for example:</xhtml:p>
                     <xhtml:code class="pre_0.818050426410825">
                        <xhtml:span class="inline_block">/nfsexport sec=sys,rw,access=localhost:testserver </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>If <xhtml:span class="inline_block">/etc/exports</xhtml:span> is updated, as localhost references have been removed, update the current NFS export options:</xhtml:p>
                     <xhtml:code class="pre_0.3154748339847683">
                        <xhtml:span class="inline_block">exportfs -a </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure 'localhost' does not exist in '/etc/exports'">
                     <ecl:command> [[ ! -f /etc/exports ]] &amp;&amp; RC=0 || grep "localhost" /etc/exports</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.5_NFS_-_restrict_NFS_access" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NFS - restrict NFS access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Only allow explicitly defined host access to NFS exported filesystems and directories.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The NFS server should be configured to only allow explicitly defined hosts to mount filesystems from the server. If an unauthorized host is denied the permission to mount a filesystem, then the unauthorized users on that host will not be able to access the server's files. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The default value of access allows any machine to mount any exported filesystems/directories.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure that all exports defined in <xhtml:span class="inline_block">/etc/exports </xhtml:span>have explicit client access options which clearly define the host or hosts allowed access:<xhtml:br/>Review the content of <xhtml:span class="inline_block">/etc/exports </xhtml:span>and that all exports have explicit access lists:</xhtml:p>
                     <xhtml:code class="pre_0.5354081504573809">
                        <xhtml:span class="inline_block">cat /etc/exports </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>Ensure that each NFS export has an explicit access line, for example:</xhtml:p>
                     <xhtml:code class="pre_0.26971198060344564">
                        <xhtml:span class="inline_block">/usr/spool/mail -access=symmachine </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>If the file is updated, to reflect client access changes, update the current NFS export options:</xhtml:p>
                     <xhtml:code class="pre_0.8385735469210094">
                        <xhtml:span class="inline_block">exportfs -a </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure all exports set 'access=' in '/etc/exports'">
                     <ecl:command>[[ ! -f /etc/exports ]] &amp;&amp; RC=0 || egrep -v "access=" /etc/exports</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.6_NFS_-_no_root_squash_option" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NFS - no_root_squash option</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>For each NFS export, ensure that the </xhtml:span>
                  <xhtml:span>root_squash</xhtml:span>
                  <xhtml:span> option is set to -2 or -1.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Each NFS export on the server should have the <xhtml:span class="inline_block">anon=-2</xhtml:span> option set. Without this, an NFS export could be at risk, where the remote root user effectively has root access on the NFS mount. By setting the export option <xhtml:span class="inline_block">anon=-2</xhtml:span> , when the client attempts to access (read, write, or delete) the NFS mount, the server substitutes the UID to the server's nobody account, which is -2. This means that the root user on the client cannot access or change files that only root on the server can access or change. It is therefore recommended that root_squash is set on all exported filesystems. <xhtml:br/>The default value of any exported filesystem or directory is -2, another value has to be explicitly set.<xhtml:br/>As a more secure option you can set the option to <xhtml:span class="inline_block">anon=-1</xhtml:span>, which disables anonymous access. By default, secure NFS accepts
                  non-secure requests as anonymous.<xhtml:br/>NOTE: The root user on the client can still use <xhtml:span class="inline_block">su </xhtml:span>to become any other user and access and change that users files, assuming that the same user exists on the NFS server and owns files and/or directories in the NFS export.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Use smitty to change/validate this value for all NFS exported filesystems:</xhtml:p>
                     <xhtml:code class="pre_0.24664614867646323">
                        <xhtml:span class="inline_block">smitty chnfsexp </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>For each filesystem, as defined in the F4 list, set the following option:</xhtml:p>
                     <xhtml:code class="pre_0.20727521053145648">
                        <xhtml:span class="inline_block">Anonymous UID [-2] </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>NOTE: Press enter to accept the change<xhtml:br/>Once all exported filesystems have been successfully validated or changed, re-export the filesystems and directories to activate the new options:</xhtml:p>
                     <xhtml:code class="pre_0.8343006373038462">
                        <xhtml:span class="inline_block">exportfs -a </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure no exports set 'anon=' in '/etc/exports'">
                     <ecl:command>[[ ! -f /etc/exports ]] &amp;&amp; RC=0 || grep "anon=" /etc/exports</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.7_NFS_-_secure_NFS" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NFS - secure NFS</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>For each NFS export, ensure that the secure option is selected.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Secure NFS uses DES encryption or Kerberos to authenticate hosts involved in RPC transactions. RPC is a protocol used by NFS to communicate requests between hosts. Secure NFS mitigates attempts by an attacker to spoof RPC requests by encrypting the time stamp in the RPC requests. A receiver successfully decrypts the time stamp and confirms that it is correct. This serves as a confirmation that the RPC request came from a trusted host.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Use smitty to change/validate this value for all NFS exported filesystems:</xhtml:p>
                     <xhtml:code class="pre_0.9969452070969418">
                        <xhtml:span class="inline_block">smitty chnfsexp </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>For each filesystem, as defined in the F4 list. There are five security methods which can be used to define different security access methods for different clients:</xhtml:p>
                     <xhtml:code class="pre_0.97127935306499">
                        <xhtml:span class="inline_block">Security method 1 [sys,krb5p,krb5i,krb5,d&gt; +<xhtml:br/>* Mode to export directory read-write +<xhtml:br/> Hostname list. If exported read-mostly [] <xhtml:br/> Hosts &amp; netgroups allowed client access [] <xhtml:br/> Hosts allowed root access [] </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>The security method options are:</xhtml:p>
                     <xhtml:code class="pre_0.029590709128461512">
                        <xhtml:span class="inline_block">sys - UNIX authentication<xhtml:br/>dh - DES authentication<xhtml:br/>none - Use the anonymous ID if it has a value other than -1 <xhtml:br/>krb5 - Kerberos. Authentication only<xhtml:br/>krb5i - Kerberos. Authentication and integrity<xhtml:br/>krb5p - Authentication, integrity, and privacy </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>Once all exported filesystems have been successfully validated or changed, re-export the filesystems and directories to activate the new options:</xhtml:p>
                     <xhtml:code class="pre_0.008592801377416914">
                        <xhtml:span class="inline_block">exportfs -a </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure all exports set 'sec=' in '/etc/exports'">
                     <ecl:command>[[ ! -f /etc/exports ]] &amp;&amp; RC=0 || egrep -v "sec=" /etc/exports</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.6_NIS">
         <xccdf:title xml:lang="en">NIS</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>Network Information Service (NIS) or Yellow Pages (YP), is a client/server directory service </xhtml:span>
               <xhtml:span>protocol used for distributing system configuration data, such as: users, groups, passwords and hosts between computers in a network. This is typically done in larger environments to centralize the management of this data. </xhtml:span>
               <xhtml:span>If the NIS software is installed but not configured, an attacker can cripple a machine by starting NIS. In environments where NIS is utilized, tools like </xhtml:span>
               <xhtml:span>ypsnarf</xhtml:span>
               <xhtml:span>allow an attacker to grab the contents of your NIS maps, providing large amounts of information about your site.</xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>The first recommendation in this section is to de-install NIS, if it is installed, to lockdown this service. However, if NIS is used in the environment it is recommended that NIS+ is used instead. NIS+ is structured differently from NIS and supports secure and encrypted RPC, which resolves many of the security issues.</xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>The configuration of NIS+ is not within the scope of this benchmark; however the links below can be used for initial reference:</xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>AIX 7.1:</xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:a href="http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.nisplus%2Fdoc%2Fnisplus%2Ftrans_intro.htm">NIS+ transition</xhtml:a>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.1_NIS_-_de-install_NIS_client" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NIS - de-install NIS client</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>If NIS is not used in the environment, disable the NIS client and de-install the software.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>As NIS is extremely insecure, the NIS client packages must be removed from the system unless absolutely needed.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure that all of the NIS daemons are inactive:</xhtml:p>
                     <xhtml:code class="pre_0.7877782848342644">
                        <xhtml:span class="inline_block">stopsrc -g yp </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>De-install the NIS client software:</xhtml:p>
                     <xhtml:code class="pre_0.8759985433269973">
                        <xhtml:span class="inline_block">installp -u bos.net.nis.client </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure the 'bos.net.nis.client' fileset is removed from the system" success="fail">
                     <ecl:command>lslpp -L bos.net.nis.client</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.2_NIS_-_de-install_NIS_server" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NIS - de-install NIS server</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>If NIS is not used in the environment, disable the NIS server and de-install the software.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>As NIS is extremely insecure, the NIS server packages must be removed from the system unless absolutely needed.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure that all of the NIS daemons are inactive:</xhtml:p>
                     <xhtml:code class="pre_0.7406720158467061">
                        <xhtml:span class="inline_block">stopsrc -g yp </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>De-install the NIS server software:</xhtml:p>
                     <xhtml:code class="pre_0.2674753149915738">
                        <xhtml:span class="inline_block">installp -u bos.net.nis.server </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure the 'bos.net.nis.server' fileset is removed from the system" success="fail">
                     <ecl:command>lslpp -L bos.net.nis.server</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.3_NIS_-_remove_NIS_markers_from_password_and_group_files" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NIS - remove NIS markers from password and group files</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>If NIS has been de-installed in the environment, or has historically been used, ensure the + markers are removed from<xhtml:span class="inline_block">/etc/passwd</xhtml:span> and <xhtml:span class="inline_block">/etc/group</xhtml:span>.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The + entries in <xhtml:span class="inline_block">
                        <xhtml:span>/etc/passwd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>/etc/group </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>were used as markers to insert data from a NIS map. These entries may provide an avenue for attackers to gain privileged access on the system. The + entries must be deleted if they still exist. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Examine the <xhtml:span class="inline_block">/etc/passwd </xhtml:span>and <xhtml:span class="inline_block">/etc/group </xhtml:span>files:</xhtml:p>
                     <xhtml:code class="pre_0.9383592543406185">
                        <xhtml:span class="inline_block">grep "^+" /etc/passwd /etc/group </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>If the above command yields output, delete the + line:</xhtml:p>
                     <xhtml:code class="pre_0.0005711308431163853">
                        <xhtml:span class="inline_block">vi /etc/passwd<xhtml:br/>vi /etc/group </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="none exist" comment="Ensure there are no NIS markers in '/etc/passwd'">
                        <ecl:command>grep "^+" /etc/passwd</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="none exist" comment="Ensure there are no NIS markers in '/etc/group'">
                        <ecl:command>grep "^+" /etc/group</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.4_NIS_-_restrict_NIS_server_communication" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">NIS - restrict NIS server communication</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>If NIS must be used in the environment, limit access to the NIS data to specific subnets.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>By default the NIS server will authenticate all IP addresses if the <xhtml:span class="inline_block">
                        <xhtml:span>/var/yp/securenets </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file does not exist, or exists without any subnets defined. The <xhtml:span class="inline_block">
                        <xhtml:span>/var/yp/securenets </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file contains a list of subnets that are considered trusted and are allowed to access NIS data using the <xhtml:span class="inline_block">
                        <xhtml:span>ypserv</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>ypxfrd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemons. This is a user-created file that resides on a NIS master server and any slave servers. Without configuring this file, anyone with knowledge of the NIS server address and the domain name, can obtain NIS served data, including the contents of the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/passwd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file. Hence, it is recommended that the <xhtml:span class="inline_block">
                        <xhtml:span>/var/yp/securenets</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file is configured to restrict access. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Create and secure the <xhtml:span class="inline_block">
                              <xhtml:span>/var/yp/securenets </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>file (if it does not already exist)</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.30606209768767256">
                           <xhtml:span class="inline_block">touch /var/yp/securenets<xhtml:br/>chmod u=rw,go= /var/yp/securenets<xhtml:br/>chown root:system /var/yp/securenets<xhtml:br/>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Edit the file:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7064489666825235">
                           <xhtml:span class="inline_block">vi /var/yp/securenets</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Add the allowed subnets:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.041142645485576">
                           <xhtml:span class="inline_block">255.255.255.0 128.311.10.0</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: The format of the file is </xhtml:span>
                           <xhtml:span>netmask netaddr </xhtml:span>
                           <xhtml:span>as shown in the example above. Explicitly define all valid network subnets (one entry per line).</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Stop and start NIS to implement the configuration changes:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5513819342822395">
                           <xhtml:span class="inline_block">stopsrc -g yp<xhtml:br/>startsrc -g yp</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="If '/var/yp/securenets' exists ensure that it contains data" success="pass">
                        <ecl:command>[[ ! -f /var/yp/securenets ]] &amp;&amp; RC=0 || egrep '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' /var/yp/securenets</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/yp/securenets' exists">
                           <ecl:command>if [ ! -e "/var/yp/securenets" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/yp/securenets against the provided permissions (0177).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions of '/var/yp/securenets' are 'u-x,go-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/yp/securenets 0177</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/yp/securenets' exists">
                           <ecl:command>if [ ! -e "/var/yp/securenets" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /var/yp/securenets
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/var/yp/securenets' is 'root:system'">
                           <ecl:command>ls -l /var/yp/securenets | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.7_SNMP">
         <xccdf:title xml:lang="en">SNMP</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>
                  <xhtml:span>
                     <xhtml:span>The Simple Network Management Protocol (SNMP) is a commonly used service that provides network management and monitoring capabilities. SNMP offers the capability to poll networked devices and monitor data such as utilization and errors from various subsystems on the host. SNMP is also capable of changing the configurations on the host, allowing remote management of the system. The protocol uses a community string for authentication from the SNMP client to the SNMP agent on the managed device.</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span> </xhtml:span>
            </xhtml:p>
            <xhtml:p class="Default" style="margin: 0cm 0cm 0pt;">
               <xhtml:span>In AIX, two SNMP community names, <xhtml:span class="inline_block">
                     <xhtml:span>private </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>and <xhtml:span class="inline_block">
                     <xhtml:span>system</xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>, are enabled with read/write privileges, but only allow access from </xhtml:span>
               <xhtml:span>localhost </xhtml:span>
               <xhtml:span>connections. Nevertheless, a local user may install an SNMP client and modify sensitive variables. If SNMP is required, the community strings must be greater than six characters and include a combination of letters, numbers, and special characters to avoid a brute force attack. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.7.1_SNMP_-_disable_private_community_string" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">SNMP - disable private community string</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If <xhtml:span class="inline_block">
                        <xhtml:span>snmpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is required within the environment, disable the <xhtml:span class="inline_block">
                        <xhtml:span>private </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>community string. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>In AIX, two SNMP community names, <xhtml:span class="inline_block">
                        <xhtml:span>private </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>system</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, are enabled with read/write privileges, but are allowed access only from </xhtml:span>
                  <xhtml:span>localhost </xhtml:span>
                  <xhtml:span>connections. As these SNMP names are the default, they must not be used. Any SNMP community name should be a combination of letters, numbers and special characters to enhance security. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Create a backup of <xhtml:span class="inline_block">
                              <xhtml:span>/etc/snmpd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7651151522794531">
                           <xhtml:span class="inline_block">cp -p /etc/snmpd.conf /etc/snmpd.conf.pre_cis</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Edit the file:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7924702647738884">
                           <xhtml:span class="inline_block">vi /etc/snmpd.conf</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Comment out the <xhtml:span class="inline_block">
                                 <xhtml:span>private </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>entry:</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.04574835859059445">
                           <xhtml:span class="inline_block">#community private 127.0.0.1 255.255.255.255 readWrite</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that the 'private' entry has been commented out from '/etc/snmpd.conf'">
                     <ecl:command>grep "^community[[:blank:]]*private" /etc/snmpd.conf </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.7.2_SNMP_-_disable_system_community_string" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">SNMP - disable system community string</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If <xhtml:span class="inline_block">
                        <xhtml:span>snmpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is required within the environment, disable the </xhtml:span>
                  <xhtml:span>system</xhtml:span>
                  <xhtml:span> community string. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>In AIX, two SNMP community names, <xhtml:span class="inline_block">
                        <xhtml:span>private </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>system</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, are enabled with read/write privileges, but are allowed access only from </xhtml:span>
                  <xhtml:span>localhost </xhtml:span>
                  <xhtml:span>connections. As these SNMP names are the default, they must not be used. Any SNMP community name should be a combination of letters, numbers and special characters to enhance security. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Edit the file:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9839781274860186">
                           <xhtml:span class="inline_block">vi /etc/snmpd.conf</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Comment out the </xhtml:span>
                           <xhtml:span>system</xhtml:span>
                           <xhtml:span> entry:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5473973774239753">
                           <xhtml:span class="inline_block">#community system 127.0.0.1 255.255.255.255 readWrite 1.17.2</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that the 'system' entry has been commented out from '/etc/snmpd.conf'">
                     <ecl:command>grep "^community[[:blank:]]*system" /etc/snmpd.conf </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.7.3_SNMP_-_disable_public_community_string" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">SNMP - disable public community string</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If <xhtml:span class="inline_block">
                        <xhtml:span>snmpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is required within the environment, disable or change the <xhtml:span class="inline_block">
                        <xhtml:span>public </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>community string. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>public </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>community string can be polled by remote SNMP devices and pertinent information can be read or changed on the host. The <xhtml:span class="inline_block">
                        <xhtml:span>public </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>community string should but commented out, or if SNMP is a required service the <xhtml:span class="inline_block">
                        <xhtml:span>public </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>community name should be changed to be a combination of letters, numbers and special characters to enhance security. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:span>
                              <xhtml:span>
                                 <xhtml:span>Edit the file:</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.17038505397460762">
                           <xhtml:span>
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>
                                       <xhtml:span>vi /etc/snmpd.conf</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>
                              <xhtml:span>
                                 <xhtml:span>Comment out the <xhtml:span class="inline_block">
                                       <xhtml:span>public </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                              <xhtml:span>
                                 <xhtml:span>
                                    <xhtml:span>entry:</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9207993315460021">
                           <xhtml:span>
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>
                                       <xhtml:span>#community </xhtml:span>
                                    </xhtml:span>
                                    <xhtml:span>
                                       <xhtml:span>public</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that the 'public' entry has been commented out from '/etc/snmpd.conf'">
                     <ecl:command>grep "^community[[:blank:]]*public" /etc/snmpd.conf </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.7.4_SNMP_-_disable_Readwrite_community_access" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">SNMP - disable Readwrite community access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If <xhtml:span class="inline_block">
                        <xhtml:span>snmpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is required within the environment, disable <xhtml:span class="inline_block">
                        <xhtml:span>readWrite </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>permissions for all active community strings.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>
                     <xhtml:span>
                        <xhtml:span>If SNMP is required, none of the available community strings should have global <xhtml:span class="inline_block">
                              <xhtml:span>readWrite </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:span>
                     <xhtml:span>
                        <xhtml:span>permissions defined. This would allow any remote client to query and to set system configuration parameters. SNMP <xhtml:span class="inline_block">
                              <xhtml:span>readWrite </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:span>
                     <xhtml:span>
                        <xhtml:span>communities must be disabled unless absolutely necessary. If a <xhtml:span class="inline_block">
                              <xhtml:span>
                                 <xhtml:span>readWrite </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>
                     <xhtml:span>
                        <xhtml:span>
                           <xhtml:span>community is enabled, then access must be granted to only trusted machines in your network. As SNMP uses community names as part of authentication, you must ensure that all community names are greater than six characters and is a mix of characters, numbers, and special characters.</xhtml:span>
                        </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Identify if there are any currently configured community strings:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8049131698112886">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>grep "^community[[:blank:]]" /etc/snmpd.conf</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If there are active community strings, edit the configuration file:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5862605865018441">
                           <xhtml:span class="inline_block">vi /etc/snmpd.conf</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Replace all instances of:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9552196196329543">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>community &lt;community name&gt; &lt;IP addresses&gt; &lt;netmask&gt; [ readWrite &lt;view&gt;]</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>With:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6825132158848692">
                           <xhtml:span class="inline_block">community <xhtml:span>&lt;community name&gt; &lt;IP addresses&gt; &lt;netmask&gt; [ readOnly &lt;view&gt;]</xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure there is no 'readWrite' access to active community strings">
                     <ecl:command>grep "^community[[:blank:]]" /etc/snmpd.conf </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="\sreadWrite\s"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.7.5_SNMP_-_restrict_community_access" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">SNMP - restrict community access</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If <xhtml:span class="inline_block">
                        <xhtml:span>snmpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is required within the environment, implement IP access restrictions on the available community strings.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If SNMP is required, IP access restrictions should be put into place to limit which hosts or networks subnets are able to remotely poll the server. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Identify if there are any currently configured community strings:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4068561328634993">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>grep "^community[[:blank:]]" /etc/snmpd.conf</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>If there are active community strings, edit the configuration file:</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.9944689166912112">
                           <xhtml:span class="inline_block">vi /etc/snmpd.conf</xhtml:span>
                        </xhtml:code>
                        <xhtml:br/>
                        <xhtml:span>Implement IP access restrictions to ALL of the available community names e.g.:</xhtml:span>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.04309102345244359">
                           <xhtml:span class="inline_block">community tivoli 192.132.10.0 255.255.255.0 readOnly</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>The format of each line should reflect:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7706105227909868">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>community &lt;community name&gt; &lt;IP addresses&gt; &lt;netmask&gt; [ &lt;permissions&gt; &lt;view&gt;]</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure IP access restrictions have been implemented on all active SNMP community names in '/etc/snmpd.conf'">
                     <ecl:command>grep "^community[[:blank:]]" /etc/snmpd.conf |egrep -v '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}[[:blank:]][0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}'</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.8_Securing_inetd">
         <xccdf:title xml:lang="en">Securing inetd</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
               <xhtml:span>If all <xhtml:span class="inline_block">inetd </xhtml:span>services have been disabled and are not required, the <xhtml:span class="inline_block">
                     <xhtml:span>inetd </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>daemon itself can be disabled to further enhance security. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.8.1_inetd_-_disabling_inetd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">inetd - disabling inetd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>If all of services run and managed by <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>are disabled, disable the <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon itself. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>If all <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>services are disabled, then there is no need to start the daemon at boot time. An administrator can manually start the <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service post-IPL, if any of the <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>controlled </xhtml:span>
                  <xhtml:span>services are required. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Review any active <xhtml:span class="inline_block">
                              <xhtml:span>inetd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>services:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5561333367892617">
                           <xhtml:span class="inline_block">refresh -s inetd<xhtml:br/>lssrc -ls inetd</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: If there are active services and the services are required, do not disable <xhtml:span class="inline_block">
                                 <xhtml:span>inetd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>. Skip to the next section and consider the implementation of TCP Wrappers to secure access to these active services. If the active services are not required disable them via the <xhtml:span class="inline_block">
                                 <xhtml:span>chsubserver </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>command.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Disable <xhtml:span class="inline_block">
                              <xhtml:span>inetd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>if there are no active services:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4802013505794532">
                           <xhtml:span class="inline_block">chrctcp -d inetd<xhtml:br/>stopsrc -s inetd</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*inetd[[:blank:]]"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that 'inetd' is not enabled in '/etc/inetd.conf'">
                     <ecl:command>grep "^[[:blank:]]*inetd[[:blank:]]" /etc/inetd.conf </ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.9_Portmap_Lockdown">
         <xccdf:title xml:lang="en">Portmap Lockdown</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The <xhtml:span class="inline_block">portmap </xhtml:span>daemon is required for the RPC service. It converts the RPC program numbers into Internet port numbers. The daemon may be disabled if the server is not:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>An NFS client or server</xhtml:li>
               <xhtml:li>A NIS (YP) or NIS+ client or server</xhtml:li>
               <xhtml:li>Running the CDE GUI</xhtml:li>
               <xhtml:li>Running a third-party software application, which is dependent on RPC support</xhtml:li>
            </xhtml:ul>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.9.1_etcrc.tcpip_-_portmap" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">/etc/rc.tcpip - portmap</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If all RPC services are disabled, disable the <xhtml:span class="inline_block">
                        <xhtml:span>portmap </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon itself. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If all RPC services are disabled, then there is no need to start the <xhtml:span class="inline_block">
                        <xhtml:span>portmap </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon at boot time. An administrator can manually start <xhtml:span class="inline_block">
                        <xhtml:span>portmap </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>post-IPL, if any of the RPC services are required. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Review any active RPC services:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.08214125155405966">
                           <xhtml:span class="inline_block">rpcinfo -p localhost</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: If there are active RPC services and the services are required, do not disable <xhtml:span class="inline_block">
                                 <xhtml:span>portmap</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>. </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Disable <xhtml:span class="inline_block">
                              <xhtml:span>portmap </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>if there are no active RPC services:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.0064697008319646865">
                           <xhtml:span class="inline_block">chrctcp -d portmap<xhtml:br/>stopsrc -s portmap</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/portmap"'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist.
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure that '/usr/sbin/portmap' is not enabled in '/etc/rc.tcpip'">
                     <ecl:command>grep "^[[:blank:]]*start[[:blank:]]/usr/sbin/portmap" /etc/rc.tcpip</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.10_TCP_Wrappers">
         <xccdf:title xml:lang="en">TCP Wrappers</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>If some of the services running in <xhtml:span class="inline_block">/etc/inetd.conf </xhtml:span>are required, then it is recommended that TCP Wrappers are installed and configured to limit access to any active TCP and UDP services. </xhtml:span>
            </xhtml:p>
            <xhtml:p>TCP Wrappers allow the administrator to control who has access to various <xhtml:span class="inline_block">inetd </xhtml:span>network services via source IP address controls. TCP Wrappers also provide logging information via <xhtml:span class="inline_block">syslog </xhtml:span>about both successful and unsuccessful connections.</xhtml:p>
            <xhtml:p>TCP Wrappers are generally triggered via <xhtml:span class="inline_block">/etc/inetd.conf</xhtml:span>, but other options exist for "wrappering" non-<xhtml:span class="inline_block">inetd </xhtml:span>based software.</xhtml:p>
            <xhtml:p>The configuration of TCP Wrappers to suit a particular environment is outside the scope of this benchmark; however the following links will provide the necessary documentation to plan an appropriate implementation: </xhtml:p>
            <xhtml:p>
               <xhtml:span>
                  <xhtml:a href="ftp://ftp.porcupine.org/pub/security/index.html">
                     <xhtml:span>TCP Wrappers Home Page</xhtml:span>
                  </xhtml:a>
               </xhtml:span>
            </xhtml:p>
            <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">The website contains source code for both IPv4 and IPv6 versions.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.10.1_TCP_Wrappers_-_installing_TCP_Wrappers" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">TCP Wrappers - installing TCP Wrappers</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to install and configure TCP Wrappers if there are active <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>controlled services on the system.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>TCP Wrappers is a freely available IP packet filtering facility. It provides for greater and more specific control over local network services and the hosts that are allowed to access them. It also makes use of the standard <xhtml:span class="inline_block">
                        <xhtml:span>syslog </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>facility to track local network use.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Identity any active <xhtml:span class="inline_block">
                              <xhtml:span>inetd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>services:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5580873241973461">
                           <xhtml:span class="inline_block">refresh -s inetd<xhtml:br/>lssrc -ls inetd</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If there are any active TCP or UDP services, download and install the TCP Wrappers software:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>TCP Wrappers is bundled on the AIX media expansion cdrom.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Alternatively, the source code may be downloaded and compiled from:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:a href="ftp://ftp.porcupine.org/pub/security/">TCP Wrappers Source Code</xhtml:a>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>NOTE: Ensure that the latest version is downloaded. </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>The installation example below assumes that the AIX media expansion pack cdrom has been used as the source of the software.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Place the TCP Wrappers software into a convenient location, such as <xhtml:span class="inline_block">
                              <xhtml:span>/tmp </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and install via</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5960316871457624">
                           <xhtml:span class="inline_block">/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f netsec.options.tcpwrapper,netsec.options.idprotocol -c -N -g -X -G -Y</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: If the software is not located in <xhtml:span class="inline_block">
                                 <xhtml:span>/tmp</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>, reflect the actual location in the command above.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.10.2_TCP_Wrappers_-_creating_a_hosts.deny_file" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP Wrappers - creating a hosts.deny file</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Once TCP Wrappers are installed a <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.deny</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file should be created and be configured. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.deny</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file describes the names of the hosts which are not allowed to access the local <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>services, as decided by the <xhtml:span class="inline_block">
                        <xhtml:span>/usr/sbin/tcpd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> server. All access should be denied by default unless explicitly authorized. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>Access is granted when a (daemon,client) pair matches an entry in the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file. Access is denied when a (daemon,client) pair matches an entry in the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.deny </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file. However, access is granted if matching entry does not exist in both the files. </xhtml:span>
                  <xhtml:span>This is why, by default, all access must be denied. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Create a <xhtml:span class="inline_block">
                              <xhtml:span>/etc/hosts.deny</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7669266502613892">
                           <xhtml:span class="inline_block">touch /etc/hosts.deny<xhtml:br/>chown root:system /etc/hosts.deny<xhtml:br/>chmod u=rw,go= /etc/hosts.deny</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Deny all traffic by default, explicit access will be defined in the <xhtml:span class="inline_block">
                                 <xhtml:span>/etc/hosts.allow </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>file:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5752872323915227">
                           <xhtml:span class="inline_block">vi /etc/hosts.deny</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Add:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5786870703132538">
                           <xhtml:span class="inline_block">ALL: ALL</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="If '/etc/hosts.deny' exists ensure that 'ALL: ALL' has been added" success="pass">
                        <ecl:command>[[ ! -f /etc/hosts.deny ]] &amp;&amp; RC=0 || grep '^ALL:[ ]ALL' /etc/hosts.deny</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/hosts.deny' exists">
                           <ecl:command>if [ ! -e "/etc/hosts.deny" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/hosts.deny against the provided permissions (0177).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/hosts.deny' are 'u-x,go-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/hosts.deny 0177</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/hosts.deny' exists">
                           <ecl:command>if [ ! -e "/etc/hosts.deny" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/hosts.deny
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/etc/hosts.deny' is 'root:system'">
                           <ecl:command>ls -l /etc/hosts.deny | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.10.3_TCP_Wrappers_-_creating_a_hosts.allow_file" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">TCP Wrappers - creating a hosts.allow file</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Once TCP Wrappers are installed a <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.allow</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file should be created and be configured. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This file describes the names of the hosts which are allowed to access the local <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>services as decided by the <xhtml:span class="inline_block">
                        <xhtml:span>/usr/sbin/tcpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>server. Access is granted when a (daemon,client) pair matches an entry in the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file. Access is denied when a (daemon,client) pair matches an entry in the <xhtml:span class="inline_block">
                        <xhtml:span>/etc/hosts.deny </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file. However, access is granted if matching entry does not exist in both the files. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Create a <xhtml:span class="inline_block">
                              <xhtml:span>/etc/hosts.allow</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.11277577344149098">
                           <xhtml:span class="inline_block">touch /etc/hosts.allow<xhtml:br/>chown root:system /etc/hosts.allow<xhtml:br/>chmod u=rw,go= /etc/hosts.allow</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Define explicit access to the local <xhtml:span class="inline_block">
                                 <xhtml:span>inetd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>services</xhtml:span>
                           <xhtml:span>:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4189876423474299">
                           <xhtml:span class="inline_block">vi /etc/hosts.allow</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>An example configuration:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.19480531213707197">
                           <xhtml:span class="inline_block">ALL: LOCAL @some_netgroup<xhtml:br/>ALL: .foobar.edu EXCEPT terminalserver.foobar.edu</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/hosts.allow' exists">
                           <ecl:command>if [ ! -e "/etc/hosts.allow" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/hosts.allow against the provided permissions (0177).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/hosts.allow' are 'u-x,go-wx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/hosts.allow 0177</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/hosts.allow' exists">
                           <ecl:command>if [ ! -e "/etc/hosts.allow" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/hosts.allow
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/etc/hosts.allow' is 'root:system'">
                           <ecl:command>ls -l /etc/hosts.allow | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.10.4_TCP_Wrappers_-_wrapping_inetd_services" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">TCP Wrappers - wrapping inetd services</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>If TCP Wrappers have been installed because there are active <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>services, these services must utilize TCP Wrappers to restrict host access. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>By limiting access to the server, you reduce your exposure to threats from attackers on remote systems<xhtml:span>. Therefore any active <xhtml:span class="inline_block">
                        <xhtml:span>inetd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>controlled service which cannot be disabled should be restricted so that it can only be used by trusted hosts.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Prior to implementing this recommendation it is important that <xhtml:span class="inline_block">
                              <xhtml:span>hosts.deny </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and <xhtml:span class="inline_block">
                              <xhtml:span>hosts.allow</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> files have been created.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>For each active TCP and UDP <xhtml:span class="inline_block">
                              <xhtml:span>inetd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>service, change the entry in <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, so that <xhtml:span class="inline_block">
                              <xhtml:span>tcpd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>is executed. <xhtml:br/>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Copy the current <xhtml:span class="inline_block">
                              <xhtml:span>/etc/inetd.conf</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file for reversion purposes:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8315375047490718">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>cp -p /etc/inetd.conf /etc/inetd.conf.pre_tcp_wrappers</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>For example, to utilize TCP Wrappers on the </xhtml:span>
                           <xhtml:span>telnet service:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Edit:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.37803400742549237">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>vi /etc/inetd.conf</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Change</xhtml:span>
                           <xhtml:span>:</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6983860415049975">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>telnet stream tcp6 nowait root /usr/sbin/telnetd telnetd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>To:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.06055151922334856">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>telnet stream tcp nowait root /usr/sbin/tcpd telnetd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Repeat the change for other services. </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.11_Permissions_and_Ownership">
         <xccdf:title xml:lang="en">Permissions and Ownership</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>This section will of the benchmark will focus on locking down access to specific key configuration files, log files and directories. If these critical files and directories have incorrect ownership and permissions, they can provide an attacker with a method of attack, or with pertinent system information. </xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>Some of the files and directories changed in this section may not exist on your system. In this instance the recommendation can be ignored. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.1_Permissions_and_Ownership_-_etcsecurity" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /etc/security</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> directory contains the user and group configuration files and the encrypted passwords. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> directory </xhtml:span>
                  <xhtml:span>contains sensitive files such as <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security/passwd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security/group</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. It must be secured from unauthorized access and modifications.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove world read, write and execute access and group write access from <xhtml:span class="inline_block">
                              <xhtml:span>/etc/security</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7428700626753127">
                           <xhtml:span class="inline_block">chown -R root:security /etc/security<xhtml:br/>chmod u=rwx,g=rx,o= /etc/security<xhtml:br/>chmod -R go-w,o-rx /etc/security</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/security' exists">
                           <ecl:command>if [ ! -e "/etc/security" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/security against the provided permissions (027).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/security' are 'g-w,o-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/security 027</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/security' exists">
                           <ecl:command>if [ ! -e "/etc/security" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -ld on /etc/security
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:security
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/etc/security' is owned by 'root:security'">
                           <ecl:command>ls -ld /etc/security | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:security"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.2_Permissions_and_Ownership_-_etcgroup" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /etc/group</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/group </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file contains a list of the groups defined within the system. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/group</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file</xhtml:span>
                  <xhtml:span> defines basic group attributes. Since the file contains sensitive information, it must be properly secured. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Ensure correct ownership and permissions are in place for <xhtml:span class="inline_block">
                              <xhtml:span>/etc/group</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6338021846909649">
                           <xhtml:span class="inline_block">chown root:security /etc/group<xhtml:br/>chmod u=rw,go=r /etc/group</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/group' exists">
                           <ecl:command>if [ ! -e "/etc/group" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/group against the provided permissions (0133).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/group' are 'u-x,g-wx,o-wx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/group 0133</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/group' exists">
                           <ecl:command>if [ ! -e "/etc/group" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/group
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:security
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/etc/group' is owned by 'root:security'">
                           <ecl:command>ls -l /etc/group | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:security"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.3_Permissions_and_Ownership_-_etcpasswd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /etc/passwd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/passwd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file contains a list of the users defined within the system. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/passwd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file</xhtml:span>
                  <xhtml:span> defines all users within the system. Since the file contains sensitive information, it must be properly secured. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Ensure correct ownership and permissions are in place for <xhtml:span class="inline_block">
                              <xhtml:span>/etc/passwd</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7657637242897253">
                           <xhtml:span class="inline_block">chown root:security /etc/passwd<xhtml:br/>chmod u=rw,go=r /etc/passwd</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/passwd' exists">
                           <ecl:command>if [ ! -e "/etc/passwd" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/passwd against the provided permissions (0133).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/passwd/ are 'u-x,g-wx,o-wx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/passwd 0133</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/passwd' exists">
                           <ecl:command>if [ ! -e "/etc/passwd" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/passwd
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:security
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/etc/passwd' is owned by 'root:security'">
                           <ecl:command>ls -l /etc/passwd | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:security"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.4_Permissions_and_Ownership_-_etcsecurityaudit" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /etc/security/audit</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security/audit</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> directory contains the system audit configuration files. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/security/audit</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> directory </xhtml:span>
                  <xhtml:span>stores the a</xhtml:span>
                  <xhtml:span>udit configuration files. This directory must have adequate access controls to prevent unauthorized access. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Ensure correct ownership and permissions are in place for <xhtml:span class="inline_block">
                              <xhtml:span>/etc/security/audit</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.0505757436819832">
                           <xhtml:span class="inline_block">chown -R root:audit /etc/security/audit<xhtml:br/>chmod u=rwx,g=rx,o= /etc/security/audit<xhtml:br/>chmod -R u=rw,g=r,o= /etc/security/audit/*</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/security/audit' exists">
                           <ecl:command>if [ ! -e "/etc/security/audit" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/security/audit against the provided permissions (0027).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/security/audit' are 'g-w,o-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/security/audit 0027</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/security/audit' exists">
                           <ecl:command>if [ ! -e "/etc/security/audit" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -ld on /etc/security/audit
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:audit
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/etc/security/audit' is owned by 'root:audit'">
                           <ecl:command>ls -ld /etc/security/audit | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:audit"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.5_Permissions_and_Ownership_-_audit" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /audit</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/audit</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> directory holds the output produced from the audit subsystem. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/audit</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> directory </xhtml:span>
                  <xhtml:span>stores the a</xhtml:span>
                  <xhtml:span>udit output files. This directory must have adequate access controls to prevent unauthorized access.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Ensure correct ownership and permissions are in place for <xhtml:span class="inline_block">
                              <xhtml:span>/audit</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9222835673250044">
                           <xhtml:span class="inline_block">chown root:audit /audit<xhtml:br/>chmod u=rwx,g=rx,o= /audit<xhtml:br/>chmod -R u=rw,g=r,o= /audit/*</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/audit' exists">
                           <ecl:command>if [ ! -e "/audit" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /audit against the provided permissions (0027).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/audit' are 'g-w,o-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /audit 0027</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/audit' exists">
                           <ecl:command>if [ ! -e "/audit" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -ld on /audit
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:audit
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/audit' is owned by 'root:audit'">
                           <ecl:command>ls -ld /audit | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:audit"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.6_Permissions_and_Ownership_-_smit.log" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /smit.log</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/smit.log</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file maintains a history of all </xhtml:span>
                  <xhtml:span>smit</xhtml:span>
                  <xhtml:span> commands run as </xhtml:span>
                  <xhtml:span>root</xhtml:span>
                  <xhtml:span>. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/smit.log</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> </xhtml:span>
                  <xhtml:span>file may contain </xhtml:span>
                  <xhtml:span>sensitive information regarding system configuration, which may be of interest to an attacker. This log file must be secured from unauthorized access and modifications.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove world read and write access to <xhtml:span class="inline_block">
                              <xhtml:span>/smit.log</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.1903368060673089">
                           <xhtml:span class="inline_block">chmod o-rw /smit.log</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/smit.log' exists">
                           <ecl:command>if [ ! -e "/smit.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /smit.log against the provided permissions (0133).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/smit.log' are 'u-x,g-wx,o-wx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /smit.log 0133</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/smit.log' exists">
                           <ecl:command>if [ ! -e "/smit.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /smit.log
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/smit.log' is owned by 'root:system'">
                           <ecl:command>ls -l /smit.log | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.7_Permissions_and_Ownership_-_varadmcronlog" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/adm/cron/log</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/log</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file contains a log of all <xhtml:span class="inline_block">
                        <xhtml:span>cron </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>jobs run on the system. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/log</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>,</xhtml:span>
                  <xhtml:span> records all cron jobs run on the system. The file permissions must ensure that it is accessible only to its owner and group. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove world read and write access to <xhtml:span class="inline_block">
                              <xhtml:span>/var/adm/cron/log</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.12539888562807488">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span> chmod o-rw /var/adm/cron/log</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/adm/cron/log' exists">
                           <ecl:command>if [ ! -e "/var/adm/cron/log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/adm/cron/log against the provided permissions (007).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/var/adm/cron/log' are 'o-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/adm/cron/log 007</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/adm/cron/log' exists">
                           <ecl:command>if [ ! -e "/var/adm/cron/log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /var/adm/cron/log
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:cron
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/adm/cron/log' is owned by 'root:cron'">
                           <ecl:command>ls -l /var/adm/cron/log | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:cron"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.8_Permissions_and_Ownership_-_varspoolcroncrontabs" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/spool/cron/crontabs</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/spool/cron/crontabs </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>directory contains all of the <xhtml:span class="inline_block">
                        <xhtml:span>crontabs </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>for the users on the system. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/spool/cron/crontabs</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> directory contains all of the <xhtml:span class="inline_block">
                        <xhtml:span>crontabs </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>for the users on the system. </xhtml:span>
                  <xhtml:span>Crontab files present a security problem because they are run by the <xhtml:span class="inline_block">
                        <xhtml:span>cron </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon, which runs with super user rights. Allowing other users to have read/write permissions on these files may allow them to escalate their privileges. To negate this risk, the directory and all the files that it contains must be secured.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Apply the appropriate permissions to <xhtml:span class="inline_block">
                              <xhtml:span>/var/spool/cron/crontabs</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.054623767729715444">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chmod -R o= /var/spool/cron/crontabs </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chmod ug=rwx,o= /var/spool/cron/crontabs</xhtml:span>
                                 <xhtml:br/>chgrp -R cron /var/spool/cron/crontabs</xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/spool/cron/crontabs' exists">
                           <ecl:command>if [ ! -e "/var/spool/cron/crontabs" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/spool/cron/crontabs against the provided permissions (0007).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/var/spool/cron/crontabs' are 'o-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/spool/cron/crontabs 0007</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/spool/cron/crontabs' exists">
                           <ecl:command>if [ ! -e "/var/spool/cron/crontabs" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -ld on /var/spool/cron/crontabs
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:cron
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/spool/cron/crontabs' is owned by 'root:cron'">
                           <ecl:command>ls -ld /var/spool/cron/crontabs | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:cron"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.9_Permissions_and_Ownership_-_varadmcronat.allow" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/adm/cron/at.allow</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">/var/adm/cron/at.allow</xhtml:span> file contains a list of users who can schedule jobs via the <xhtml:span class="inline_block">at </xhtml:span>command.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">/var/adm/cron/at.allow</xhtml:span> file controls which users can schedule jobs via the <xhtml:span class="inline_block">at </xhtml:span>command. Only the root user should have permissions to create, edit, or delete this file.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Apply the appropriate permissions to <xhtml:span class="inline_block">/var/adm/cron/at.allow</xhtml:span>:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9591755838595064">
                           <xhtml:span class="inline_block">chown root:sys /var/adm/cron/at.allow<xhtml:br/>chmod u=r,go= /var/adm/cron/at.allow</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/adm/cron/at.allow' exists">
                           <ecl:command>if [ ! -e "/var/adm/cron/at.allow" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/adm/cron/at.allow against the provided permissions (0077).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/var/adm/cron/at.allow' are 'go-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/adm/cron/at.allow 0077</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/adm/cron/at.allow' exists">
                           <ecl:command>if [ ! -e "/var/adm/cron/at.allow" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /var/adm/cron/at.allow
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:sys
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/adm/cron/at.allow' is owned by 'root:sys'">
                           <ecl:command>ls -l /var/adm/cron/at.allow | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:sys"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.10_Permissions_and_Ownership_-_varadmcroncron.allow" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/adm/cron/cron.allow</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/cron.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file contains a list of users who can schedule jobs via the <xhtml:span class="inline_block">
                        <xhtml:span>cron </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>command. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/cron.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file controls which users can schedule jobs via <xhtml:span class="inline_block">
                        <xhtml:span>cron</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. Only the root user should have permissions to create, edit, or delete this file.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Apply the appropriate permissions to <xhtml:span class="inline_block">
                              <xhtml:span>/var/adm/cron/cron.allow</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6875251350099902">
                           <xhtml:span class="inline_block">chown root:sys /var/adm/cron/cron.allow<xhtml:br/>chmod u=r,go= /var/adm/cron/cron.allow</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/adm/cron/cron.allow' exists">
                           <ecl:command>if [ ! -e "/var/adm/cron/cron.allow" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/adm/cron/cron.allow against the provided permissions (0077).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/var/adm/cron/cron.allow' are 'og-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/adm/cron/cron.allow 0077</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/adm/cron/cron.allow' exists">
                           <ecl:command>if [ ! -e "/var/adm/cron/cron.allow" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /var/adm/cron/cron.allow
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:sys
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/adm/cron/cron.allow' is owned by 'root:sys'">
                           <ecl:command>ls -l /var/adm/cron/cron.allow | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:sys"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.11_Permissions_and_Ownership_-_etcmotd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /etc/motd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/motd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file contains the message of the day, shown after successful initial login. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/motd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file contains the message of the day, shown after successful initial login. The file should only be editable by its owner. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Apply the appropriate permissions to <xhtml:span class="inline_block">
                              <xhtml:span>/etc/motd</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5257368948118244">
                           <xhtml:span class="inline_block">chown bin:bin /etc/motd<xhtml:br/>chmod u=rw,go=r /etc/motd</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/motd' exists">
                           <ecl:command>if [ ! -e "/etc/motd" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/motd against the provided permissions (0133).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/motd' are 'u-x,g-wx,o-wx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/motd 0133</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/motd' exists">
                           <ecl:command>if [ ! -e "/etc/motd" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/motd
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals bin:bin
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/etc/motd' is owned by 'bin:bin'">
                           <ecl:command>ls -l /etc/motd | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="bin:bin"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.12_Permissions_and_Ownership_-_varadmras" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/adm/ras</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/ras </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>directory contains log files which contain sensitive information such as login times and IP addresses. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The log files in the <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/ras </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>directory can contain sensitive information such as login times and IP addresses, which may be altered by an attacker when removing traces of system access. All files in this directory must be secured from unauthorized access and modifications. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove world read and write access from all files in <xhtml:span class="inline_block">
                              <xhtml:span>/var/adm/ras</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.3741594533726367">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>chmod o-rw /var/adm/ras/*</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure permissions of the files in  '/var/adm/ras' are 'o-rw'">
                     <ecl:command>ls -l /var/adm/ras |awk '{print $1 , $9}' |egrep '^.......r..|^........w.'</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.13_Permissions_and_Ownership_-_varctRMstart.log" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/ct/RMstart.log</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/ct/RMstart.log </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is the logfile used by RMC and can contain sensitive data that must be secured.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>RMC provides a single monitoring and management infrastructure for both RSCT peer domains and management domains. Its generalized framework is used by cluster management tools to monitor, query, modify, and control cluster resources, <xhtml:span class="inline_block">
                        <xhtml:span>/var/ct/RMstart.log </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is the logfile used by RMC and can contain sensitive data that must be secured. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove world read and write from <xhtml:span class="inline_block">
                              <xhtml:span>/var/ct/RMstart.log</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.28147574284636545">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>chmod o-rw /var/ct/RMstart.log</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/ct/RMstart.log' exists">
                           <ecl:command>if [ ! -e "/var/ct/RMstart.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/ct/RMstart.log against the provided permissions (0006).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permission on '/var/ct/RMstart.log' are 'o-rw'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/ct/RMstart.log 0006</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/ct/RMstart.log' exists">
                           <ecl:command>if [ ! -e "/var/ct/RMstart.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /var/ct/RMstart.log
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/ct/RMstart.log' is owned by 'root:system'">
                           <ecl:command>ls -l /var/ct/RMstart.log | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.14_Permissions_and_Ownership_-_vartmpdpid2.log" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/tmp/dpid2.log</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/tmp/dpid2.log </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is the logfile used by <xhtml:span class="inline_block">
                        <xhtml:span>dpid2 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon, and contains SNMP information.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/tmp/dpid2.log</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> logfile is used by the</xhtml:span>
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>dpid2 </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon and can contain sensitive SNMP information. This file must be secured from unauthorized access and modifications. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Rem</xhtml:span>
                        <xhtml:span>ove world read and write from <xhtml:span class="inline_block">
                              <xhtml:span>/var/tmp/dpid2.log</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.7660099886284943">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>chmod o-rw /var/tmp/dpid2.log</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/tmp/dpid2.log' exists">
                           <ecl:command>if [ ! -e "/var/tmp/dpid2.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/tmp/dpid2.log against the provided permissions (0006).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/var/tmp/dpid2.log' are 'o-rw'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/tmp/dpid2.log 0006</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/tmp/dpid2.log' exists">
                           <ecl:command>if [ ! -e "/var/tmp/dpid2.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /var/tmp/dpid2.log
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/tmp/dpid2.log' is owned by 'root:system'">
                           <ecl:command>ls -l /var/tmp/dpid2.log | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.15_Permissions_and_Ownership_-_vartmphostmibd.log" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/tmp/hostmibd.log</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/tmp/hostmibd.log </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is the logfile used by <xhtml:span class="inline_block">
                        <xhtml:span>hostmibd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon, and contains network and machine related information.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/tmp/hostmibd.log </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>log file </xhtml:span>
                  <xhtml:span>can contain network and machine related statistics logged by the daemon. This file must be secured from unauthorized access and modifications.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Remove world read and write from <xhtml:span class="inline_block">/var/tmp/hostmibd.log</xhtml:span>:</xhtml:p>
                     <xhtml:code class="pre_0.35925262094867877">
                        <xhtml:span class="inline_block">chmod o-rw /var/tmp/hostmibd.log </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/tmp/hostmibd.log' exists">
                           <ecl:command>if [ ! -e "/var/tmp/hostmibd.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/tmp/hostmibd.log against the provided permissions (0006).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on'/var/tmp/hostmibd.log' are 'o-rw'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/tmp/hostmibd.log 0006</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/tmp/hostmibd.log' exists">
                           <ecl:command>if [ ! -e "/var/tmp/hostmibd.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /var/tmp/hostmibd.log
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/tmp/hostmibd.log' is owned by 'root:system'">
                           <ecl:command>ls -l /var/tmp/hostmibd.log | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.16_Permissions_and_Ownership_-_vartmpsnmpd.log" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/tmp/snmpd.log</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/tmp/snmpd.log </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is the logfile used by <xhtml:span class="inline_block">
                        <xhtml:span>snmpd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon, and contains network and machine related information.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/tmp/snmpd.log </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>logfile </xhtml:span>
                  <xhtml:span>contains sensitive information through which an attacker can find out about the SNMP deployment architecture in your network. This log file must be secured from unauthorized access.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove world read and write from <xhtml:span class="inline_block">
                              <xhtml:span>/var/tmp/snmpd.log:</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.22651755650868277">
                           <xhtml:span class="inline_block">chmod o-rw <xhtml:span>/var/tmp/snmpd.log</xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/tmp/snmpd.log' exists">
                           <ecl:command>if [ ! -e "/var/tmp/snmpd.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/tmp/snmpd.log against the provided permissions (0006).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/var/tmp/snmpd.log' are 'o-rw'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/tmp/snmpd.log 0006</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/tmp/snmpd.log' exists">
                           <ecl:command>if [ ! -e "/var/tmp/snmpd.log" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /var/tmp/snmpd.log
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals root:system
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/tmp/snmpd.log' is owned by 'root:system'">
                           <ecl:command>ls -l /var/tmp/snmpd.log | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="root:system"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.17_Permissions_and_Ownership_-_varadmsa" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - /var/adm/sa</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/sa </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>directory holds the performance data produced by the <xhtml:span class="inline_block">
                        <xhtml:span>sar </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>utility.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/sa </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>directory </xhtml:span>
                  <xhtml:span>contains the report files produced by the <xhtml:span class="inline_block">
                        <xhtml:span>sar </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>utility. This directory must be secured from unauthorized access.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Set the recommended ownership and permissions on <xhtml:span class="inline_block">
                              <xhtml:span>/var/adm/sa</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.18316702348341457">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chown adm:adm /var/adm/sa </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chmod u=rwx,go=rx /var/adm/sa</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/adm/sa' exists">
                           <ecl:command>if [ ! -e "/var/adm/sa" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /var/adm/sa against the provided permissions (0022).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permission on '/var/adm/sa' are 'g-w,o-rwx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /var/adm/sa 0022</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/var/adm/sa' exists">
                           <ecl:command>if [ ! -e "/var/adm/sa" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -ld on /var/adm/sa
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals adm:adm
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure '/var/adm/sa' is owned by 'adm:adm'">
                           <ecl:command>ls -ld /var/adm/sa | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="adm:adm"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.18_Permissions_and_Ownership_-_home_directory_configuration_files" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - home directory configuration files</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The user configuration files in each home directory e.g. <xhtml:span class="inline_block">
                        <xhtml:span>$HOME/.profile</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>, must not be group or world writable.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Group or world-writable user configuration files may enable malicious users to steal or modify other user's data, or to gain elevated privileges.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Search and remediate any user configuration files which have group or world writable access:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6394093192447281">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lsuser -a home ALL |cut -f2 -d= | while read HOMEDIR; do</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>echo "Examining $HOMEDIR"</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>if [ -d $HOMEDIR ]; then</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>ls -a $HOMEDIR | grep -Ev "^.$|^..$" | \</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>while read FILE; do</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>if [ -f $FILE ]; then</xhtml:span>
                                 <xhtml:br/>ls -l $FILE<xhtml:br/>chmod go-w $FILE<xhtml:br/>
                                 <xhtml:span>fi</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>done</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>else</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>echo "No home dir for $HOMEDIR"</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>fi</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>done</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: The permission change is automatically applied</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                        <xhtml:span>
                           <xhtml:span style="font-family: Cambria; color: #000000; font-size: medium;"> </xhtml:span>
                        </xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure all user configuration files are not group or world writable">
                     <ecl:command>lsuser -a home ALL | cut -f 2 -d = |sort -u | while read HOME; do [[ -d ${HOME} ]] &amp;&amp; ls -l ${HOME} |egrep '^-....w....|^-.......w.'; done</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.19_Permissions_and_Ownership_-_home_directory_permissions" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - home directory permissions</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>All user home directories must not have group write or world writable access. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Group or world-writable user home directories may enable malicious users to steal or modify data, or to gain other user's system privileges. Disabling read and execute </xhtml:span>
                  <xhtml:span>access for users, who are not members of the same group, allows for appropriate use of discretionary access control by each user.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Change any home directories which have group or world writable access:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.1385817690214744">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>NEW_PERMS=750 </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>lsuser -c ALL | grep -v ^#name | cut -f1 -d: | while read NAME; do </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -ge 200 ]; then </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>HOME=`lsuser -a home $NAME | cut -f 2 -d =` </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>echo "Changing $NAME homedir $HOME" </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chmod $NEW_PERMS $HOME </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>fi </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>done</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: The permission change is automatically applied to all user directories with a user ID over 200.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Modify <xhtml:span class="inline_block">
                              <xhtml:span>/usr/lib/security/mkuser.sys</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> to ensure that all new user home directories will be created with a default permission of 750:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.18717484827708913">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>vi /usr/lib/security/mkuser.sys</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Replace:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.49478790111730236">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>mkdir $1</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>With:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.2893195772990727">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span> </xhtml:span>
                                 <xhtml:span>mkdir $1 &amp;&amp; chmod u=rwx,g=rx,g= $1</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that all users home directories with a 'uid' greater than 200 are 'go-w'">
                     <ecl:command>lsuser -c ALL | grep -v ^#name | cut -f1 -d: | while read NAME; do [[ $(lsuser -f ${NAME} |grep id |cut -f2 -d=) -ge 200 ]] &amp;&amp; HOME=$(lsuser -a home ${NAME} | cut -f 2 -d =) &amp;&amp; [[ -d ${HOME} ]] &amp;&amp; ls -ld ${HOME} |egrep '^d....w....|^d.......w.'; done </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11.20_Permissions_and_Ownership_-_worldgroup_writable_directory_in_root_PATH" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Permissions and Ownership - world/group writable directory in root PATH</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>To secure the root users executable PATH, all directories must not be group and world writable. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>There</xhtml:span>
                  <xhtml:span> should not be group or world writable directories </xhtml:span>
                  <xhtml:span>in the root user's executable path. This may allow an attacker to gain super user access by forcing an administrator operating as root to execute a Trojan horse program. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Search and report on group or world writable directories in root's PATH. The command must be run as the root user. The script below traverses up each individual directory PATH, ensuring that all directories are not group/world writable and that they are owned by root or the bin user: </xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.009802284634500335">
                           <xhtml:span class="inline_block">echo "/:${PATH}" | tr ':' '\n' | grep "^/" | sort -u | while read DIR<xhtml:br/>do<xhtml:br/>DIR=${DIR:-$(pwd)}<xhtml:br/>print "Checking ${DIR}"<xhtml:br/>while [[ -d ${DIR} ]]<xhtml:br/>do<xhtml:br/>[[ "$(ls -ld ${DIR})" = @(d???????w? *) ]] &amp;&amp; print " WARNING ${DIR} is world wr<xhtml:br/>itable" || print " ${DIR} is not world writable"<xhtml:br/>[[ "$(ls -ld ${DIR})" = @(d????w???? *) ]] &amp;&amp; print " WARNING ${DIR} is group wr<xhtml:br/>itable" || print " ${DIR} is not group writable" <xhtml:br/>[[ "$(ls -ld ${DIR} |awk '{print $3}')" != @(root|bin) ]] &amp;&amp; print " WARNING ${D<xhtml:br/>IR} is not owned by root or bin"<xhtml:br/>DIR=${DIR%/*}<xhtml:br/>done<xhtml:br/>done</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Review the output and manually change the directories, if possible. Directories which are group and/or world writable are marked with "WARNING"</xhtml:span>
                        </xhtml:p>
                        <xhtml:p>
                           <xhtml:span>To manually change permissions on the directories:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>To remove group writable access:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6920640708959649">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chmod g-w &lt;dir name&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>To remove world writable access:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:code class="pre_0.9733625854198518">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span> </xhtml:span>
                              <xhtml:span>chmod o-w &lt;dir name&gt;</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                        <xhtml:span>To remove both group and world writable access:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.6194213175694587">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span> </xhtml:span>
                              <xhtml:span>chmod go-w &lt;dir name&gt;</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                        <xhtml:span>To change the owner of a directory:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.47999647885727303">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span> </xhtml:span>
                              <xhtml:span>chown &lt;owner&gt; &lt;dir name&gt;</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                        <xhtml:span>To fully automate the PATH directory permission changes execute the following code as the<xhtml:span class="inline_block"> root </xhtml:span>user:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8622688208669871">
                           <xhtml:span class="inline_block">
                              <xhtml:span class="inline_block">echo "/:${PATH}" | tr ':' '\n' | grep "^/" | sort -u</xhtml:span> | while read DIR<xhtml:br/>do<xhtml:br/>DIR=${DIR:-$(pwd)}<xhtml:br/>while [[ -d ${DIR} ]]<xhtml:br/>do<xhtml:br/>[[ "$(ls -ld ${DIR})" = @(d???????w? *) ]] &amp;&amp; chmod o-w ${DIR} &amp;&amp; print "Removin<xhtml:br/>g world write from ${DIR}"<xhtml:br/>[[ "$(ls -ld ${DIR})" = @(d????w???? *) ]] &amp;&amp; chmod g-w ${DIR} &amp;&amp; print "Removin<xhtml:br/>g group write from ${DIR}"<xhtml:br/>DIR=${DIR%/*}<xhtml:br/>done<xhtml:br/>done</xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure there are no group or world writable directories in root's PATH">
                     <ecl:command>echo "/:${PATH}" | tr ':' '\n' | grep "^/" | sort -u | while read DIR ; do DIR=${DIR:-$(pwd)} ; while [[ -d ${DIR} ]]; do [[ "$(ls -ld ${DIR})" = @(d???????w? *) ]] &amp;&amp; print " WARNING ${DIR} is world writable"; [[ "$(ls -ld ${DIR})" = @(d????w???? *) ]] &amp;&amp; print " WARNING ${DIR} is group writable"; [[ "$(ls -ld ${DIR} |awk '{print $3}')" != @(root|bin) ]] &amp;&amp; print " WARNING ${DIR} is not owned by root or bin"; DIR=${DIR%/*}; done; done</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.12_Miscellaneous_Configuration_Changes">
         <xccdf:title xml:lang="en">Miscellaneous Configuration Changes</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
               <xhtml:span>This section of the benchmark will focus on miscellaneous configuration changes. These are general changes which do not warrant a dedicated section.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.1_Miscellaneous_Config_-_serial_port_restriction" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - serial port restriction</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to disable the login capability of all connected <xhtml:span class="inline_block">
                        <xhtml:span>tty </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>devices</xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>It is recommended that the login capability for all serial ports is disabled, so that unauthorized users cannot attach modems or remote access devices to these ports and bypass any network access control.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>If the environment utilizes <xhtml:span class="inline_block">
                        <xhtml:span>tty </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>devices to facilitate user connections. This recommendation may be ignored.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Create a list of active <xhtml:span class="inline_block">
                              <xhtml:span>tty </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>ports:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5541988466562506">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lsitab -a |egrep </xhtml:span>"respawn<xhtml:span>:/usr/sbin/getty|on:/usr/sbin/getty</xhtml:span>"</xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If any <xhtml:span class="inline_block">
                                 <xhtml:span>tty </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>devices are returned from the previous output, lock down each any unrequired devices via:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.19101846977771791">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chitab </xhtml:span>"<xhtml:span>tty2:2:off:/usr/sbin/getty /dev/tty2</xhtml:span>"</xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Replace <xhtml:span class="inline_block">
                                 <xhtml:span>tty2 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>with the relevant port</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure uneccessary 'tty' devices are disable in '/etc/inittab'">
                     <ecl:command>lsitab -a |egrep "respawn:/usr/sbin/getty|on:/usr/sbin/getty" |egrep -v "^cons:|^lft0"</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.2_Miscellaneous_Config_-_disable_i4ls" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - disable i4ls</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The recommendation is to disable the <xhtml:span class="inline_block">
                        <xhtml:span>i4ls </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>license manager. This is typically used for C and Cobol license management. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>It is recommended that the <xhtml:span class="inline_block">
                        <xhtml:span>i4ls </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>license manager is disabled. </xhtml:span>
                  <xhtml:span>The license manager is needed for C and Cobol compilers etc. If the environment supports NCS and a license server is required, a node locked license server should be used instead.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Identify if <xhtml:span class="inline_block">
                              <xhtml:span>i4ls </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>is enabled:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.620174521737129">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lsitab i4ls</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>If the command above yields output, remove via:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.33230111711723975">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>rmitab i4ls</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab i4ls'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'i4ls' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab i4ls</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.3_Miscellaneous_Config_-_disable_NCS" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - disable NCS</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to disable Network Computing System (NCS). It provide tools for designing, implementing, and supporting applications requiring distributed data and distributed computing.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>NCS is an implementation of the Network Computing Architecture developed to provide tools for designing, implementing, and supporting applications requiring distributed data and distributed computing. It is recommended that NCS is disabled, unless it is required within the environment. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Identify if NCS is enabled:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8064091197769192">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lsitab -a |grep </xhtml:span>"<xhtml:span>/etc/rc.ncs</xhtml:span>" <xhtml:span>| cut -f1 -d:</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If the command above yields output, remove via:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.014104473160889086">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>rmitab rcncs</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: If the output from the <xhtml:span class="inline_block">
                                 <xhtml:span>lsitab </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>command was not <xhtml:span class="inline_block">
                                 <xhtml:span>rcncs</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>, substitute that above.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab rcncs'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'rcncs' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab rcncs</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.4_Miscellaneous_Config_-_disable_httpdlite" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - disable httpdlite</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to disable <xhtml:span class="inline_block">
                        <xhtml:span>httpdlite</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. </xhtml:span>
                  <xhtml:span>This is a web server which provides on-line documentation.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>httpdlite </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is the Lite NetQuestion Web server software for online documentation. It is recommended that this software is disabled, unless it is required in the environment.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>NOTE: The <xhtml:span class="inline_block">
                        <xhtml:span>man </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>command does not need this to work correctly.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Identify if <xhtml:span class="inline_block">
                              <xhtml:span>httpdlite </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>is enabled:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.16696683111714777">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lsitab </xhtml:span>
                                 <xhtml:span>httpdlite</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If the command above yields output, remove via:</xhtml:span>
                        </xhtml:p>
                        <xhtml:div>
                           <xhtml:code class="pre_0.5797073137979252">
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>rmitab </xhtml:span>
                                    <xhtml:span>httpdlite</xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:code>
                        </xhtml:div>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab httpdlite'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'httpdlite' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab httpdlite</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.5_Miscellaneous_Config_-_disable_pmd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - disable pmd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to disable <xhtml:span class="inline_block">
                        <xhtml:span>pmd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. This is the power management service that turns the machine off if it has been idle for a specific amount of time. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>pmd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> is the power management service that turns the machine off if it has been idle for a specific amount of time. This recommendation is to disable this service.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Identify if <xhtml:span class="inline_block">
                              <xhtml:span>pmd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>is enabled:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.048100827591777084">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lsitab </xhtml:span>
                                 <xhtml:span>pmd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If the command above yields output, remove via:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.3657904976755954">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>rmitab </xhtml:span>
                                 <xhtml:span>pmd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab pmd'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'pmd' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab pmd</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.6_Miscellaneous_Config_-_disable_writesrv" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - disable writesrv</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to disable <xhtml:span class="inline_block">
                        <xhtml:span>writesrv</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. This allows </xhtml:span>
                  <xhtml:span>users to chat using the system write facility on a terminal. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>writesrv </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>allows users to chat using the system write facility on a terminal. The recommendation is that this service must be disabled.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Identify if <xhtml:span class="inline_block">
                              <xhtml:span>writesrv </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>is enabled:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8708918258294411">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lsitab </xhtml:span>
                                 <xhtml:span>writesrv</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If the command above yields output, remove via:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.25312551683430323">
                           <xhtml:span>
                              <xhtml:span>
                                 <xhtml:span class="inline_block">
                                    <xhtml:span>
                                       <xhtml:span>rmitab </xhtml:span>
                                       <xhtml:span>writesrv</xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <!--
                                                           
                                    1. Execute 'lsitab writesrv'.
                                    2. STDOUT will be present if entry exists. STDOUT will be present if entry does not exist..
                                    
                                    Note: Evidence in out_raw                        
                                        
                                    -->
                  <ecl:shell-command check="none exist" comment="Ensure 'writesrv' is not enabled in '/etc/inittab'">
                     <ecl:command>lsitab writesrv</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.7_Miscellaneous_Config_-_block_talkwrite" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - block talk/write</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to block <xhtml:span class="inline_block">
                        <xhtml:span>talk </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and</xhtml:span>
                  <xhtml:span>
                     <xhtml:span class="inline_block">write</xhtml:span>.</xhtml:span>
                  <xhtml:span> This allows </xhtml:span>
                  <xhtml:span>connected users to chat within terminal sessions.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The recommendation is to block attempts to use the <xhtml:span class="inline_block">write </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>or <xhtml:span class="inline_block">talk </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>commands. This improves the security of the <xhtml:span class="inline_block">tty </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>device. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>However, there are two exceptions: </xhtml:span>
               </xhtml:p>
               <xhtml:ol>
                  <xhtml:li>
                     <xhtml:span>The super user can write to anyone</xhtml:span>
                  </xhtml:li>
                  <xhtml:li>
                     <xhtml:span>
                        <xhtml:span>If you are logged in as the same user who has turned the messages off, you can write to the super user</xhtml:span>
                     </xhtml:span>
                  </xhtml:li>
               </xhtml:ol>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Disable <xhtml:span class="inline_block">
                              <xhtml:span>talk </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and <xhtml:span class="inline_block">
                              <xhtml:span>write </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>for ALL shells:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9574523662430419">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>echo "mesg n" &gt;&gt; /etc/profile <xhtml:br/>
                                 </xhtml:span>
                                 <xhtml:span>echo "mesg n" &gt;&gt; /etc/csh.login </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Disable 'talk' and 'write' in '/etc/profile'">
                        <ecl:command>grep "mesg[[:blank:]]n" /etc/profile</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^\s*mesg\sn"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Disable 'talk' and 'write' in '/etc/csh.login'">
                        <ecl:command>grep "mesg[[:blank:]]n" /etc/csh.login</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="^\s*mesg\sn"/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.8_Miscellaneous_Config_-_enable_sar_accounting" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - enable sar accounting</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to enable <xhtml:span class="inline_block">
                        <xhtml:span>sar </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>performance accounting</xhtml:span>
                  <xhtml:span>. This will provide a normal performance baseline which will help identify unusual performance patterns, created through potential attacks via a password cracking program being executed or through a DoS attack etc.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>System accounting gathers periodic baseline system data, such as CPU utilization and disk I/O. Once a normal baseline for the system has been established, unauthorized activities, such as a password cracking being executed and activity outside of normal usage hours may be detected due to departure from the normal system performance baseline. It is recommended that the </xhtml:span>
                  <xhtml:span>collection script is run on an hourly basis, every day, to help to detect any anomalies. It is also important to generate and review the system activity report on a daily basis. </xhtml:span>
               </xhtml:p>
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>There may be 3<xhtml:sup>rd</xhtml:sup>
                  </xhtml:span>
                  <xhtml:span> party tools, or in-house written scripts in place which perform a similar function. In this instance this recommendation can be ignored. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Prior to configuring <xhtml:span class="inline_block">
                              <xhtml:span>sar </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>reporting, ensure that the <xhtml:span class="inline_block">
                              <xhtml:span>bos.acct </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>fileset is installed:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.26787391679908084">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lslpp -L bos.acct</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: The <xhtml:span class="inline_block">
                                 <xhtml:span>bos.acct </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>fileset should be listed, along with the currently installed version</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>If the software is not installed, install from the relevant AIX media pack:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.8147121232339962">
                        <xhtml:span class="inline_block">/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f bos.acct -c -N -g -X -G -Y</xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:span>NOTE: If the software is not located in <xhtml:span class="inline_block">
                              <xhtml:span>/tmp</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, reflect the actual location in the command above.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Edit the <xhtml:span class="inline_block">
                              <xhtml:span>adm </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>user </xhtml:span>
                        <xhtml:span>crontab</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5147621081532784">
                           <xhtml:span class="inline_block">vi /var/spool/cron/crontabs/adm</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: There are commented out example system activity report lines. Review and tailor to the needs of the environment:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.28685085703688884">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>#=================================================================</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span># SYSTEM ACTIVITY REPORTS</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span># 8am-5pm activity reports every 20 mins during weekdays.</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span># activity reports every an hour on Saturday and Sunday.</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span># 6pm-7am activity reports every an hour during weekdays.</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span># Daily summary prepared at 18:05.</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>#=================================================================</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>#0 8-17 * * 1-5 /usr/lib/sa/sa1 1200 3 &amp;</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>#0 * * * 0,6 /usr/lib/sa/sa1 &amp;</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>#0 18-7 * * 1-5 /usr/lib/sa/sa1 &amp;</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>#5 18 * * 1-5 /usr/lib/sa/sa2 -s 8:00 -e 18:01 -i 3600 -ubcwyaqvm &amp;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Change and uncomment the lines where appropriate. Refer to the <xhtml:span class="inline_block">
                                 <xhtml:span>sar </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>documentation for further guidance</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Create the reporting directory structure and apply the appropriate permissions:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8342952857434946">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>mkdir -p /var/adm/sa </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chown adm:adm /var/adm/sa </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chmod u=rwx,go=rx /var/adm/sa</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.9_Miscellaneous_Config_-_etcftpusers" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - /etc/ftpusers</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ftpusers </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is a configuration file used by <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>daemon. It contains a list of users who are not allowed to access the system via <xhtml:span class="inline_block">
                        <xhtml:span>ftp</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/ftpusers </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file </xhtml:span>
                  <xhtml:span>contains a list of users who are not allowed to access the system via <xhtml:span class="inline_block">
                        <xhtml:span>ftp</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. All users with a UID less than 200 should typically be added into the file.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>List all users with a UID less than 200 to the <xhtml:span class="inline_block">
                              <xhtml:span>/etc/ftpusers </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>file:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.45203918275232985">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d: | while read NAME; do </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -lt 200 ] &gt; /dev/null 2&gt;&amp;1; then </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>echo "Would add $NAME to /etc/ftpusers" </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>fi</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>done </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Review the list of users</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Add all relevant users with a UID of less that 200 to the <xhtml:span class="inline_block">
                              <xhtml:span>/etc/ftpusers</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.42057973524253955">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>lsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d: | while read NAME; do </xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -lt 200 ] &gt; /dev/null 2&gt;&amp;1; then </xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>echo $NAME &gt;&gt; /etc/ftpusers</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>fi</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>done </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.10_Miscellaneous_Config_-_ftp_umask" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - ftp umask</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="Default" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The umask of the</xhtml:span>
                  <xhtml:span>
                     <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service should be set to at least </xhtml:span>
                  <xhtml:span>027</xhtml:span>
                  <xhtml:span> in order to prevent the FTP daemon process from creating world-writable files by default. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The umask of the <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>service should be set to at least </xhtml:span>
                  <xhtml:span>027</xhtml:span>
                  <xhtml:span> in order to prevent the FTP daemon process from creating world-writable files by default. These files could then be transferred over the network which could result in compromise of the critical information. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Set the default umask of the <xhtml:span class="inline_block">
                              <xhtml:span>ftp </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>daemon:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4250448279370422">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>[[ $(grep -c "^ftp[[:blank:]]" /etc/inetd.conf) -gt 0 ]] &amp;&amp; chsubserver -c -v ftp -p tcp "ftpd -l -u077" &amp;&amp; refresh -s inetd || RC=0</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: The umask above restricts read/write permissions for both group and other</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command comment="Ensure that the 'ftp' service 'umask' is '027'" success="pass">
                     <ecl:command>[[ $(grep -c "^ftp[[:blank:]]" /etc/inetd.conf) -eq 0 ]] &amp;&amp; RC=0 || grep "/usr/sbin/ftpd[[:blank:]]ftpd[[:blank:]]-l[[:blank:]]-u077$" /etc/inetd.conf</ecl:command>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.11_Miscellaneous_Config_-_ftp_banner" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - ftp banner</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="Default" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Set an <xhtml:span class="inline_block">
                        <xhtml:span>ftp </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>login banner which displays the acceptable usage policy. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The </xhtml:span>
                  <xhtml:span>message in <xhtml:span class="inline_block">
                        <xhtml:span>banner.msg </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is displayed for FTP logins. Banners display necessary warnings to users trying to gain unauthorized access to the system and are required for legal purposes. The recommendation is to set the banner as:</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>"Authorized uses only. All activity will be monitored and reported". </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The content may be changed to reflect any corporate AUP.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Ensure that the <xhtml:span class="inline_block">
                              <xhtml:span>bos.msg.en_US.net.tcp.client </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>fileset is installed:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.14908051147844292">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lslpp -L "bos.msg.en_US.net.tcp.client"</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: If the fileset is not installed, install it from the AIX media or another software repository. The fileset should reflect the language used on the server.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Once installed set the <xhtml:span class="inline_block">
                              <xhtml:span>ftp </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>AUP banner:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9871642644787391">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>dspcat -g /usr/lib/nls/msg/en_US/ftpd.cat &gt; /tmp/ftpd.tmp </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>sed "s/\"\%s FTP server (\%s) ready.\"/\"\%s Authorized uses only. All activity may be monitored and reported\"/" /tmp/ftpd.tmp &gt; /tmp/ftpd.msg </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>gencat /usr/lib/nls/msg/en_US/ftpd.cat /tmp/ftpd.msg</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>rm /tmp/ftpd.tmp /tmp/ftpd.msg</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="at least one" comment="Ensure that the 'ftp' acceptable usage policy banner is configured">
                     <ecl:command>dspcat -g /usr/lib/nls/msg/en_US/ftpd.cat | grep "^9[[:blank:]]"</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="^9\s*&quot;%s[ ]Authorized[ ]uses[ ]only.[ ]All[ ]activity[ ]may[ ]be[ ]monitored[ ]and[ ]reported&quot;"/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.12_Miscellaneous_Config_-_etcmotd" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - /etc/motd</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>Create a <xhtml:span class="inline_block">
                        <xhtml:span>/etc/motd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file which displays, post initial logon, a statutory warning message.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="Default" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The creation of a <xhtml:span class="inline_block">
                        <xhtml:span>/etc/motd</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file which contains a statutory warning message could aid in the prosecution of offenders guilty of unauthorized system access. The <xhtml:span class="inline_block">
                        <xhtml:span>/etc/motd </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>is displayed after successful logins from the console, SSH and other system access protocols. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Create a <xhtml:span class="inline_block">
                              <xhtml:span>/etc/motd </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>file</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.06252662717399143">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>touch /etc/motd</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chmod u=rw,go=r /etc/motd</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chown bin:bin /etc/motd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                        <xhtml:p>
                           <xhtml:span>Below is a sample banner:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.32784611681656184">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>*************************************************************************** </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>NOTICE TO USERS </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>This computer system is the private property of its owner, whether individual, corporate or government. It is for authorized use only. Users (authorized or unauthorized) have no explicit or implicit expectation of privacy. Any or all uses of this system and all files on this system may be intercepted, monitored, recorded, copied, audited, inspected, and disclosed to your employer, to authorized site, government, and law enforcement personnel, as well as authorized officials of government agencies, both domestic and foreign. &lt;p&gt; By using this system, the user consents to such interception, monitoring,recording, copying, auditing, inspection, and disclosure at the discretion of such personnel or officials. Unauthorized or improper use of this system may result in civil and criminal penalties and administrative or disciplinary action, as appropriate. By continuing to &lt;p&gt; use this system you indicate your awareness of and consent to
                                    these terms and conditions of use. LOG OFF IMMEDIATELY if you do not agree to the conditions stated in this warning. ****************************************************************************</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:br/>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Replace #x201C;its owner#x201D; with the relevant company name</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/motd' exists">
                           <ecl:command>if [ ! -e "/etc/motd" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                               
                                        1. 'AND' the existing permissions on /etc/motd against the provided permissions (0133).
                                        2. If checking for existance of permissions, the output should equal the input. If checking for absense of permissions, the output should equal "0000".
                                        
                                        Note: Evidence in out_raw                        
                                            
                               -->
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/motd' are 'u-x,go-wx'">
                           <ecl:command>perl -e '$fp=sprintf"%04o",(stat shift)[2]&amp;07777;$ui=sprintf"%04d",shift;print$fp&amp;$ui;' /etc/motd 0133</ecl:command>
                           <ecl:line-selection op="pm" value="^(\d+)$">
                              <ecl:regex-group dt="xs:string" group="1" op="eq" value="0000"/>
                           </ecl:line-selection>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <ecl:shell-command check="at least one" comment="Determine if file '/etc/motd' exists">
                           <ecl:command>if [ ! -e "/etc/motd" ]; then echo File does not exist ; fi</ecl:command>
                           <ecl:line-selection op="pm" value="File does not exist"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
                  <xccdf:check system="http://cisecurity.org/check">
                     <xccdf:check-content>
                        <!--
                                                                       
                                                1. Run ls -l on /etc/motd
                                                2. Print the 3rd (user owner) and 4th (group owner) columns seperated by ":"
                                                3. Ensure the output equals bin:bin
                                                4. If not, fail.
                                                
                                                Note: Evidence in out_raw                        
                                                    
                                                -->
                        <ecl:shell-command check="all" comment="Ensure ownership of '/etc/motd' is 'bin:bin'">
                           <ecl:command>ls -l /etc/motd | awk '{ print $3 ":" $4 }'</ecl:command>
                           <ecl:line-selection dt="xs:string" op="eq" value="bin:bin"/>
                        </ecl:shell-command>
                     </xccdf:check-content>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command comment="Ensure there is content in '/etc/motd'" success="pass">
                        <ecl:command>[[ -s /etc/motd ]] &amp;&amp; RC=0</ecl:command>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.13_Miscellaneous_Config_-_authorized_users_in_at.allow_" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - authorized users in at.allow </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/at.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file </xhtml:span>
                  <xhtml:span>defines which users on the system are able to schedule jobs via <xhtml:span class="inline_block">
                        <xhtml:span>at</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/at.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file defines which users are able to schedule jobs via <xhtml:span class="inline_block">
                        <xhtml:span>at</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. Review the current </xhtml:span>
                  <xhtml:span>at</xhtml:span>
                  <xhtml:span> files and add any relevant users to the <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/at.allow</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span> file.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Review the current <xhtml:span class="inline_block">
                              <xhtml:span>at</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> files:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.009641542693518801">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>ls #x2013;l /var/spool/cron/atjobs</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>cat /var/spool/cron/atjobs/*</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Review the list of <xhtml:span class="inline_block">
                                 <xhtml:span>at </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>schedules</xhtml:span>
                           <xhtml:span> and r</xhtml:span>
                           <xhtml:span>emove any files which should not be there, or have no content</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Add the recommended system users to the <xhtml:span class="inline_block">
                              <xhtml:span>at.allow </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>list:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code>
                           <xhtml:span class="inline_block">echo "adm" &gt;&gt;/var/adm/cron/at.allow<xhtml:br/>echo "sys" &gt;&gt; /var/adm/cron/at.allow<xhtml:br/>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Add any other users who require permissions to use the <xhtml:span class="inline_block">
                                 <xhtml:span>at </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>scheduler:</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6453530738155317">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>echo &lt;user&gt; &gt;&gt; /var/adm/cron/at.allow </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Where &lt;user&gt; is the username </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure the 'sys' user has been added into '/var/adm/cron/at.allow'">
                        <ecl:command>grep "^sys$" /var/adm/cron/at.allow</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure the 'adm' user has been added into '/var/adm/cron/at.allow'">
                        <ecl:command>grep "^adm$" /var/adm/cron/at.allow</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.14_Miscellaneous_Config_-_authorized_users_in_cron.allow" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - authorized users in cron.allow</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/cron.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file </xhtml:span>
                  <xhtml:span>defines which users on the system are able to schedule jobs via <xhtml:span class="inline_block">
                        <xhtml:span>cron</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/cron.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file defines which users are able to schedule jobs via <xhtml:span class="inline_block">
                        <xhtml:span>cron</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. Review the current <xhtml:span class="inline_block">
                        <xhtml:span>cron </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>files and add any relevant users to the <xhtml:span class="inline_block">
                        <xhtml:span>/var/adm/cron/cron.allow </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>file.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Review the current <xhtml:span class="inline_block">
                              <xhtml:span>cron </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>files:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.014443776350309412">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>ls #x2013;l /var/spool/cron/crontabs</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>cat /var/spool/cron/crontabs/*</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Review the list of <xhtml:span class="inline_block">
                                 <xhtml:span>cron </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>schedules</xhtml:span>
                           <xhtml:span> and r</xhtml:span>
                           <xhtml:span>emove any files which should not be there, or have no content</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Add the recommended system users to the <xhtml:span class="inline_block">
                              <xhtml:span>cron.allow </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>list:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7476892672981525">
                           <xhtml:span class="inline_block">echo "sys" &gt;&gt; /var/adm/cron/cron.allow <xhtml:br/>echo "adm" &gt;&gt; /var/adm/cron/cron.allow<xhtml:br/>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>Add any other users who require permissions to use the <xhtml:span class="inline_block">
                                 <xhtml:span>cron </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>scheduler:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8392281634080776">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>echo &lt;user&gt; &gt;&gt; /var/adm/cron/cron.allow </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Where &lt;user&gt; is the username </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure the 'sys' user has been added into '/var/adm/cron/cron.allow'">
                        <ecl:command>grep "^sys$" /var/adm/cron/cron.allow</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="at least one" comment="Ensure the 'adm' user has been added into '/var/adm/cron/cron.allow'">
                        <ecl:command>grep "^adm$" /var/adm/cron/cron.allow</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.15_Miscellaneous_Config_-_all_unlocked_accounts_must_have_a_password_" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - all unlocked accounts must have a password </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>All unlocked accounts on the server must have a password</xhtml:span>
                  <xhtml:span>.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>An account password is a secret code word that must be entered to gain access to the account. If an account exists that has a blank password, multiple users may access the account without authentication and leave a weak audit trail. An attacker may gain unauthorized system access or perform malicious actions, which then cannot be attributed to any specific individual. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Check for empty passwords:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.27428784089850205">
                        <xhtml:span class="inline_block">pwdck -n ALL </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:br/>
                        <xhtml:span>If the command above yields output, set up a password on the account:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.7753749201832382">
                        <xhtml:span class="inline_block">passwd &lt;username&gt; </xhtml:span>
                     </xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that all local users have a password">
                     <ecl:command>pwdck -n ALL 2&gt;&amp;1 |tee</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.16_Miscellaneous_Config_-_all_user_id_must_be_unique_" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - all user id must be unique </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>All users should have a unique UID. In particular the </xhtml:span>
                  <xhtml:span>only user on the system to have a UID of 0 should be the root user.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The only user with a UID of 0 on the system must be the root user. </xhtml:span>
                  <xhtml:span>Any account with a UID of 0 has super user privileges on the system and is effectively root. All access to the root account should be via <xhtml:span class="inline_block">
                        <xhtml:span>su </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>or <xhtml:span class="inline_block">
                        <xhtml:span>sudo </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>to provide an audit trail. All other users must also have a unique UID to ensure that file and directory security is not compromised. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Examine the user IDs of all configured users:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.2735676954403844">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>cut -d: -f 3 /etc/passwd |sort -n |uniq -d</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If a number, or numbers are returned from the command above, these are UID which are not unique within the <xhtml:span class="inline_block">
                                 <xhtml:span>/etc/passwd </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>file. Determine the effected username/s:</xhtml:span>
                           <xhtml:span> </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9051343608141926">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>cut -f "1 3" -d : /etc/passwd |grep ":&lt;UID&gt;$"</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Any user names returned should either be deleted or have the UID changed</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>To remove:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6536984851710131">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>rmuser &lt;username&gt; </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>To change the UID:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.9753912053203362">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>chuser id=&lt;id&gt; &lt;username&gt;</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure all UID are unique in '/etc/passwd'">
                     <ecl:command>cut -d: -f 3 /etc/passwd |sort -n |uniq -d </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.17_Miscellaneous_Config_-_all_group_id_must_be_unique" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - all group id must be unique</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>All groups should have a unique GID</xhtml:span>
                  <xhtml:span> on the system.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>All groups should have an individual and unique GID. If GID numbers are shared this could lead to undesirable file and directory access.</xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure that all group IDs are unique:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4816575659099471">
                           <xhtml:span class="inline_block">cut -d: -f 3 /etc/group |sort #x2013;n | uniq -d</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>If a number, or numbers are returned from the command above, these are GID which are not unique within the <xhtml:span class="inline_block">/etc/group</xhtml:span> file. Determine the effected group names:</xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6641595888614131">
                           <xhtml:span class="inline_block">cut -f "1 3" -d : /etc/group |grep ":&lt;GID&gt;$"</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>NOTE: Any group names returned should either be deleted or have the UID changed</xhtml:p>
                        <xhtml:p> </xhtml:p>
                        <xhtml:p>To remove:</xhtml:p>
                     </xhtml:div>
                     <xhtml:code class="pre_0.638487269325261">
                        <xhtml:span class="inline_block">rmgroup &lt;groupname&gt;</xhtml:span>
                     </xhtml:code>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>To change the UID:</xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.6324603065130945">
                           <xhtml:span class="inline_block">chgroup id=&lt;id&gt; &lt;groupname&gt;</xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure all GID are unique in '/etc/group'">
                     <ecl:command>cut -d: -f 3 /etc/group |sort -n | uniq -d </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.18_Miscellaneous_Config_-_unnecessary_user_and_group_removal" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - unnecessary user and group removal</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Remove unnecessary administrative user accounts to further enhance security.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Remove unnecessary administrative user accounts and groups, if possible. Generic administrative user accounts are targeted by hackers in an attempt to gain unauthorized access to a server.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remove the <xhtml:span class="inline_block">
                              <xhtml:span>uucp</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>, <xhtml:span class="inline_block">nuucp</xhtml:span>, <xhtml:span class="inline_block">lpd</xhtml:span>, </xhtml:span>
                        <xhtml:span>and <xhtml:span class="inline_block">
                              <xhtml:span>printq </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>user accounts and respective groups, if possible:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.3216557363827278">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span># Remove users</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>LIST="uucp nuucp lpd printq"</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>for USERS in $LIST; do</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>rmuser -p $USERS</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>done</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span> </xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span># Remove groups</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>LIST="uucp printq"</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>for GROUPS in $LIST; do</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>rmgroup $GROUPS</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>done</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE:- Other users and groups can be added to the list if required</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="none exist" comment="Ensure unnecessary users are removed from '/etc/passwd'">
                        <ecl:command>LIST="uucp nuucp lpd printq"; for USERS in $LIST; do grep "^$USERS:" /etc/passwd; done</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
               <xccdf:check system="http://cisecurity.org/check">
                  <xccdf:check-content>
                     <ecl:shell-command check="none exist" comment="Ensure unnecessary groups are removed from '/etc/group'">
                        <ecl:command>LIST="uucp printq"; for GROUPS in $LIST; do grep "^$GROUPS:" /etc/group; done</ecl:command>
                        <ecl:line-selection dt="xs:string" op="pm" value="."/>
                     </ecl:shell-command>
                  </xccdf:check-content>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.19_Miscellaneous_Config_-_removing_current_working_directory_from_roots_PATH" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - removing current working directory from root's PATH</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>This change removes any "." or "::" entries from the root PATH. If a "." or "::" is present the current working directory is included in the search path.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Any "." and "::" will be removed from the root </xhtml:span>
                  <xhtml:span>PATH</xhtml:span>
                  <xhtml:span>. This means that any harmful programs placed in common PATH locations, would never be automatically executed. All directories must be explicitly defined within the PATH variable.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Examine root#x2019;s PATH to see </xhtml:span>
                        <xhtml:span>if it contains any "." or "::" entries:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.04120089279677791">
                        <xhtml:span class="inline_block">
                           <xhtml:span>su - root -c "echo ${PATH}" |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/'</xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>If the command above yields output, remove the "." and "::" entries from the relevant initialization files. </xhtml:span>
                        <xhtml:span>The files to examine are dependant on the root users shell definition in </xhtml:span>
                        <xhtml:span>
                           <xhtml:span class="inline_block">/etc/passwd</xhtml:span>. </xhtml:span>
                        <xhtml:span>Once the file or files have been identified remove the "." and "::" from the PATH variable</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.273689952437863">
                        <xhtml:span class="inline_block">vi &lt;filename&gt; </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:br/>
                        </xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that root's PATH does not contain any &quot;.&quot;  or &quot;::&quot; entries">
                     <ecl:command>su - root -c "echo ${PATH}" |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/'</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.12.20_Miscellaneous_Config_-_removing_current_working_directory_from_default_etcenvironment_PATH" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Miscellaneous Config - removing current working directory from default /etc/environment PATH</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>
                  <xhtml:span>This change removes any "." or "::" entries from <xhtml:span class="inline_block">
                        <xhtml:span>/etc/environment</xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>. If a "." or "::" is present the current working directory is included in the default search path.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="MsoNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>Any "." and "::" will be removed from </xhtml:span>
                  <xhtml:span class="inline_block">/etc/environment</xhtml:span>
                  <xhtml:span>. This means that any harmful programs placed in common PATH locations, would never be automatically executed. All directories must be explicitly defined within the PATH variable.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Examine PATH in <xhtml:span class="inline_block">
                              <xhtml:span>/etc/environment</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> to see </xhtml:span>
                        <xhtml:span>if it contains any "." or "::" entries:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.2609097689304488">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>grep "^PATH=" /etc/environment |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/'</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>If the command above yields output, remove the </xhtml:span>
                           <xhtml:span>"." and "::" entries from:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.6868890054642176">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>
                                    <xhtml:span class="inline_block">
                                       <xhtml:span>
                                          <xhtml:span class="inline_block">
                                             <xhtml:span>vi /etc/environment</xhtml:span>
                                          </xhtml:span>
                                       </xhtml:span>
                                    </xhtml:span>
                                 </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure 'PATH' in '/etc/environment' does not contains any '.'  or '::' entries">
                     <ecl:command>grep "^PATH=" /etc/environment |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/'</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.13_Encrypted_Filesystems_EFS">
         <xccdf:title xml:lang="en">Encrypted Filesystems (EFS)</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>Another enhancement of AIX 6.1 is the introduction of Encrypted Filesystems. This enables an individual user, via keystore files, to encrypt their own data within a <xhtml:span class="inline_block">
                     <xhtml:span>jfs2 </xhtml:span>
                  </xhtml:span>
               </xhtml:span>
               <xhtml:span>filesystem.</xhtml:span>
               <xhtml:span> After creating EFS enabled filesystems, individual files can be encrypted or inheritance can be set at the filesystem or directory level. The standard AIX data and user management commands have been modified to work with encryption. </xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>There are a number of reasons for encrypting data in this manner, perhaps to send backups of data off site, or to encrypt sensitive or confidential information such as payroll details. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.13.1_EFS_-_implementation" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">EFS - implementation</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The recommendation, if there is a requirement for file based encryption, is to utilize EFS.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>The use of EFS further enhances the file and directory security within AIX. If there are sensitive or confidential files, encryption provides that extra level of security in the event of an accidental <xhtml:span class="inline_block">
                        <xhtml:span>chmod </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>which may</xhtml:span>
                  <xhtml:span> allow read or write access to other users. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The encryption operates at the filesystem level and each file is encrypted with a separate key. From a user perspective the encryption is transparent as the key can be automatically loaded during login. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>There are two pre-requisite requirements for EFS, it requires RBAC and the installation of the CLiC cryptographic fileset. The fileset is located on the expansion pack, shipped with the AIX media.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Place the CLiC software into a convenient location, such as <xhtml:span class="inline_block">
                              <xhtml:span>/tmp</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> and install via:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8544102896490064">
                           <xhtml:span class="inline_block">/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp #x2013;f clic.rte -c -N -g -X -G -Y</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: If the software is not located in <xhtml:span class="inline_block">
                                 <xhtml:span>/tmp</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>, reflect the actual location in the command above.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Load the CLiC kernel extension:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.2931955911368138">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>/usr/lib/methods/loadkclic</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>As the EFS administrator, create the initial keystore. This is typically the </xhtml:span>
                           <xhtml:span>root</xhtml:span>
                           <xhtml:span> user:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4895739360218769">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>efsenable -a</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>An EFS enabled filesystem can be created with the following command:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8555139874463893">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chfs #x2013;v jfs2 #x2013;g &lt;vg_name&gt; -m &lt;/filesystem&gt; -a size=&lt;size&gt; -a efs=yes</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>To enable EFS for an existing filesystem:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.042252369419369384">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chfs #x2013;a efs=yes &lt;/filesystem&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>To encrypt a file, load your keystore via:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9489132213687572">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>efskeymgr #x2013;o ksh</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Then encrypt via:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8375699202035283">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>efsmgr #x2013;c AES_192_ECB #x2013;e &lt;filename&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>To decrypt:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.684671412199586">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>efsmgr #x2013;d &lt;filename&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Further details regarding planning and implementation of EFS can be found within the IBM AIX 7.1 Infocentre:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:a href="http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fefs_efs.htm">http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fefs_efs.htm</xhtml:a>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;"> </xhtml:p>
                     <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                        <xhtml:span>NOTE: The configuration of EFS is completely dependant on the unique requirements of a given environment.</xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.14_Privileged_Command_Management">
         <xccdf:title xml:lang="en">Privileged Command Management</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>One of the primary causes of system outages is inadvertent or accidental command usage when a user has root privileges. Many users seemingly forget that they are logged in as root, or use inappropriate command arguments. The carte blanche use of the root account should be limited to those individuals who administer the operating system. Users such as database administrators, application support teams and troubleshooters can be given privileged access to the commands they need via tools such as sudo or enhanced RBAC. These tools require careful planning and implementation, but ultimately can eradicate the need for the root password. </xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>This section of the benchmark will detail the recommended methods of managing privileged command access.</xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.14.1_PCM_-_sudo" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">PCM - sudo</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to install and configure sudo, to reflect the privileged command access requirements of all users of the system. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>Privileged command access should be limited to and defined by a user#x2019;s individual needs. Access to a root command prompt should limited, wherever possible, to minimize the risk of inadvertent or deliberate misuse of the account.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The choice between sudo and enhanced RBAC revolves around whether or not the environment is heterogeneous in nature, running different flavors of UNIX, or perhaps different versions of AIX. It may be that sudo is the standard tool of choice for managing privileged command access across an entire UNIX estate. However, if the environment is AIX 6.1+ only, it is recommended that enhanced RBAC is used as the tool of choice. Some implementations however may benefit from a combined approach, utilizing both sudo and enhanced RBAC. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>The sudo software is packaged as an RPM by IBM and is available on the AIX Toolbox for LINUX media, or via download from the following location:</xhtml:span>
               </xhtml:p>
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>
                     <xhtml:a href="http://www-03.ibm.com/systems/power/software/aix/linux/toolbox/download.html">http://www-03.ibm.com/systems/power/software/aix/linux/toolbox/download.html</xhtml:a>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Place the sudo software into a convenient location, such as <xhtml:span class="inline_block">
                              <xhtml:span>/tmp </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>and install via</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5387303249546175">
                           <xhtml:span class="inline_block">/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp #x2013;f sudo -c -N -g -X -G -Y</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>NOTE: If the software is not located in <xhtml:span class="inline_block">
                                 <xhtml:span>/tmp</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>, reflect the actual location in the command above.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Once installed refer to the sudo man page for information regarding the creation of a custom <xhtml:span class="inline_block">
                              <xhtml:span>/etc/sudoers </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>file. It is recommended that, to reduce rule complexity, privileges are assigned at a group level wherever possible:</xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:a href="http://www.gratisoft.us/sudo/man/sudo.html">http://www.gratisoft.us/sudo/man/sudo.html</xhtml:a>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>NOTE: The configuration of sudo is completely dependant on the unique requirements of a given environment.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>All editing of the <xhtml:span class="inline_block">
                              <xhtml:span>/etc/sudoers </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>file must be performed by the following command:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.45742671172281396">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>visudo</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Once the <xhtml:span class="inline_block">
                                 <xhtml:span>/etc/sudoers</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span> file has been successfully created, validate the syntax of the file:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.013629157415956161">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>visudo -c</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.14.2_PCM_-_enhanced_RBAC" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">PCM - enhanced RBAC</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to configure RBAC to reflect the privileged command access requirements for all users of the system. RBAC is a default component of AIX 7.1. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>Privileged command access should be limited to and defined by a user#x2019;s individual needs. Access to a root command prompt should limited, wherever possible, to minimize the risk of inadvertent or deliberate misuse of the account.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>
                     <xhtml:span>The choice between sudo and enhanced RBAC revolves around whether or not the environment is heterogeneous in nature, running different flavors of UNIX, or perhaps different versions of AIX. It may be that sudo is the standard tool of choice for managing privileged command access across an entire UNIX estate. However, if the environment is AIX 6.1+ only, it is recommended that enhanced RBAC is used as the tool of choice. Some implementations however may benefit from a combined approach, utilizing both sudo and enhanced RBAC. </xhtml:span>
                  </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Enhanced RBAC improves on its legacy implementation by allowing greater flexibility around command lists and authorization definitions, which can be customized. The definitions are also saved to a kernel table rather than in flat files, which improves security</xhtml:span>
                        <xhtml:span>. </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>The implementation of RBAC is role based, allowing users to be specifically granted access to the privileged commands they need to perform their day to day tasks. The tool can be used to replace sudo in many instances, or indeed to work alongside it. </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>A successful implementation may also allow the root account to be deprecated.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>The RBAC definition files:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9633286223936368">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>/etc/security/privcmds</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>/etc/security/privfiles</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>/etc/security/privdevs</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>The command used to list the active RBAC definitions, i.e. those loaded into the kernel:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.36272246239497035">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>lskst</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>The command used to update RBAC definitions in the kernel table:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.44452417406782196">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>setkst</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Further details regarding planning and implementation of RBAC can be found within the IBM AIX 7.1 Infocentre:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:a href="http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Frbac_in_aix.htm">http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Frbac_in_aix.htm</xhtml:a>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>NOTE: The configuration of enhanced RBAC is completely dependant on the unique requirements of a given environment.</xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.15_Trusted_Execution_TE_">
         <xccdf:title xml:lang="en">Trusted Execution (TE) </xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
               <xhtml:span>This is a further development of the Trusted Computing Base (TCB) packaged with previous versions of AIX. Unlike TCB, Trusted Execution is not an install time only option and it can be enabled on previously installed systems. Its primary purpose is to protect from Trojan horse style attacks, by only allowing the execution of certain executables and kernel extensions. </xhtml:span>
            </xhtml:p>
            <xhtml:p>
               <xhtml:span>TE has two modes of operation, online and offline. The online mode provides the most comprehensive security, as a check is made every time a file is loaded into memory. If the integrity checks fail, the file will not be loaded into memory. The offline mode checks file integrity at a specified time, via either the command line or via <xhtml:span class="inline_block">crontab</xhtml:span>. </xhtml:span>
            </xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.15.1_TE_-_implementation_" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">TE - implementation </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISRuleComponent" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The recommendation is to implement TE to protect the system from Trojan horse style attacks. TE provides a robust system integrity checking process.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:span>One of the common ways a hacker infiltrates a system is through file tampering or the use of a Trojan horse. The implementation of TE can provide a number of integrity checks prior to loading a program into memory, any deviations can also be highlighted when programs and files are validated offline. This ensures that the programs executed are those which are intended to be and not malicious code masquerading as a true program.</xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>When a discrepancy is identified it is classified as either minor or major. A minor discrepancy is automatically reset to the value defined in the TSD. In the event of a major discrepancy the file access permissions are changed to make the file inaccessible. </xhtml:span>
               </xhtml:p>
               <xhtml:p>
                  <xhtml:span>There is a pre-requisite requirement to install CLiC and SSL software.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>It is recommended that TE is configured in online mode. This provides real time protection against Trojan horse attacks.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>The <xhtml:span class="inline_block">
                              <xhtml:span>tsd.dat</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span> file contains the important security attributes relating to all of the managed files:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.22760581238108568">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>cat /etc/security/tsd/tsd.dat</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:span>NOTE: The <xhtml:span class="inline_block">
                              <xhtml:span>trustchk </xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                        <xhtml:span>command is used to manage the entries in this file.</xhtml:span>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>To enable TE, firstly enable online checking of executables and shell scripts:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.790062544177706">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>trustchk #x2013;p CHKEXEC=ON</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>trustchk #x2013;p CHKSCRIPT=ON</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Stop the execution or loading of binaries and files into memory when the integrity checks fail:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9506010586374634">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>trustchk #x2013;p STOP_ON_CHKFAIL=ON</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Enable online TE based on the policy selections above:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.02081273041996129">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>trustchk #x2013;p TE=ON</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>To set a Trusted Execution Path or TEP:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4943933784775784">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>trustchk #x2013;p TEP=&lt;PATH variable&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Enable the TEP:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.741386208770968">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>trustchk #x2013;p TEP=ON</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: Commands will not be executed if they reside outside of the TEP. </xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Further details regarding planning and implementation of TE can be found within the IBM AIX 7.1 Infocentre:</xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>
                           <xhtml:a href="http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fbos_trusted_execution.htm">http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fbos_trusted_execution.htm</xhtml:a>
                        </xhtml:span>
                     </xhtml:p>
                     <xhtml:p>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                        <xhtml:span>NOTE: The configuration of TE is dependant on the unique requirements of a given environment.</xhtml:span>
                     </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>

         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.16_General_Permissions_Management">
         <xccdf:title xml:lang="en">General Permissions Management</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>This section will focus on general permissions management i.e. general file and directory permissions and ownership.</xhtml:p>
         </xccdf:description>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.16.1_General_Permissions_Management_-_suid_and_sgid_files_and_programs_" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">General Permissions Management - suid and sgid files and programs </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The system is audited for both <xhtml:span class="inline_block">
                        <xhtml:span>suid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>sgid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>files and programs.</xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>An audit should be performed on the system to search for the presence of both <xhtml:span class="inline_block">
                        <xhtml:span>suid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>sgid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>files and programs. In order to prevent these files from being potentially exploited the <xhtml:span class="inline_block">
                        <xhtml:span>suid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>and <xhtml:span class="inline_block">
                        <xhtml:span>sgid </xhtml:span>
                     </xhtml:span>
                  </xhtml:span>
                  <xhtml:span>permissions should be removed wherever possible. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Review the currently mounted filesystems</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.4322616013112361">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>mount</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Un-mount all non-local filesystems and cdrom media:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.1653326250490985">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>unmount &lt;mount point&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If there are non-local filesystems which cannot be un-mounted, use the following to find all <xhtml:span class="inline_block">
                                 <xhtml:span>suid </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>and <xhtml:span class="inline_block">
                                 <xhtml:span class="inline_block">sgid</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>files on local JFS/JFS2 filesystems only:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9853085735830949">
                           <xhtml:span class="inline_block">find / \( -fstype jfs -o -fstype jfs2 \) \( -perm -04000 -o -perm -02000 \) -type f -ls</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If all non-local filesystems have been un-mounted:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.5438235550913252">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>find / \( -perm -04000 -o -perm -02000 \) -type f -ls</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>Review the files and where possible<xhtml:span>, use the <xhtml:span class="inline_block">
                                 <xhtml:span>chmod </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>command to remove the appropriate <xhtml:span class="inline_block">
                                 <xhtml:span>suid </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>or <xhtml:span class="inline_block">
                                 <xhtml:span>sgid </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>bits:</xhtml:span>
                        </xhtml:p>
                        <xhtml:code class="pre_0.37271562407609565">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>chmod u-s &lt;file&gt;</xhtml:span>
                                 <xhtml:br/>
                                 <xhtml:span>chmod g-s &lt;file&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that all 'suid' and 'sgid' files and programs are audited">
                     <ecl:command>find / \( -fstype jfs -o -fstype jfs2 \) \( -perm -04000 -o -perm -02000 \) -type f -ls</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.16.2_General_Permissions_Management_-_un-owned_files_and_directories_" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">General Permissions Management - un-owned files and directories </xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The system is audited for un-owned files and directories. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>An audit should be performed on the system to search for the presence of un-owned files and directories. All files and directories should have a valid owner and group. </xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Review the currently mounted filesystems</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.9654990488154497">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>mount</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p> </xhtml:p>
                     </xhtml:div>
                     <xhtml:p>
                        <xhtml:span>Un-mount all non-local filesystems and cdrom media:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8452571878788848">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>unmount &lt;mount point&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If there are non-local filesystems which cannot be un-mounted, use the following command to find all un-owned files and directories</xhtml:span>
                           <xhtml:span> on local JFS/JFS2 filesystems only:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.051035231202049336">
                           <xhtml:span class="inline_block">find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If all non-local filesystems have been un-mounted:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.742658928146011">
                           <xhtml:span class="inline_block">find / \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>NOTE: An un-owned file or directory is referred to via the GID or UID as it cannot be translated to a user or group name in <xhtml:span class="inline_block">
                                 <xhtml:span>/etc/group </xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>or <xhtml:span class="inline_block">
                                 <xhtml:span>/etc/passwd</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                           <xhtml:span>. This is typically caused by removing users or groups from the system.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:p> </xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Remediate the un-owned file and directory list:</xhtml:span>
                     </xhtml:p>
                     <xhtml:code class="pre_0.5573133812021483">
                        <xhtml:span>
                           <xhtml:span class="inline_block">
                              <xhtml:span>chown &lt;owner&gt; &lt;file&gt;</xhtml:span>
                              <xhtml:br/>
                              <xhtml:span>chgrp &lt;group&gt; &lt;file&gt;</xhtml:span>
                           </xhtml:span>
                        </xhtml:span>
                     </xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that all files and directories have an owner and group">
                     <ecl:command>find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls </ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.16.3_General_Permissions_Management_-_world_writable_files_and_directories" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">General Permissions Management - world writable files and directories</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>The system is audited for world writable files and directories. </xhtml:span>
               </xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p class="CISNormal" style="margin: 0cm 0cm 0pt;">
                  <xhtml:span>An audit should be performed on the system to search for the presence of world writable files and directories. Files and directories should only be world writable when absolutely necessary.</xhtml:span>
               </xhtml:p>
            </xccdf:rationale>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span>Review the currently mounted filesystems</xhtml:span>
                        <xhtml:span>:</xhtml:span>
                        <xhtml:span> </xhtml:span>
                     </xhtml:p>
                     <xhtml:div>
                        <xhtml:code class="pre_0.14079870196554017">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>mount</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>Un-mount all non-local filesystems and cdrom media:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.7848376518123159">
                           <xhtml:span>
                              <xhtml:span class="inline_block">
                                 <xhtml:span>unmount &lt;mount point&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If there are non-local filesystems which cannot be un-mounted, use the following to find all world writable files and directories</xhtml:span>
                           <xhtml:span> on local JFS/JFS2 filesystems only:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.0536977451772519">
                           <xhtml:span class="inline_block">find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) -perm -o+w -ls</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If all non-local filesystems have been un-mounted:</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.42342586914968616">
                           <xhtml:span class="inline_block">find / \( -type d -o -type f \) -perm -o+w -ls</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>Review the world writable files and directories and where possible, if the application configuration allows, remove access via:</xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.34452692518816646">
                           <xhtml:span class="n_romve">
                              <xhtml:span class="inline_block">
                                 <xhtml:span class="n_romve">chmod o-w &lt;dir or file&gt;</xhtml:span>
                              </xhtml:span>
                           </xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:br/>
                           <xhtml:span>If a directory must retain world writable access, ensure that sticky bit is set so that users can only remove the files they create</xhtml:span>:</xhtml:p>
                     </xhtml:div>
                     <xhtml:div>
                        <xhtml:code class="pre_0.8883732472328079">
                           <xhtml:span class="inline_block">chmod o+t &lt;dir&gt;</xhtml:span>
                        </xhtml:code>
                        <xhtml:p>
                           <xhtml:span>NOTE: This will retain world writable permissions, but add a sticky bit to the directory.</xhtml:span>
                        </xhtml:p>
                     </xhtml:div>
                  </xhtml:p>
                  <xhtml:p> </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://cisecurity.org/check">
               <xccdf:check-content>
                  <ecl:shell-command check="none exist" comment="Ensure that all world writable files and directories are audited">
                     <ecl:command>find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) -perm -o+w -ls</ecl:command>
                     <ecl:line-selection dt="xs:string" op="pm" value="."/>
                  </ecl:shell-command>
               </xccdf:check-content>
            </xccdf:check>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Final_Steps">
      <xccdf:title xml:lang="en">Final Steps</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section will describe the process to reboot and backup the operating system - post customization.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_System_Reboot_and_Backup">
         <xccdf:title xml:lang="en">System Reboot and Backup</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Once all of the customization has been successfully performed, reboot the server to initialize all of the new security settings:</xhtml:p>
            <xhtml:code>
               <xhtml:span class="inline_block">shutdown -Fr 0 </xhtml:span>
            </xhtml:code>
            <xhtml:p> </xhtml:p>
            <xhtml:p>When the system has been successfully rebooted, create a <xhtml:span class="inline_block">mksysb </xhtml:span>system backup to reflect the new server configuration:<xhtml:br/>
               <xhtml:br/>If writing to tape:</xhtml:p>
            <xhtml:code class="pre_0.2586032889081434">
               <xhtml:span class="inline_block">mksysb -i /dev/rmt&lt;x&gt;<xhtml:br/>
               </xhtml:span>
            </xhtml:code>
            <xhtml:p> </xhtml:p>
            <xhtml:p>If writing to a file:</xhtml:p>
            <xhtml:code class="pre_0.04192142316521663">
               <xhtml:span class="inline_block">mksysb -i &lt;pathname to file&gt;<xhtml:br/>
               </xhtml:span>
            </xhtml:code>
            <xhtml:p> </xhtml:p>
            <xhtml:p>NOTE: The <xhtml:span class="inline_block">mksysb </xhtml:span>can subsequently be used as a source to install new systems, which ensures compliance to this benchmark. If this is intended, it is recommended that a <xhtml:span class="inline_block">bosinst_data </xhtml:span>resource is created within NIM and that the following parameter is defined:</xhtml:p>
            <xhtml:code class="pre_0.6545035689374865">
               <xhtml:span class="inline_block">RECOVER_DEVICES = no<xhtml:br/>
               </xhtml:span>
            </xhtml:code>
            <xhtml:p> </xhtml:p>
         </xccdf:description>
      </xccdf:Group>
   </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>F6H4Qk43CK4ePQ2GiUHAfKBxcKA=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
mQ9E26XwJmEjfemkGrU33OTIEjSQvJe44O30wFM+QJgLpBVNZJEzNMAvmODlBImSCqfdBybDPaI3
UbE8pVU097I89PoRJgH4rpKI9TVBbzJ1/PatG+i66Xnfz3Ao6oETSiC96C4hSO+sqTiySr9tU6iZ
xbKFDIWK5OQqzrElp12WQO+DYFPfWt5lv/JQwhJ9CfKySPoVJ3+eUru6WWPeE3wDWEZ7LU6sIUR9
gOoIouuSnBY6HlBmsTUttvrTpARStK2ZwTbOgBCM+pxZ2a4AIqlA6Ko37RLH5NMcDZKugDmEjX/5
WNVgFS+tL3fvZjAQ3Rxai995suaKhZ9hN8xsJw==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFRzCCBC+gAwIBAgIHTwpN/4tOfDANBgkqhkiG9w0BAQsFADCBtDELMAkGA1UEBhMCVVMxEDAO
BgNVBAgTB0FyaXpvbmExEzARBgNVBAcTClNjb3R0c2RhbGUxGjAYBgNVBAoTEUdvRGFkZHkuY29t
LCBJbmMuMS0wKwYDVQQLEyRodHRwOi8vY2VydHMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8xMzAx
BgNVBAMTKkdvIERhZGR5IFNlY3VyZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkgLSBHMjAeFw0xNDA5
MTgxNDM0MjFaFw0xNzEwMjAxODU3NDRaMIGTMQswCQYDVQQGEwJVUzERMA8GA1UECBMITmV3IFlv
cmsxFzAVBgNVBAcTDkVhc3QgR3JlZW5idXNoMSswKQYDVQQKEyJDZW50ZXIgZm9yIEludGVybmV0
IFNlY3VyaXR5LCBJbmMuMSswKQYDVQQDEyJDZW50ZXIgZm9yIEludGVybmV0IFNlY3VyaXR5LCBJ
bmMuMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0MGnj6yX2QHklGadAfTBxssvP+2f
YegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzNgOhQx3HcclRwQB4xj/14hOoZSeQ3
haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WYFpSRjZ/Z7m5QKii0feJPxbf+wrZ+
UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKcUY2d3WZ4Zk+zawFcRUYslVIrOhMb
0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7enWCRfZrRWAlDHFaouLdtU/OmXc+
Um7cLwz8VQIDAQABo4IBezCCAXcwDAYDVR0TAQH/BAIwADATBgNVHSUEDDAKBggrBgEFBQcDAzAO
BgNVHQ8BAf8EBAMCB4AwNQYDVR0fBC4wLDAqoCigJoYkaHR0cDovL2NybC5nb2RhZGR5LmNvbS9n
ZGlnMnM1LTAuY3JsMFMGA1UdIARMMEowSAYLYIZIAYb9bQEHFwIwOTA3BggrBgEFBQcCARYraHR0
cDovL2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5LzB2BggrBgEFBQcBAQRqMGgw
JAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmdvZGFkZHkuY29tLzBABggrBgEFBQcwAoY0aHR0cDov
L2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5L2dkaWcyLmNydDAfBgNVHSMEGDAW
gBRAwr0njsw0gzCiM9f7bLPwtCyAzjAdBgNVHQ4EFgQU+3zn+CEg6a2xPqlBXvn64hUyoB4wDQYJ
KoZIhvcNAQELBQADggEBAEh76h1GtJ0pj04in+RUymB7fqPh6HFILkOLlTPnveyXCoHYT2M46DET
EA/NKYkoF2KA3QiZ1b+PMViuTYG2pDs71eFVPADuBCGf9IFufCDY9mPvjQiFDlLNMknXxACD8TjC
hqz+uZT2uLPw/YxkJIsCxrTQJ//ga/fHfZDrKgQfbVzxjD/4WKDe8HktjKcn+NWGPJNMgmO+IHrK
if6TB1xTo32W9QzwoXvBdLnziAUGZZghEulq6h3RCMzKPzpx5JiLlOz6JzqXHvrua+yUbr4A29Vy
vkwWgJWjyvJd2uq9MQ9l49kkrD84m41PSwpaHO99nEHRgRykopxIt8AHsIQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>